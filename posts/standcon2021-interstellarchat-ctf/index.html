<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="STANDCON CTF - Interstellar Chat" /><meta name="author" content="rizemon" /><meta property="og:locale" content="en_US" /><meta name="description" content="Description" /><meta property="og:description" content="Description" /><link rel="canonical" href="https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/" /><meta property="og:url" content="https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/" /><meta property="og:site_name" content="rizemon’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-02T17:19:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="STANDCON CTF - Interstellar Chat" /><meta name="twitter:site" content="@rizemon" /><meta name="twitter:creator" content="@rizemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"rizemon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/"},"description":"Description","url":"https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/","@type":"BlogPosting","headline":"STANDCON CTF - Interstellar Chat","dateModified":"2021-08-02T17:19:00+08:00","datePublished":"2021-08-02T17:19:00+08:00","@context":"https://schema.org"}</script><title>STANDCON CTF - Interstellar Chat | rizemon's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/portfolio.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">rizemon's blog</a></div><div class="site-subtitle font-italic">Cyber Security Enthusiast.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rizemon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rizemon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>STANDCON CTF - Interstellar Chat</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>STANDCON CTF - Interstellar Chat</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Aug 2, 2021, 5:19 PM +0800" > Aug 2, 2021 <i class="unloaded">2021-08-02T17:19:00+08:00</i> </span> by <span class="author"> rizemon </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1359 words">7 min</span></div></div><div class="post-content"><h1 id="description">Description</h1><blockquote><p>I’ve been trying to pirate interstellar chat for the longest time, however their super secure defences have been preventing me from doing so. Could you help me break in and get the flag?</p><p><code class="language-plaintext highlighter-rouge">nc 20.198.209.142 55001</code></p><p><em>The flag is in the flag format: STC{…}</em></p><p><strong>Author: PlatyPew</strong></p></blockquote><h1 id="solution">Solution</h1><p>A <code class="language-plaintext highlighter-rouge">server.py</code> file was provided with the following contents:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
# Author: github.com/PlatyPew
</span>
<span class="c1"># File located at /opt/interstellar/server.py
</span><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Random</span> <span class="kn">import</span> <span class="n">get_random_bytes</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>

<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">PORT</span> <span class="o">=</span> <span class="mi">9999</span>
<span class="n">RECV</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'key'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">KEY</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">FLAG</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">createMsg</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="s">'text'</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span> <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">dumps</span><span class="p">(</span><span class="n">msg</span><span class="p">).</span><span class="n">encode</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">enc</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="n">crypto</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">crypto</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">nonce</span> <span class="o">+</span> <span class="n">ciphertext</span>
    <span class="k">return</span> <span class="n">enc</span>


<span class="k">def</span> <span class="nf">dec</span><span class="p">(</span><span class="n">reply</span><span class="p">):</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">reply</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">reply</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">crypto</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">crypto</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">con</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'#</span><span class="si">{</span><span class="n">randint</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">99999</span><span class="p">)</span><span class="si">}</span><span class="s">'</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s">'Welcome to the interstellar chat! Our super ultra secure software that is powered '</span> <span class="o">+</span> \
           <span class="s">'by cylomin technology! As a loyal subscriber of our service, we are offering you '</span> <span class="o">+</span> \
           <span class="sa">f</span><span class="s">'a flag!</span><span class="se">\n</span><span class="si">{</span><span class="n">FLAG</span><span class="si">}</span><span class="se">\n</span><span class="s">'</span>
    <span class="n">text</span> <span class="o">+=</span> <span class="s">'Would you like to extend your subscription? (y/n)'</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">enc</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">createMsg</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
    <span class="n">con</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">reply</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="n">RECV</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">dec</span><span class="p">(</span><span class="n">reply</span><span class="p">).</span><span class="n">decode</span><span class="p">())[</span><span class="s">'text'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s">'y'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Fire the marketing team!'</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">errorMsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'Oopsy Daisy we have done goofed. We apologise for our development team</span><span class="se">\'</span><span class="s">s incompetence</span><span class="se">\n</span><span class="si">{</span><span class="n">traceback</span><span class="p">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s">'</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">enc</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">createMsg</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">))</span>
        <span class="n">con</span><span class="p">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span><span class="p">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="n">bind</span><span class="p">((</span><span class="s">'0.0.0.0'</span><span class="p">,</span> <span class="n">PORT</span><span class="p">))</span>
        <span class="n">s</span><span class="p">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">con</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">con</span><span class="p">)).</span><span class="n">start</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">s</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>Breaking it down, we can first notice that the challenge use <code class="language-plaintext highlighter-rouge">AES</code> in <code class="language-plaintext highlighter-rouge">CTR</code> mode, which can be seen from both the <code class="language-plaintext highlighter-rouge">enc()</code> and <code class="language-plaintext highlighter-rouge">dec()</code> functions.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># From enc()
</span><span class="n">crypto</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<span class="c1"># From dec()
</span><span class="n">crypto</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
</pre></table></code></div></div><p>The main code that handles a client is in the <code class="language-plaintext highlighter-rouge">run()</code> function, which mainly does the follow things: 1) Send an encrypted welcome message containing the <code class="language-plaintext highlighter-rouge">FLAG</code>. 2) Receive a response from the client, which when decrypted successfully, would print the <code class="language-plaintext highlighter-rouge">FLAG</code> to the server’s standard output if it contained the correct <code class="language-plaintext highlighter-rouge">text</code> value. (Unfortunately, it doesn’t send the <code class="language-plaintext highlighter-rouge">FLAG</code> to the client :() 3) If any exceptions occur, such as <code class="language-plaintext highlighter-rouge">JSONDecodeError</code> which could occur when performing <code class="language-plaintext highlighter-rouge">json.loads()</code> on the decrypted response from the client, it would send an encrypted version of an error message containing a stack trace of the exception.</p><p>The problem comes when reusing the same <code class="language-plaintext highlighter-rouge">key</code> and <code class="language-plaintext highlighter-rouge">nonce</code> to perform encryption. While the key is from the <code class="language-plaintext highlighter-rouge">key</code> file which will always be constant, we can cause the service to encrypt 2 different messages using the same <code class="language-plaintext highlighter-rouge">nonce</code> in the same session. The 2 different messages are actually the welcome message and the error message!</p><p>In order to decrypt the encrypted welcome message containing the <code class="language-plaintext highlighter-rouge">FLAG</code>, we can use the following explanation:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># Explanation taken slightly from https://meowmeowxw.gitlab.io/ctf/utctf-2020-crypto/
</span><span class="n">welcome_enc</span>                                           <span class="c1"># Encrypted welcome message
</span><span class="n">error_enc</span>                                             <span class="c1"># Encrypted error message
</span><span class="n">error_clr</span>                                             <span class="c1"># Cleartext error message
</span><span class="n">welcome_clr</span> <span class="o">=</span> <span class="n">welcome_enc</span> <span class="n">xor</span> <span class="n">error_enc</span> <span class="n">xor</span> <span class="n">error_clr</span> <span class="c1"># Cleartext welcome message
</span></pre></table></code></div></div><p>We can easily get the encrypted encrypted welcome message and encrypted error message from the service:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"20.198.209.142"</span><span class="p">,</span> <span class="mi">55001</span><span class="p">)</span>
<span class="n">welcome_enc</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">8</span><span class="p">:]</span>
<span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">"something</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>  
<span class="n">error_enc</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">8</span><span class="p">:]</span>
</pre></table></code></div></div><p>Now we need the cleartext error message. To get it, we will need to run the <code class="language-plaintext highlighter-rouge">server.py</code> locally with our own custom <code class="language-plaintext highlighter-rouge">FLAG</code> and custom <code class="language-plaintext highlighter-rouge">key</code>. Some things to note about <code class="language-plaintext highlighter-rouge">Python</code> stack traces:</p><p>1) It contains the <strong>absolute path</strong> of the script 2) and <strong>line number</strong> of the code that caused the exception.</p><p>Therefore, we would need to run the script from the exact same path (<code class="language-plaintext highlighter-rouge">/opt/interstellar/server.py</code>) that the service is running from on the server, which is nicely provided in the comments. We should avoid making changes to <code class="language-plaintext highlighter-rouge">server.py</code> and add no extra lines so that we can get the correct line numbers.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">mkdir</span> <span class="nt">-p</span> /opt/interstellar
<span class="nb">cd</span> /opt/interstellar
<span class="nb">cp</span> ~/Downloads/server.py ./server.py
<span class="nb">echo</span> <span class="s2">"STC{TRYHARD}"</span> <span class="o">&gt;</span> flag.txt                                 <span class="c"># Creating fake FLAG</span>
python3 <span class="nt">-c</span> <span class="s2">"import os; open('key','wb').write(os.urandom(16))"</span> <span class="c"># Creating 128-bit key</span>
</pre></table></code></div></div><p>We would also need to install the correct <code class="language-plaintext highlighter-rouge">Crypto</code> module so that the function calls will work properly:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip3 <span class="nb">install </span>pycryptodome
</pre></table></code></div></div><p>Next we create our own client script to interact with the local <code class="language-plaintext highlighter-rouge">server.py</code> and automatically decrypt the encrypted messages.</p><p><code class="language-plaintext highlighter-rouge">client.py</code>:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'key'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">KEY</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">FLAG</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">createMsg</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="s">'text'</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span> <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">dumps</span><span class="p">(</span><span class="n">msg</span><span class="p">).</span><span class="n">encode</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">dec</span><span class="p">(</span><span class="n">reply</span><span class="p">):</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">reply</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">reply</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">crypto</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">crypto</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Get stack trace message
</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">"something</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> 
    <span class="n">enc</span> <span class="o">=</span> <span class="n">dec</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">enc</span><span class="p">)[</span><span class="s">"text"</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="s">"Oopsy Daisy we have done goofed. We apologise for our development team</span><span class="se">\'</span><span class="s">s incompetence</span><span class="se">\n</span><span class="s">"</span><span class="p">):]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></table></code></div></div><p>Running it will return us a similar stack trace as the server:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"/opt/interstellar/server.py"</span>, line 57, <span class="k">in </span>run
    text <span class="o">=</span> loads<span class="o">(</span>dec<span class="o">(</span>reply<span class="o">)</span>.decode<span class="o">())[</span><span class="s1">'text'</span><span class="o">]</span>
  File <span class="s2">"/usr/lib/python3.9/json/__init__.py"</span>, line 346, <span class="k">in </span>loads
    <span class="k">return </span>_default_decoder.decode<span class="o">(</span>s<span class="o">)</span>
  File <span class="s2">"/usr/lib/python3.9/json/decoder.py"</span>, line 337, <span class="k">in </span>decode
    obj, end <span class="o">=</span> self.raw_decode<span class="o">(</span>s, <span class="nv">idx</span><span class="o">=</span>_w<span class="o">(</span>s, 0<span class="o">)</span>.end<span class="o">())</span>
  File <span class="s2">"/usr/lib/python3.9/json/decoder.py"</span>, line 355, <span class="k">in </span>raw_decode
    raise JSONDecodeError<span class="o">(</span><span class="s2">"Expecting value"</span>, s, err.value<span class="o">)</span> from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 <span class="o">(</span>char 0<span class="o">)</span>
</pre></table></code></div></div><p>Now we can modify <code class="language-plaintext highlighter-rouge">client.py</code> to communicate with the actual server and perform the decryption. Here is the final script:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'key'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">KEY</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">FLAG</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">createMsg</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="s">'text'</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span> <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">dumps</span><span class="p">(</span><span class="n">msg</span><span class="p">).</span><span class="n">encode</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">dec</span><span class="p">(</span><span class="n">reply</span><span class="p">):</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">reply</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">reply</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">crypto</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">crypto</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="nb">ord</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">s2</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Get stack trace message
</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">"something</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">dec</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">enc</span><span class="p">)[</span><span class="s">"text"</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="s">"Oopsy Daisy we have done goofed. We apologise for our development team</span><span class="se">\'</span><span class="s">s incompetence</span><span class="se">\n</span><span class="s">"</span><span class="p">):]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Decrypt encrypted welcome message
</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"20.198.209.142"</span><span class="p">,</span> <span class="mi">55001</span><span class="p">)</span>
    <span class="n">welcome_enc</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">"something</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>  
    <span class="n">error_enc</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">errorMsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'Oopsy Daisy we have done goofed. We apologise for our development team</span><span class="se">\'</span><span class="s">s incompetence</span><span class="se">\n</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s">'</span>
    <span class="n">welcome_clr</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">createMsg</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">),</span> <span class="n">xor</span><span class="p">(</span><span class="n">welcome_enc</span><span class="p">,</span> <span class="n">error_enc</span><span class="p">))</span>

    <span class="k">print</span><span class="p">(</span><span class="n">welcome_clr</span><span class="p">)</span>
</pre></table></code></div></div><p>We were able to make out a major portion of the <code class="language-plaintext highlighter-rouge">FLAG</code> but the end seemed cut-off.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>b'{"id": "#19327", "text": "Welcome to the interstellar chat! Our super ultra secure software that is powered by cylomin technology! As a loyal subscriber of our service, we are offering you a flag!\\nSTC{435_15_0nly_600d_1f_y0u_kn0w_h0w_70_1mpl3m3n7_1B3sd_o\x12w2 ~7n\x05k;a4!&lt;sit({njjgx+r#\nN(s;b\x0cX9zfL.c,*=#&lt;?%|$ i%:9ny{d{^p"+:1-95%)1}N!?&gt;!5z&amp;\x12$}'
</pre></table></code></div></div><p>We weren’t sure how to get the complete <code class="language-plaintext highlighter-rouge">FLAG</code>, but as we were racing against time so we simple tried to guess the flag and we got it!</p><h1 id="flag">Flag</h1><p><code class="language-plaintext highlighter-rouge">STC{435_15_0nly_600d_1f_y0u_kn0w_h0w_70_1mpl3m3n7_17}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>ctf</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctr/" class="post-tag no-text-decoration" >ctr</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=STANDCON CTF - Interstellar Chat - rizemon's blog&url=https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=STANDCON CTF - Interstellar Chat - rizemon's blog&u=https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=STANDCON CTF - Interstellar Chat - rizemon's blog&url=https://rizemon.github.io/posts/standcon2021-interstellarchat-ctf/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htbcybersanta-ctf/">HackTheBox CTF - Cyber Santa</a><li><a href="/posts/ticket1part2-thm/">TryHackMe - Pre Security Learning Path (Part 2) [PARTICIPATE IN THE GIVEAWAY!]</a><li><a href="/posts/oscp-reflection/">Post-OSCP Writeup</a><li><a href="/posts/granny-htb/">Hack The Box - Granny (Without Metasploit)</a><li><a href="/posts/cronos-htb/">Hack The Box - Cronos (Without Metasploit)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dsonus2021-insecure-ctf/"><div class="card-body"> <span class="timeago small" > Aug 2, 2021 <i class="unloaded">2021-08-02T17:19:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DSO NUS CTF - Insecure</h3><div class="text-muted small"><p> Description Someone once told me that SUID is a bad idea. Could you show me why? This challenge server can be accessed here: (Any one of the options below is fine) (Suggested access via ‘...</p></div></div></a></div><div class="card"> <a href="/posts/dsonus2021-protectthevaccine-ctf/"><div class="card-body"> <span class="timeago small" > Aug 2, 2021 <i class="unloaded">2021-08-02T17:19:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DSO NUS CTF - Protect The Vaccine</h3><div class="text-muted small"><p> Description A nation-supported hacker group is using their cutting edge technology to attack a company that develops vaccine. They roll their own crypto with a hope that it will be more secure....</p></div></div></a></div><div class="card"> <a href="/posts/computingday2020-ctf/"><div class="card-body"> <span class="timeago small" > Sep 6, 2020 <i class="unloaded">2020-09-06T14:23:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NUS Computing Day 2020 CTF by NUS Greyhats</h3><div class="text-muted small"><p> Crypto Spin the letter around (50 pts) Can you find the mystery message? yetz{pxevhfxmhvhfinmbgzwtr} To solve this challenge, we just need to apply the rotational cipher of 7 shifts on it. The ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dsonus2021-protectthevaccine-ctf/" class="btn btn-outline-primary"><p>DSO NUS CTF - Protect The Vaccine</p></a> <a href="/posts/standcon2021-specimens-ctf/" class="btn btn-outline-primary"><p>STANDCON CTF - Specimens</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rizemon">rizemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rizemon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
